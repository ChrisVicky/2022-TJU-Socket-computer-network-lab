var Blockit=function(){"use strict";function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return o(null==t&&n.path)}},n.exports),n.exports}function o(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var r,i,a=function(e){return e&&e.Math==Math&&e},s=a("object"==typeof globalThis&&globalThis)||a("object"==typeof window&&window)||a("object"==typeof self&&self)||a("object"==typeof t&&t)||function(){return this}()||Function("return this")(),c=function(e){try{return!!e()}catch(e){return!0}},l=!c((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),u=!c((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),d=Function.prototype.call,h=u?d.bind(d):function(){return d.apply(d,arguments)},f={}.propertyIsEnumerable,p=Object.getOwnPropertyDescriptor,g=p&&!f.call({1:2},1)?function(e){var t=p(this,e);return!!t&&t.enumerable}:f,_={f:g},m=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},v=Function.prototype,b=v.bind,y=v.call,k=u&&b.bind(y,y),w=u?function(e){return e&&k(e)}:function(e){return e&&function(){return y.apply(e,arguments)}},E=w({}.toString),S=w("".slice),T=function(e){return S(E(e),8,-1)},I=s.Object,O=w("".split),C=c((function(){return!I("z").propertyIsEnumerable(0)}))?function(e){return"String"==T(e)?O(e,""):I(e)}:I,L=s.TypeError,R=function(e){if(null==e)throw L("Can't call method on "+e);return e},N=function(e){return C(R(e))},A=function(e){return"function"==typeof e},x=function(e){return"object"==typeof e?null!==e:A(e)},D=function(e){return A(e)?e:void 0},B=function(e,t){return arguments.length<2?D(s[e]):s[e]&&s[e][t]},P=w({}.isPrototypeOf),z=B("navigator","userAgent")||"",M=s.process,j=s.Deno,U=M&&M.versions||j&&j.version,V=U&&U.v8;V&&(i=(r=V.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&z&&(!(r=z.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=z.match(/Chrome\/(\d+)/))&&(i=+r[1]);var H=i,F=!!Object.getOwnPropertySymbols&&!c((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&H&&H<41})),K=F&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,G=s.Object,J=K?function(e){return"symbol"==typeof e}:function(e){var t=B("Symbol");return A(t)&&P(t.prototype,G(e))},q=s.String,W=function(e){try{return q(e)}catch(e){return"Object"}},$=s.TypeError,Y=function(e){if(A(e))return e;throw $(W(e)+" is not a function")},Q=function(e,t){var n=e[t];return null==n?void 0:Y(n)},X=s.TypeError,Z=!1,ee=Object.defineProperty,te=function(e,t){try{ee(s,e,{value:t,configurable:!0,writable:!0})}catch(n){s[e]=t}return t},ne="__core-js_shared__",oe=s[ne]||te(ne,{}),re=n((function(e){(e.exports=function(e,t){return oe[e]||(oe[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.20.3",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"})})),ie=s.Object,ae=function(e){return ie(R(e))},se=w({}.hasOwnProperty),ce=Object.hasOwn||function(e,t){return se(ae(e),t)},le=0,ue=Math.random(),de=w(1..toString),he=function(e){return"Symbol("+(void 0===e?"":e)+")_"+de(++le+ue,36)},fe=re("wks"),pe=s.Symbol,ge=pe&&pe.for,_e=K?pe:pe&&pe.withoutSetter||he,me=function(e){if(!ce(fe,e)||!F&&"string"!=typeof fe[e]){var t="Symbol."+e;F&&ce(pe,e)?fe[e]=pe[e]:fe[e]=K&&ge?ge(t):_e(t)}return fe[e]},ve=s.TypeError,be=me("toPrimitive"),ye=function(e,t){if(!x(e)||J(e))return e;var n,o=Q(e,be);if(o){if(void 0===t&&(t="default"),n=h(o,e,t),!x(n)||J(n))return n;throw ve("Can't convert object to primitive value")}return void 0===t&&(t="number"),function(e,t){var n,o;if("string"===t&&A(n=e.toString)&&!x(o=h(n,e)))return o;if(A(n=e.valueOf)&&!x(o=h(n,e)))return o;if("string"!==t&&A(n=e.toString)&&!x(o=h(n,e)))return o;throw X("Can't convert object to primitive value")}(e,t)},ke=function(e){var t=ye(e,"string");return J(t)?t:t+""},we=s.document,Ee=x(we)&&x(we.createElement),Se=!l&&!c((function(){return 7!=Object.defineProperty(function(e){return Ee?we.createElement(e):{}}("div"),"a",{get:function(){return 7}}).a})),Te=Object.getOwnPropertyDescriptor,Ie=l?Te:function(e,t){if(e=N(e),t=ke(t),Se)try{return Te(e,t)}catch(e){}if(ce(e,t))return m(!h(_.f,e,t),e[t])},Oe={f:Ie},Ce=l&&c((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Le=s.String,Re=s.TypeError,Ne=function(e){if(x(e))return e;throw Re(Le(e)+" is not an object")},Ae=s.TypeError,xe=Object.defineProperty,De=Object.getOwnPropertyDescriptor,Be="enumerable",Pe="configurable",ze="writable",Me=l?Ce?function(e,t,n){if(Ne(e),t=ke(t),Ne(n),"function"==typeof e&&"prototype"===t&&"value"in n&&ze in n&&!n.writable){var o=De(e,t);o&&o.writable&&(e[t]=n.value,n={configurable:Pe in n?n.configurable:o.configurable,enumerable:Be in n?n.enumerable:o.enumerable,writable:!1})}return xe(e,t,n)}:xe:function(e,t,n){if(Ne(e),t=ke(t),Ne(n),Se)try{return xe(e,t,n)}catch(e){}if("get"in n||"set"in n)throw Ae("Accessors not supported");return"value"in n&&(e[t]=n.value),e},je={f:Me},Ue=l?function(e,t,n){return je.f(e,t,m(1,n))}:function(e,t,n){return e[t]=n,e},Ve=w(Function.toString);A(oe.inspectSource)||(oe.inspectSource=function(e){return Ve(e)});var He,Fe,Ke,Ge=oe.inspectSource,Je=s.WeakMap,qe=A(Je)&&/native code/.test(Ge(Je)),We=re("keys"),$e=function(e){return We[e]||(We[e]=he(e))},Ye={},Qe="Object already initialized",Xe=s.TypeError,Ze=s.WeakMap;if(qe||oe.state){var et=oe.state||(oe.state=new Ze),tt=w(et.get),nt=w(et.has),ot=w(et.set);He=function(e,t){if(nt(et,e))throw new Xe(Qe);return t.facade=e,ot(et,e,t),t},Fe=function(e){return tt(et,e)||{}},Ke=function(e){return nt(et,e)}}else{var rt=$e("state");Ye[rt]=!0,He=function(e,t){if(ce(e,rt))throw new Xe(Qe);return t.facade=e,Ue(e,rt,t),t},Fe=function(e){return ce(e,rt)?e[rt]:{}},Ke=function(e){return ce(e,rt)}}var it={set:He,get:Fe,has:Ke,enforce:function(e){return Ke(e)?Fe(e):He(e,{})},getterFor:function(e){return function(t){var n;if(!x(t)||(n=Fe(t)).type!==e)throw Xe("Incompatible receiver, "+e+" required");return n}}},at=Function.prototype,st=l&&Object.getOwnPropertyDescriptor,ct=ce(at,"name"),lt={EXISTS:ct,PROPER:ct&&"something"===function(){}.name,CONFIGURABLE:ct&&(!l||l&&st(at,"name").configurable)},ut=n((function(e){var t=lt.CONFIGURABLE,n=it.get,o=it.enforce,r=String(String).split("String");(e.exports=function(e,n,i,a){var c,l=!!a&&!!a.unsafe,u=!!a&&!!a.enumerable,d=!!a&&!!a.noTargetGet,h=a&&void 0!==a.name?a.name:n;A(i)&&("Symbol("===String(h).slice(0,7)&&(h="["+String(h).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!ce(i,"name")||t&&i.name!==h)&&Ue(i,"name",h),(c=o(i)).source||(c.source=r.join("string"==typeof h?h:""))),e!==s?(l?!d&&e[n]&&(u=!0):delete e[n],u?e[n]=i:Ue(e,n,i)):u?e[n]=i:te(n,i)})(Function.prototype,"toString",(function(){return A(this)&&n(this).source||Ge(this)}))})),dt=Math.ceil,ht=Math.floor,ft=function(e){var t=+e;return t!=t||0===t?0:(t>0?ht:dt)(t)},pt=Math.max,gt=Math.min,_t=Math.min,mt=function(e){return(t=e.length)>0?_t(ft(t),9007199254740991):0;var t},vt=function(e){return function(t,n,o){var r,i=N(t),a=mt(i),s=function(e,t){var n=ft(e);return n<0?pt(n+t,0):gt(n,t)}(o,a);if(e&&n!=n){for(;a>s;)if((r=i[s++])!=r)return!0}else for(;a>s;s++)if((e||s in i)&&i[s]===n)return e||s||0;return!e&&-1}},bt={includes:vt(!0),indexOf:vt(!1)}.indexOf,yt=w([].push),kt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"].concat("length","prototype"),wt=Object.getOwnPropertyNames||function(e){return function(e,t){var n,o=N(e),r=0,i=[];for(n in o)!ce(Ye,n)&&ce(o,n)&&yt(i,n);for(;t.length>r;)ce(o,n=t[r++])&&(~bt(i,n)||yt(i,n));return i}(e,kt)},Et={f:wt},St={f:Object.getOwnPropertySymbols},Tt=w([].concat),It=B("Reflect","ownKeys")||function(e){var t=Et.f(Ne(e)),n=St.f;return n?Tt(t,n(e)):t},Ot=function(e,t,n){for(var o=It(t),r=je.f,i=Oe.f,a=0;a<o.length;a++){var s=o[a];ce(e,s)||n&&ce(n,s)||r(e,s,i(t,s))}},Ct=/#|\.prototype\./,Lt=function(e,t){var n=Nt[Rt(e)];return n==xt||n!=At&&(A(t)?c(t):!!t)},Rt=Lt.normalize=function(e){return String(e).replace(Ct,".").toLowerCase()},Nt=Lt.data={},At=Lt.NATIVE="N",xt=Lt.POLYFILL="P",Dt=Lt,Bt=Oe.f,Pt=function(e,t){var n,o,r,i,a,c=e.target,l=e.global,u=e.stat;if(n=l?s:u?s[c]||te(c,{}):(s[c]||{}).prototype)for(o in t){if(i=t[o],r=e.noTargetGet?(a=Bt(n,o))&&a.value:n[o],!Dt(l?o:c+(u?".":"#")+o,e.forced)&&void 0!==r){if(typeof i==typeof r)continue;Ot(i,r)}(e.sham||r&&r.sham)&&Ue(i,"sham",!0),ut(n,o,i,e)}},zt=function(){for(var e,t=Ne(this),n=Y(t.delete),o=!0,r=0,i=arguments.length;r<i;r++)e=h(n,t,arguments[r]),o=o&&e;return!!o};Pt({target:"Map",proto:!0,real:!0,forced:Z},{deleteAll:zt});var Mt=w(w.bind),jt=function(e,t){return Y(e),void 0===t?e:u?Mt(e,t):function(){return e.apply(t,arguments)}},Ut=function(e){return h(Map.prototype.entries,e)},Vt={},Ht=me("iterator"),Ft=Array.prototype,Kt={};Kt[me("toStringTag")]="z";var Gt="[object z]"===String(Kt),Jt=me("toStringTag"),qt=s.Object,Wt="Arguments"==T(function(){return arguments}()),$t=Gt?T:function(e){var t,n,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=qt(e),Jt))?n:Wt?T(t):"Object"==(o=T(t))&&A(t.callee)?"Arguments":o},Yt=me("iterator"),Qt=function(e){if(null!=e)return Q(e,Yt)||Q(e,"@@iterator")||Vt[$t(e)]},Xt=s.TypeError,Zt=function(e,t){var n=arguments.length<2?Qt(e):t;if(Y(n))return Ne(h(n,e));throw Xt(W(e)+" is not iterable")},en=function(e,t,n){var o,r;Ne(e);try{if(!(o=Q(e,"return"))){if("throw"===t)throw n;return n}o=h(o,e)}catch(e){r=!0,o=e}if("throw"===t)throw n;if(r)throw o;return Ne(o),n},tn=s.TypeError,nn=function(e,t){this.stopped=e,this.result=t},on=nn.prototype,rn=function(e,t,n){var o,r,i,a,s,c,l,u=n&&n.that,d=!(!n||!n.AS_ENTRIES),f=!(!n||!n.IS_ITERATOR),p=!(!n||!n.INTERRUPTED),g=jt(t,u),_=function(e){return o&&en(o,"normal",e),new nn(!0,e)},m=function(e){return d?(Ne(e),p?g(e[0],e[1],_):g(e[0],e[1])):p?g(e,_):g(e)};if(f)o=e;else{if(!(r=Qt(e)))throw tn(W(e)+" is not iterable");if(function(e){return void 0!==e&&(Vt.Array===e||Ft[Ht]===e)}(r)){for(i=0,a=mt(e);a>i;i++)if((s=m(e[i]))&&P(on,s))return s;return new nn(!1)}o=Zt(e,r)}for(c=o.next;!(l=h(c,o)).done;){try{s=m(l.value)}catch(e){en(o,"throw",e)}if("object"==typeof s&&s&&P(on,s))return s}return new nn(!1)};Pt({target:"Map",proto:!0,real:!0,forced:Z},{every:function(e){var t=Ne(this),n=Ut(t),o=jt(e,arguments.length>1?arguments[1]:void 0);return!rn(n,(function(e,n,r){if(!o(n,e,t))return r()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var an=function(){},sn=[],cn=B("Reflect","construct"),ln=/^\s*(?:class|function)\b/,un=w(ln.exec),dn=!ln.exec(an),hn=function(e){if(!A(e))return!1;try{return cn(an,sn,e),!0}catch(e){return!1}},fn=function(e){if(!A(e))return!1;switch($t(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return dn||!!un(ln,Ge(e))}catch(e){return!0}};fn.sham=!0;var pn=!cn||c((function(){var e;return hn(hn.call)||!hn(Object)||!hn((function(){e=!0}))||e}))?fn:hn,gn=s.TypeError,_n=me("species"),mn=function(e,t){var n,o=Ne(e).constructor;return void 0===o||null==(n=Ne(o)[_n])?t:function(e){if(pn(e))return e;throw gn(W(e)+" is not a constructor")}(n)};Pt({target:"Map",proto:!0,real:!0,forced:Z},{filter:function(e){var t=Ne(this),n=Ut(t),o=jt(e,arguments.length>1?arguments[1]:void 0),r=new(mn(t,B("Map"))),i=Y(r.set);return rn(n,(function(e,n){o(n,e,t)&&h(i,r,e,n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),r}}),Pt({target:"Map",proto:!0,real:!0,forced:Z},{find:function(e){var t=Ne(this),n=Ut(t),o=jt(e,arguments.length>1?arguments[1]:void 0);return rn(n,(function(e,n,r){if(o(n,e,t))return r(n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Pt({target:"Map",proto:!0,real:!0,forced:Z},{findKey:function(e){var t=Ne(this),n=Ut(t),o=jt(e,arguments.length>1?arguments[1]:void 0);return rn(n,(function(e,n,r){if(o(n,e,t))return r(e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});Pt({target:"Map",proto:!0,real:!0,forced:Z},{includes:function(e){return rn(Ut(Ne(this)),(function(t,n,o){if(function(e,t){return e===t||e!=e&&t!=t}(n,e))return o()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Pt({target:"Map",proto:!0,real:!0,forced:Z},{keyOf:function(e){return rn(Ut(Ne(this)),(function(t,n,o){if(n===e)return o(t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Pt({target:"Map",proto:!0,real:!0,forced:Z},{mapKeys:function(e){var t=Ne(this),n=Ut(t),o=jt(e,arguments.length>1?arguments[1]:void 0),r=new(mn(t,B("Map"))),i=Y(r.set);return rn(n,(function(e,n){h(i,r,o(n,e,t),n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),r}}),Pt({target:"Map",proto:!0,real:!0,forced:Z},{mapValues:function(e){var t=Ne(this),n=Ut(t),o=jt(e,arguments.length>1?arguments[1]:void 0),r=new(mn(t,B("Map"))),i=Y(r.set);return rn(n,(function(e,n){h(i,r,e,o(n,e,t))}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),r}}),Pt({target:"Map",proto:!0,real:!0,forced:Z},{merge:function(e){for(var t=Ne(this),n=Y(t.set),o=arguments.length,r=0;r<o;)rn(arguments[r++],n,{that:t,AS_ENTRIES:!0});return t}});var vn=s.TypeError;Pt({target:"Map",proto:!0,real:!0,forced:Z},{reduce:function(e){var t=Ne(this),n=Ut(t),o=arguments.length<2,r=o?void 0:arguments[1];if(Y(e),rn(n,(function(n,i){o?(o=!1,r=i):r=e(r,i,n,t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),o)throw vn("Reduce of empty map with no initial value");return r}}),Pt({target:"Map",proto:!0,real:!0,forced:Z},{some:function(e){var t=Ne(this),n=Ut(t),o=jt(e,arguments.length>1?arguments[1]:void 0);return rn(n,(function(e,n,r){if(o(n,e,t))return r()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var bn=s.TypeError;Pt({target:"Map",proto:!0,real:!0,forced:Z},{update:function(e,t){var n=Ne(this),o=Y(n.get),r=Y(n.has),i=Y(n.set),a=arguments.length;Y(t);var s=h(r,n,e);if(!s&&a<3)throw bn("Updating absent value");var c=s?h(o,n,e):Y(a>2?arguments[2]:void 0)(e,n);return h(i,n,e,t(c,e,n)),n}}),Pt({target:"WeakMap",proto:!0,real:!0,forced:Z},{deleteAll:zt});var yn,kn,wn,En="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Sn=!c((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Tn=$e("IE_PROTO"),In=s.Object,On=In.prototype,Cn=Sn?In.getPrototypeOf:function(e){var t=ae(e);if(ce(t,Tn))return t[Tn];var n=t.constructor;return A(n)&&t instanceof n?n.prototype:t instanceof In?On:null},Ln=s.String,Rn=s.TypeError,Nn=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=w(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,o){return Ne(n),function(e){if("object"==typeof e||A(e))return e;throw Rn("Can't set "+Ln(e)+" as a prototype")}(o),t?e(n,o):n.__proto__=o,n}}():void 0),An=je.f,xn=s.Int8Array,Dn=xn&&xn.prototype,Bn=s.Uint8ClampedArray,Pn=Bn&&Bn.prototype,zn=xn&&Cn(xn),Mn=Dn&&Cn(Dn),jn=Object.prototype,Un=s.TypeError,Vn=me("toStringTag"),Hn=he("TYPED_ARRAY_TAG"),Fn=he("TYPED_ARRAY_CONSTRUCTOR"),Kn=En&&!!Nn&&"Opera"!==$t(s.opera),Gn=!1,Jn={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},qn={BigInt64Array:8,BigUint64Array:8},Wn=function(e){if(!x(e))return!1;var t=$t(e);return ce(Jn,t)||ce(qn,t)};for(yn in Jn)(wn=(kn=s[yn])&&kn.prototype)?Ue(wn,Fn,kn):Kn=!1;for(yn in qn)(wn=(kn=s[yn])&&kn.prototype)&&Ue(wn,Fn,kn);if((!Kn||!A(zn)||zn===Function.prototype)&&(zn=function(){throw Un("Incorrect invocation")},Kn))for(yn in Jn)s[yn]&&Nn(s[yn],zn);if((!Kn||!Mn||Mn===jn)&&(Mn=zn.prototype,Kn))for(yn in Jn)s[yn]&&Nn(s[yn].prototype,Mn);if(Kn&&Cn(Pn)!==Mn&&Nn(Pn,Mn),l&&!ce(Mn,Vn))for(yn in Gn=!0,An(Mn,Vn,{get:function(){return x(this)?this[Hn]:void 0}}),Jn)s[yn]&&Ue(s[yn],Hn,yn);var $n={NATIVE_ARRAY_BUFFER_VIEWS:Kn,TYPED_ARRAY_CONSTRUCTOR:Fn,TYPED_ARRAY_TAG:Gn&&Hn,aTypedArray:function(e){if(Wn(e))return e;throw Un("Target is not a typed array")},aTypedArrayConstructor:function(e){if(A(e)&&(!Nn||P(zn,e)))return e;throw Un(W(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,o){if(l){if(n)for(var r in Jn){var i=s[r];if(i&&ce(i.prototype,e))try{delete i.prototype[e]}catch(n){try{i.prototype[e]=t}catch(e){}}}Mn[e]&&!n||ut(Mn,e,n?t:Kn&&Dn[e]||t,o)}},exportTypedArrayStaticMethod:function(e,t,n){var o,r;if(l){if(Nn){if(n)for(o in Jn)if((r=s[o])&&ce(r,e))try{delete r[e]}catch(e){}if(zn[e]&&!n)return;try{return ut(zn,e,n?t:Kn&&zn[e]||t)}catch(e){}}for(o in Jn)!(r=s[o])||r[e]&&!n||ut(r,e,t)}},isView:function(e){if(!x(e))return!1;var t=$t(e);return"DataView"===t||ce(Jn,t)||ce(qn,t)},isTypedArray:Wn,TypedArray:zn,TypedArrayPrototype:Mn},Yn=s.RangeError,Qn=s.RangeError,Xn=function(e,t){var n=function(e){var t=ft(e);if(t<0)throw Yn("The argument can't be less than 0");return t}(e);if(n%t)throw Qn("Wrong offset");return n},Zn=s.RangeError,eo=s.Int8Array,to=eo&&eo.prototype,no=to&&to.set,oo=$n.aTypedArray,ro=$n.exportTypedArrayMethod,io=!c((function(){var e=new Uint8ClampedArray(2);return h(no,e,{length:1,0:3},1),3!==e[1]})),ao=io&&$n.NATIVE_ARRAY_BUFFER_VIEWS&&c((function(){var e=new eo(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));ro("set",(function(e){oo(this);var t=Xn(arguments.length>1?arguments[1]:void 0,1),n=ae(e);if(io)return h(no,this,n,t);var o=this.length,r=mt(n),i=0;if(r+t>o)throw Zn("Wrong length");for(;i<r;)this[t+i]=n[i++]}),!io||ao);var so=function(){return so=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},so.apply(this,arguments)};function co(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))}function lo(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function uo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ho=function(){return(ho=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function fo(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}function po(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(fo(arguments[t]));return e}var go,_o=(function(e,t){var n;n=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var o in n)t[o]=n[o]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(o){function r(){}function i(t,n,i){if("undefined"!=typeof document){"number"==typeof(i=e({path:"/"},r.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(e){}n=o.write?o.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in i)i[c]&&(s+="; "+c,!0!==i[c]&&(s+="="+i[c].split(";")[0]));return document.cookie=t+"="+n+s}}function a(e,n){if("undefined"!=typeof document){for(var r={},i=document.cookie?document.cookie.split("; "):[],a=0;a<i.length;a++){var s=i[a].split("="),c=s.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=t(s[0]);if(c=(o.read||o)(c,l)||t(c),n)try{c=JSON.parse(c)}catch(e){}if(r[l]=c,e===l)break}catch(e){}}return e?r[e]:r}}return r.set=i,r.get=function(e){return a(e,!1)},r.getJSON=function(e){return a(e,!0)},r.remove=function(t,n){i(t,"",e(n,{expires:-1}))},r.defaults={},r.withConverter=n,r}((function(){}))},e.exports=n()}(go={exports:{}}),go.exports),mo=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e}(),vo={getItem:function(e){try{var t=localStorage.getItem(e),n=t;try{t&&"string"==typeof t&&(n=JSON.parse(t))}catch(e){}return n||void 0}catch(e){}},setItem:function(e,t){try{var n="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,n)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){try{return _o.get(e,{domain:t||document.domain})}catch(e){return""}},setCookie:function(e,t,n,o){try{var r=o||document.domain,i=+new Date+n;_o.set(e,t,{expires:new Date(i),path:"/",domain:r})}catch(e){}},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},bo={getItem:function(e){try{var t=sessionStorage.getItem(e),n=t;try{t&&"string"==typeof t&&(n=JSON.parse(t))}catch(e){}return n||void 0}catch(e){}},setItem:function(e,t){try{var n="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,n)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},yo=function(){function e(e,t){this._storage=t&&"session"===t?bo:!e&&vo.isSupportLS?vo:new mo}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,n,o){this._storage.setCookie(e,t,n,o)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),ko={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},wo="/webid",Eo="/list",So="4.2.6",To=function(e,t){return t?"__tea_cache_tokens_"+e:"__tea_cache_events_"+e},Io=6048e5,Oo=function(e,t,n,o){try{var r,i=e.match(/\/v\d\//);r=i?i[0]:-1!==e.indexOf("/v1/")?"/v1/":"/v2/";var a=e.split(r)[0];if(!a)return void o(e,t,4001);t.forEach((function(r){var i=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&void 0!==e[n]&&(t+="&"+n+"="+encodeURIComponent(JSON.stringify(e[n])));return"&"===t[0]?t.slice(1):t}(r),s=new Image(1,1);s.onload=function(){s=null,n&&n()},s.onerror=function(){s=null,o&&o(e,t,4e3)},s.src=a+"/gif?"+i}))}catch(n){o&&o(e,t,4002,n.message)}},Co=function(e,t,n,o,r,i,a,s,c,l){var u=window.navigator.userAgent,d=-1!==window.navigator.appName.indexOf("Microsoft Internet Explorer")&&(-1!==u.indexOf("MSIE 8.0")||-1!==u.indexOf("MSIE 9.0")),h=!!o;if(!h&&d)Oo(e,n,r,i);else if(!h&&s)return window.navigator&&window.navigator.sendBeacon?(l&&l(),void(window.navigator.sendBeacon(e,JSON.stringify(n))?r():i(e,n,4003))):void Oo(e,n,r,i);a&&delete n.app_key,function(e,t,n,o,r,i,a,s){try{var c=new XMLHttpRequest;c.open("POST",""+e,!0),c.setRequestHeader("Content-Type","application/json; charset=utf-8"),r&&c.setRequestHeader("X-MCS-AppKey",""+r),a&&(c.withCredentials=!0),c.onload=function(){if(n){var e=null;if(c.responseText){try{e=JSON.parse(c.responseText)}catch(t){e={}}n(e,t)}}};try{i&&(c.timeout=i),i&&(c.ontimeout=function(){o&&o(t,5005)}),c.onerror=function(){c.abort(),o&&o(t,500)},c.send(JSON.stringify(t))}catch(e){}}catch(e){}}(e,n,r,i,o,t,c)};function Lo(e){return e?(e^16*Math.random()>>e/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,Lo)}var Ro=function(){return Lo().replace(/-/g,"").slice(0,19)},No=function(e){return function(e,t,n){if("string"==typeof e&&"number"==typeof n){var o,r=[];n=n<=25?n:n%25;var i=String.fromCharCode(n+97);o=e.split(i);for(var a=0;a<o.length;a++){var s=parseInt(o[a],n);s=1*s^64;var c=String.fromCharCode(s);r.push(c)}return r.join("")}}(e,0,25)},Ao=function(e){var t=document.createElement("a");return t.href=e,t},xo=function(e){var t=Ao(e).search;t=t.slice(1);var n={};return t.split("&").forEach((function(e){var t,o,r=e.split("=");r.length&&(t=r[0],o=r[1]);try{n[t]=decodeURIComponent(void 0===o?"":o)}catch(e){n[t]=o}})),n},Do=function(){function e(e,t,n,o){this.config=e,this.cfg=t,this.storage=new yo(!1),this.appInfo=e.app_key||e.app_id,this.isNoWebid=e.disable_webid,this.enable_ttwebid=e.enable_ttwebid||!1,this.domain=e.channel_domain||No(ko[e.channel]),this.tokenReady=!1,this.checkExp=e.checkExp||!1,this.enableCookie=e.cross_subdomain||!1,this.expiresTime=e.cookie_expire||Io,this.fetchUrl=""+this.domain+wo,this.hook=n,this.session=o,this.cookieDomain=e.cookie_domain||""}return e.prototype._getToken=function(){try{this.tokensKey=To(this.appInfo,!0),this.cookieKey="__tea_cookie_tokens_"+this.appInfo;var e=this.storage.getItem(this.tokensKey);if(this.enable_ttwebid)if(e){var t={user_unique_id:e.user_unique_id||"",timestamp:Date.now()};this.storage.setItem(this.tokensKey,t),this._setTtWid(e,!1)}else this._setTtWid(e,!0);else if(this.enableCookie){var n=this.storage.getCookie(this.cookieKey,this.cookieDomain);if(n){var o=(n=JSON.parse(decodeURIComponent(n))).user_unique_id,r=n.web_id,i=n.timestamp;this._setToken(r,o,i)}else{if(!e)return void this._requestWebId();this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(e)),this.expiresTime,this.cookieDomain),this._checkLocal(e)}}else{if(!e)return void this._requestWebId();this._checkLocal(e)}}catch(e){console.log(""+e.message)}},e.prototype._checkEnv=function(){if(-1!==window.navigator.userAgent.indexOf("miniProgram")){var e=xo(window.location.href);return!(!e||!e.Web_ID||(this._setTokenId(""+e.Web_ID),0))}return!1},e.prototype._checkLocal=function(e){var t=e.user_unique_id,n=e.web_id,o=e.timestamp;n&&t?this._setToken(n,t,o):this._requestWebId()},e.prototype._setToken=function(e,t,n){if(this.checkExp){var o=Date.now()-parseFloat(n);if(o>7344e6)return void this._requestWebId();if(o>432e7)return void this._updateWebId(e)}this.cfg.envInfo.user.user_unique_id=t,this.cfg.envInfo.user.web_id=e,this.storage.setItem(this.tokensKey,{user_unique_id:t,web_id:e,timestamp:Date.now()}),this.tokenReady=!0},e.prototype._requestWebId=function(){this.isNoWebid?this._setTokenId(Ro()):this._fetchWebId(this.fetchUrl,!1)},e.prototype._updateWebId=function(e){var t=""+this.domain+wo+"/"+e+"/update";this._fetchWebId(t,!0)},e.prototype._fetchWebId=function(e,t){var n=this;Co(e,3e3,{app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""},this.config.app_key,(function(e){e&&0===e.e?n._setTokenId(e.web_id):(n.hook.emit("token-error"),console.warn("[]appid: "+n.config.app_id+", "+(t?" update":"get")+" webid error, init error~"))}),(function(){n.hook.emit("token-error"),console.warn("[]appid: "+n.config.app_id+", get webid error, init error~")}),!0,!1,this.enable_ttwebid)},e.prototype._setTtWid=function(e,t){if(!t){var n={web_id:e.web_id||"",timestamp:Date.now()},o=e.user_unique_id||"";this.cfg.envInfo.user.user_unique_id=this.cfg.envInfo.user.user_unique_id||o,this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(n)),108e5,this.cookieDomain)}this.tokenReady=!0,this.hook.emit("token-ready")},e.prototype._setTokenId=function(e){var t=this.cfg.envInfo.user.web_id||e,n={web_id:t,user_unique_id:this.cfg.envInfo.user.user_unique_id||t,timestamp:Date.now()};this.enableCookie&&this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(n)),this.expiresTime,this.cookieDomain),this.storage.setItem(this.tokensKey,n),this.cfg.envInfo.user.web_id=this.cfg.envInfo.user.web_id||t,this.cfg.envInfo.user.user_unique_id=this.cfg.envInfo.user.user_unique_id||t,this.tokenReady=!0,this.hook.emit("token-ready")},e.prototype._setUuid=function(e){try{var t=this.storage.getItem(this.tokensKey);if(e){"string"!=typeof e&&console.warn("user_unique_id must be string!!! please check");var n=String(e);this.cfg.envInfo.user.user_unique_id=n,t&&t.user_unique_id?t.user_unique_id!==n&&(t.user_unique_id=n,this.hook.emit("uuid-change")):((t={}).user_unique_id=n,this.hook.emit("uuid-change")),t.timestamp=Date.now(),this.storage.setItem(this.tokensKey,t),this.session._resetSessionId()}else this._clearUuid(t)}catch(e){}},e.prototype._clearUuid=function(e){this.enable_ttwebid||e&&e.web_id&&(this.cfg.envInfo.user.user_unique_id=e.web_id,e.user_unique_id=e.web_id,e.timestamp=Date.now(),this.storage.setItem(this.tokensKey,e))},e.prototype._setWebid=function(e){if(!this.enable_ttwebid){var t=this.storage.getItem(this.tokensKey),n=!1;t&&t.web_id?t.web_id!==e&&(t.user_unique_id=t.web_id===t.user_unique_id?e:t.user_unique_id,t.web_id=e,this.cfg.envInfo.user.user_unique_id&&this.cfg.envInfo.user.user_unique_id!==this.cfg.envInfo.user.web_id||(this.cfg.envInfo.user.user_unique_id=e,n=!0)):(t={}).web_id=e,t.timestamp=Date.now(),this.cfg.envInfo.user.web_id=e,this.storage.setItem(this.tokensKey,t),n&&this.hook.emit("uuid-change")}},e.prototype.isTokenReady=function(){return this.tokenReady},e.prototype._getTobId=function(e){var t=this.domain+"/tobid";Co(t,3e4,{app_id:this.config.app_id,user_unique_id:this.cfg.envInfo.user.user_unique_id,web_id:this.cfg.envInfo.user.web_id},this.config.app_key,(function(t){t&&0===t.e?e(t.tobid):e(null)}),(function(){e(null)}),!0,!1,this.enable_ttwebid)},e}(),Bo=function(e){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)},Po=function(){function e(e,t,n,o,r,i,a){this.collect=e,this.cfg=n,this.config=t,this._token=o,this.appInfo=t.app_id||t.app_key,this.debugMode=!!t.log,this.evtDataKey=To(this.appInfo,!1);var s=t.channel_domain||No(ko[t.channel]);this.reportUrl=t.report_url?t.report_url:""+s+Eo,this.storage=new yo(!0),this.EventStorage=new yo(!1),this.maxStorage=t.max_storage_num||-1,this.maxReport=t.max_report||10,this.reportTime=t.reportTime||30,this.timeout=t.timeout||1e5,this.closeStorage=!0,this.plugin=r,this.session=i,this.match=a,this.filter=t.filter,this.addListener()}return e.prototype.addListener=function(){var e=this;window.addEventListener("unload",(function(){e.report(!0)}),!1),Bo((function(){e.report(!0)})),document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e.report(!0)}),!1)},e.prototype.setReady=function(){this.isReady=!0,this.report()},e.prototype.event=function(e){var t=this;void 0===e&&(e=[]);try{var n=po(e,this.storage.getItem(this.evtDataKey)||[]);this.storage.setItem(this.evtDataKey,n),this.reportTimer&&clearTimeout(this.reportTimer),n.length>=this.maxReport?this.report(!1):this.reportTimer=setTimeout((function(){t.report(!1),t.reportTimer=null}),this.reportTime)}catch(e){}},e.prototype.beconEvent=function(e){void 0===e&&(e=[]);var t=this._mergeEvents(e);this._dealData(t,!0)},e.prototype.report=function(e){if(void 0===e&&(e=!1),!this.collect.destroyInstance&&this._token.isTokenReady()&&this.isReady){var t=this.storage.getItem(this.evtDataKey)||[],n=this._mergeEvents(t);this.storage.removeItem(this.evtDataKey),this._dealData(n,e)}},e.prototype._mergeEvents=function(e){var t=this;if(!e.length)return e;var n=this.cfg.get();n.header.custom=JSON.stringify(n.header.custom);var o=[];return o.push(e),o.map((function(e){return{events:e.map((function(e){try{if(e.event&&"applog_trace"!==e.event){var n=ho({},t.cfg.get("evtParams"),e.params);return delete n.__disable_storage__,ho({},e,{params:JSON.stringify(n),session_id:t.session._getSessionId()})}return ho({},e,{params:JSON.stringify(e.params)})}catch(t){return ho({},e,{params:JSON.stringify(e.params)})}})),user:n.user,header:n.header,verbose:t.debugMode?1:void 0,local_time:parseInt(""+(new Date).getTime()/1e3)}}))},e.prototype._dealData=function(e,t){var n=this;if(!e.length)return e;e.map((function(e){var t=[];return t.push(e),t})).forEach((function(e){var o=Ro(),r=e;try{n.filter&&(r=n.filter(e))}catch(e){}n._send(o,r,t)}))},e.prototype._send=function(e,t,n){var o=this;this.isSending=!0;var r=function(){o.isSending=!1};Co(this.reportUrl,this.timeout,t,this.config.app_key,(function(e,t){r(),e&&0!==e.e&&o.collect&&o.collect.tracer&&1!==o.cfg.staging&&o.collect.tracer.addErrorCount(t,"f_data",e.e,e)}),(function(e,t){r(),o.cfg.get("reportErrorCallback")(e,t),o.collect&&o.collect.tracer&&1!==o.cfg.staging&&o.collect.tracer.addErrorCount(e,"f_net",t)}),!1,n,this.config.enable_ttwebid,r)},e.prototype.checkStorageEvent=function(){},e}(),zo=void 0,Mo=(new Date).getTimezoneOffset(),jo=parseInt(""+-Mo/60,10),Uo=60*Mo,Vo=function(){function e(e,t,n){this.initConfig=t;var o=function(e,t,n){var o,r,i=window.screen.width,a=window.screen.height,s=window.navigator.appVersion,c=window.navigator.userAgent,l=window.navigator.language,u=document.referrer,d=u?Ao(u).hostname:"",h=xo(window.location.href),f="",p="",g="",_=""+parseFloat(s);-1!==(o=c.indexOf("Opera"))&&(g="Opera",_=c.substring(o+6),-1!==(o=c.indexOf("Version"))&&(_=c.substring(o+8))),-1!==(o=c.indexOf("Edge"))?(g="Microsoft Edge",_=c.substring(o+5)):-1!==(o=c.indexOf("MSIE"))?(g="Microsoft Internet Explorer",_=c.substring(o+5)):-1!==(o=c.indexOf("Lark"))?(g="Lark",_=c.substring(o+5,o+11)):-1!==c.indexOf("Chrome")?-1!==(o=c.indexOf("MicroMessenger"))?(g="weixin",_=c.substring(o+15,o+20)):-1!==(o=c.indexOf("MQQBrowser"))?(g="qqbrowser",_=c.substring(o+11,o+15)):-1!==(o=c.indexOf("360"))?(g="360browser",_=c.substring(c.indexOf("Chrome")+7)):-1!==c.indexOf("baidubrowser")||-1!==c.indexOf("BIDUBrowser")?(-1!==c.indexOf("baidubrowser")?(o=c.indexOf("baidubrowser"),_=c.substring(o+13,o+16)):-1!==c.indexOf("BIDUBrowser")&&(o=c.indexOf("BIDUBrowser"),_=c.substring(o+12,o+15)),g="baidubrowser"):-1!==(o=c.indexOf("xiaomi"))?-1!==c.indexOf("openlanguagexiaomi")?(g="openlanguage xiaomi",_=c.substring(o+7,o+13)):(g="xiaomi",_=c.substring(o-7,o-1)):-1!==(o=c.indexOf("TTWebView"))?(g="TTWebView",_=c.substring(o+10,o+23)):-1!==(o=c.indexOf("Chrome"))&&(g="Chrome",_=c.substring(o+7)):-1!==c.indexOf("Safari")?-1!==(o=c.indexOf("QQ"))?(g="qqbrowser",_=c.substring(o+10,o+16)):-1!==(o=c.indexOf("Safari"))&&(g="Safari",_=c.substring(o+7),-1!==(o=c.indexOf("Version"))&&(_=c.substring(o+8))):-1!==(o=c.indexOf("Firefox"))?(g="Firefox",_=c.substring(o+8)):-1!==(o=c.indexOf("MicroMessenger"))?(g="weixin",_=c.substring(o+15,o+20)):-1!==(o=c.indexOf("QQ"))&&(g="qqbrowser",_=c.substring(o+3,o+8)),-1!==(r=_.indexOf(";"))&&(_=_.substring(0,r)),-1!==(r=_.indexOf(" "))&&(_=_.substring(0,r)),-1!==(r=_.indexOf(")"))&&(_=_.substring(0,r));for(var m,v,b=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(s)?"wap":"web",y=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],k=0;k<y.length;k++){var w=y[k];if(w.r.test(c)){f=w.s;break}}function E(e,t){var n=e.exec(t);return n&&n[1]?n[1]:""}switch(/Windows/.test(f)&&(p=E(/Windows (.*)/,f),f="windows"),f){case"Mac OS X":m=c,p=(v=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?)","i").exec(m))?v.slice(1)[0]:"",f="mac";break;case"Android":p=function(e){var t=E(/Android ([\.\_\d]+)/,e);return t||(t=E(/Android\/([\.\_\d]+)/,e)),t}(c),f="android";break;case"iOS":p=(p=/OS (\d+)_(\d+)_?(\d+)?/.exec(s))?p[1]+"."+p[2]+"."+(0|p[3]):"",f="ios"}var S=function(e,t,n,o){var r=new yo(!1),i=new yo(!1,"session"),a=e?"_tea_utm_cache_"+e:"_tea_utm_cache",s=e?"_$utm_from_url_"+e:"_$utm_from_url",c={},l=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],u={creative_id:Number(t.creative_id),ad_id:Number(t.ad_id),campaign_id:Number(t.campaign_id),utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4},d=o;try{var h=!1;for(var f in u)u[f]&&(-1!==l.indexOf(f)?(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data[f]=u[f]):c[f]=u[f],h=!0);if(h)i.setItem(s,"1"),r.setCookie(a,JSON.stringify(c),d,n);else{var p=r.getCookie(a,n);p&&(c=JSON.parse(p)),r.setCookie(a,p,d,n)}i.getItem(s)&&(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data.$utm_from_url=1)}catch(e){return u}return c}(e,h,t,n);return{browser:g,browser_version:_,platform:b,os_name:f,os_version:p,userAgent:c,screen_width:i,screen_height:a,device_model:function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach((function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))}));else if("ios"===e||"mac"===e||"windows"===e){var n=navigator.userAgent.replace("Mozilla/5.0 (",""),o=n.indexOf(";");t=n.slice(0,o)}}catch(e){}return t.trim()}(f),language:l,referrer:u,referrer_host:d,creative_id:S.creative_id,ad_id:S.ad_id,campaign_id:S.campaign_id,utm_source:S.utm_source,utm_medium:S.utm_medium,utm_campaign:S.utm_campaign,utm_term:S.utm_term,utm_content:S.utm_content,tracer_data:S.tracer_data}}(e,t.cookie_domain||"",t.cookie_expire||Io);this.configKey=function(e){return"__tea_cache_config_"+e}(""+e),this.sessionStorage=new yo(!1,"session"),this.localStorage=new yo(!1,"local"),n&&(this.storage=1===n?this.sessionStorage:this.localStorage),this.envInfo={user:{user_unique_id:zo,user_type:zo,user_id:zo,user_is_auth:zo,user_is_login:zo,device_id:zo,web_id:zo,ip_addr_id:zo,ssid:zo},header:{app_id:zo,app_name:zo,app_install_id:zo,install_id:zo,app_package:zo,app_channel:zo,app_version:zo,os_name:o.os_name,os_version:o.os_version,device_model:o.device_model,ab_client:zo,ab_version:zo,ab_sdk_version:zo,traffic_type:zo,client_ip:zo,device_brand:zo,os_api:zo,access:zo,language:o.language,region:zo,app_language:zo,app_region:zo,creative_id:o.creative_id,ad_id:o.ad_id,campaign_id:o.campaign_id,log_type:zo,rnd:zo,platform:o.platform,sdk_version:So,sdk_lib:"js",province:zo,city:zo,timezone:jo,tz_offset:Uo,tz_name:zo,sim_region:zo,carrier:zo,resolution:o.screen_width+"x"+o.screen_height,browser:o.browser,browser_version:o.browser_version,referrer:o.referrer,referrer_host:o.referrer_host,width:o.screen_width,height:o.screen_height,screen_width:o.screen_width,screen_height:o.screen_height,utm_term:o.utm_term,utm_content:o.utm_content,utm_source:o.utm_source,utm_medium:o.utm_medium,utm_campaign:o.utm_campaign,tracer_data:JSON.stringify(o.tracer_data),custom:{}}},this.evtParams={},this.reportErrorCallback=function(){}}return e.prototype.set=function(e,t){var n=this;if(null==t&&(this.delete(e),t=void 0),"evtParams"===e||"_staging_flag"===e){var o;o="evtParams"===e?t:{_staging_flag:Number(t)};var r=ho({},o);Object.keys(r).forEach((function(e){n.evtParams[e]=r[e]}))}else if("reportErrorCallback"===e&&"function"==typeof t)this.reportErrorCallback=t;else{var i="";if(e.indexOf(".")>-1){var a=e.split(".");i=a[0],e=a[1]}if("user_unique_id"===e){if(!t)return;if(-1!==["0","Null","None","","undefined"].indexOf(t))return}if("os_version"===e&&(e=""+t),"web_id"===e){if(!t)return;(!this.envInfo.user.user_unique_id||this.envInfo.user.user_unique_id&&this.envInfo.user.user_unique_id===this.envInfo.user.web_id)&&(this.envInfo.user.user_unique_id=t)}i?"user"===i||"header"===i?this.envInfo[i][e]=t:this.envInfo.header.custom[e]=t:this.envInfo.user.hasOwnProperty(e)?["user_type","ip_addr_id"].indexOf(e)>-1?this.envInfo.user[e]=t?Number(t):t:["user_id","web_id","user_unique_id","ssid"].indexOf(e)>-1?this.envInfo.user[e]=t?String(t):t:["user_is_auth","user_is_login"].indexOf(e)>-1?this.envInfo.user[e]=Boolean(t):"device_id"===e&&(this.envInfo.user[e]=t):this.envInfo.header.hasOwnProperty(e)?this.envInfo.header[e]=t:this.envInfo.header.custom[e]=t}},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){console.log("get config stringify error ")}},e.prototype.setStore=function(e){try{var t=this.storage.getItem(this.configKey);if(Object.keys(e).length){var n=Object.assign(e,t);this.storage.setItem(this.configKey,n)}}catch(e){}},e.prototype.getStore=function(){try{var e=this.storage.getItem(this.configKey);return Object.keys(e).length?e:null}catch(e){return null}},e.prototype.delete=function(e){try{var t=this.storage.getItem(this.configKey);t&&t.hasOwnProperty(e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){}},e}(),Ho=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}var t=e.prototype;return t.info=function(e){this.isLog&&console.log("["+this.name+"] "+e)},t.warn=function(e){this.isLog&&console.warn("["+this.name+"] "+e)},t.error=function(e){this.isLog&&console.error("["+this.name+"] "+e)},t.throw=function(e){throw this.error(this.name),new Error(e)},e}(),Fo=function(){function e(){this._hooks={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var n=this;e&&t&&"function"==typeof t&&this.on(e,(function o(r){t(r),n.off(e,o)}))},e.prototype.off=function(e,t){if(e&&this._hooks[e]&&this._hooks[e].length)if(t){var n=this._hooks[e].indexOf(t);-1!==n&&this._hooks[e].splice(n,1)}else this._hooks[e]=[]},e.prototype.emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&po(this._hooks[e]).forEach((function(e){try{e(t)}catch(e){}}))},e}(),Ko=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},Go=function(){function e(e,t){this.storage=new yo(!1,"session"),this.sessionKey=function(e){return"__tea_session_id_"+e}(e),this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSession||this._setSessionId()}return e.prototype._updateSessionId=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=e.timestamp;Date.now()-t>this.expireTime?e={sessionId:Ko(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this._resetExpTime()}},e.prototype._setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:Ko(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.sessionExp=setInterval((function(){e._checkEXp()}),this.expireTime)},e.prototype._getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return this.disableSession?"":e&&e.sessionId?e.sessionId:""},e.prototype._resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval((function(){e._checkEXp()}),this.expireTime))},e.prototype._resetSessionId=function(){var e={sessionId:Ko(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,e)},e.prototype._checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:Ko(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))},e}(),Jo={pv:["predefine_pageview"],sdk:["_be_active","predefine_page_alive","predefine_page_close","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append"],autotrack:["bav2b_click","bav2b_page","bav2b_beat","bav2b_page_statistics","__bav_click","__bav_page","__bav_beat","__bav_page_statistics"]},qo=function(){function e(e,t,n,o){this.count={pv:0,sdk:0,autotrack:0,log:0},this.limit={pv:1,sdk:10,autotrack:10,log:3},this.errorCode={f_net:0,f_data:0},this.errorInfo={pv:{f_net:0,f_data:0},sdk:{f_net:0,f_data:0},autotrack:{f_net:0,f_data:0},log:{f_net:0,f_data:0}},this.collect=e,this.disable_tracer=t.disable_tracer||t.channel_domain,this.ready=!(!t.app_id||this.disable_tracer),this.appid=t.app_id,this.process=n,this.event=o;var r=t.channel_domain||No(ko[t.channel]);this.reportUrl=t.report_url?t.report_url:""+r+Eo,this.listener()}return e.prototype.addCount=function(e){try{if(!this.ready)return;if(this.count[e]++,this.count[e]>=this.limit[e]){var t=[];for(var n in t=po(t,this.processTracer(this.count[e],e,"net")),this.errorInfo[e])this.errorInfo[n]&&(t=po(t,this.processTracer(this.errorInfo[e][n],e,n)));t.length&&this.sendTracer(t,!0,e,!1)}}catch(e){}},e.prototype.addErrorCount=function(e,t,n,o){var r=this;try{if(!this.ready)return;if(e&&e.length){var i=e[0].events;i&&i.length&&("f_data"===t?(o&&o.hasOwnProperty("sc")?this.errorInfo.log.f_data=i.length-o.sc:this.errorInfo.log.f_data=i.length,this.errorCode.f_data=n):i.forEach((function(e){var t="log";for(var o in Jo)if(-1!==Jo[o].indexOf(e.event)){t=o;break}r.errorInfo[t].f_net++,r.errorCode.f_net=n})))}}catch(e){}},e.prototype.clearCount=function(e){try{e?(this.count[e]=0,this.errorInfo[e]={f_net:0,f_data:0}):(this.count={pv:0,sdk:0,autotrack:0,log:0},this.errorInfo={pv:{f_net:0,f_data:0},sdk:{f_net:0,f_data:0},autotrack:{f_net:0,f_data:0},log:{f_net:0,f_data:0}})}catch(e){}},e.prototype.sendTracer=function(e,t,n,o){try{if(!this.ready)return;if(this.collect.staging)return;var r=this.event._mergeEvents(e);o&&window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify(r)):Co(this.reportUrl,3e5,r,""),t?this.clearCount(n):this.clearCount()}catch(e){}},e.prototype.processTracer=function(e,t,n){try{var o={count:e,state:n,key:t,params_for_special:"applog_trace",aid:this.appid,platform:"web",_staging_flag:1,sdk_version:So};"f_net"!==n&&"f_data"!==n||(o.errorCode=this.errorCode[n]);var r=[];if(r.push(this.process("applog_trace",o,!0)),r&&r.length)return delete r[0].is_bav,r}catch(e){}},e.prototype.listener=function(){var e=this;this.ready&&(document.addEventListener("visibilitychange",(function(){e.leavePage()})),Bo((function(){e.leavePage()})))},e.prototype.leavePage=function(){if(this.ready)try{var e=[];for(var t in this.count)if(this.count[t]){var n=this.errorInfo[t];for(var o in e=po(e,this.processTracer(this.count[t],t,"net")),n)n[o]&&(e=po(e,this.processTracer(n[o],t,o)))}e&&e.length&&this.sendTracer(e,!1,"",!0)}catch(e){}},e}(),Wo=function(){function e(e){this.logger=e}var t=e.prototype;return t.bridgeInject=function(){try{return AppLogBridge?(this.logger.info("AppLogBridge is injected"),!0):(this.logger.info("AppLogBridge is not inject"),!1)}catch(e){return this.logger.info("AppLogBridge is not inject"),!1}},t.hasStarted=function(e){var t=this;try{this.bridgeInject()?AppLogBridge.hasStarted((function(n){t.logger.info("AppLogBridge is started? : "+n),e(n)})):e(0)}catch(t){this.logger.info("AppLogBridge, error:"+JSON.stringify(t.stack)),e(0)}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(e){this.logger.error("setUserUniqueId error")}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(e){this.logger.error("addHeaderInfo error")}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(e){this.logger.error("setHeaderInfo error")}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(e){this.logger.error("removeHeaderInfo error")}},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t)}catch(e){this.logger.error("onEventV3 error")}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(e){this.logger.error("profileSet error")}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(e){this.logger.error("profileSetOnce error")}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(e){this.logger.error("profileIncrement error")}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(e){this.logger.error("profileUnset error")}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(e){this.logger.error("profileAppend error")}},e}();function $o(e,t,n){void 0===t&&(t=""),void 0===n&&(n={});var o=e;"/"===(o=o.split("#")[0].split("?")[0])[e.length-1]&&(o=o.substr(0,e.length-1)),o="/"===t[0]?o.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?)(\/[.\w-]+)*\/?$/,"$1"+t):o.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?(\/[.\w-]+)*?)(\/[.\w-]+)?\/?$/,"$1/"+t);var r=Object.keys(n).map((function(e){return e+"="+n[e]})).join("&");return r.length>0?o+"?"+r:o}var Yo,Qo=function(){function e(e){this.autotrack=!1,this.spa=!1,(e.spa||e.autotrack)&&(this.autotrack=!!e.autotrack,this.spa=e.spa,this.fncArray=new Map,this.setLocation(),this.hack(),this.storage=new yo(!0),this.storage.setItem("__tea_cache_refer_key",location.href),this.listener())}return e.prototype.hack=function(){var e=this,t=window.history.pushState;history.pushState=function(n){for(var o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];"function"==typeof history.onpushstate&&history.onpushstate({state:n});var i=t.call.apply(t,po([history,n],o)),a=e.getPopStateChangeEventData();return e.lastLocation=$o(location.href,o[1]),e.storage.setItem("__tea_cache_refer_key",e.lastLocation),e.sendPv(a),i};var n=history.replaceState;history.replaceState=function(t){for(var o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];"function"==typeof history.onreplacestate&&history.onreplacestate({state:t});var i=n.call.apply(n,po([history,t],o)),a=e.getPopStateChangeEventData();return e.lastLocation=$o(location.href,o[1]),e.storage.setItem("__tea_cache_refer_key",e.lastLocation),e.sendPv(a),i}},e.prototype.setLocation=function(){"undefined"!=typeof window&&(this.lastLocation=window.location.href)},e.prototype.add=function(e,t){this.fncArray.get(e)||this.fncArray.set(e,t)},e.prototype.init=function(e,t){this.add(e,t),this.fncArray.get(e)(this.getPopStateChangeEventData())},e.prototype.listener=function(){var e=this,t=null;window.addEventListener("hashchange",(function(n){e.lastLocation!==window.location.href&&clearTimeout(t)})),window.addEventListener("popstate",(function(n){e.lastLocation!==window.location.href&&(t=setTimeout((function(){e.lastLocation=window.location.href;var t=e.getPopStateChangeEventData();e.sendPv(t)}),10))}))},e.prototype.getPopStateChangeEventData=function(){var e=this.pageConfig();return e.is_back=0,e},e.prototype.pageConfig=function(){var e="";try{e=document.referrer?document.referrer:this.storage.getItem("__tea_cache_refer_key")||""}catch(e){}return{is_html:1,url:location.href,referrer:e,page_key:location.href,refer_page_key:e,page_manual_key:"",refer_page_manual_key:""}},e.prototype.sendPv=function(e){this.fncArray.forEach((function(t){t(e)}))},e}(),Xo=po(["init","config","send","start","predefinePageView","beconEvent","on","resetStayDuration","autoInitializationRangers"],["profileSet","profileSetOnce","profileIncrement","profileUnset","profileAppend","getVar","getAbSdkVersion","onAbSdkVersionChange","offAbSdkVersionChange","getABconfig","openOverlayer","closeOverlayer","getAllVars","setExternalAbVersion","getToken","destroy"]),Zo=(Yo=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return Yo+=1}),er=function(){function e(e){var t=this;this.is_first_time=!1,this.Native=!1,this.staging=!1,this.sdkload=!1,this.initPv=!0,this.predefinePageView=function(e){if(void 0===e&&(e={}),t.sdkload){var n={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+t.is_first_time},o=ho({},n,e);t.event("predefine_pageview",o,"pv")}else t.logger.warn("sdk init error, api can not call")},this.getToken=function(e,t){},this.name=e,this._isSend=!1,this.hook=new Fo,this.storage=new yo(!1)}return e.prototype.autoInitializationRangers=function(e){e&&e.app_id&&(this.autoBase=!0,function(e){var t=e.app_id,n=e.channel,o=e.onTokenReady,r=""+No(ko[n])+wo,i=new yo(!1),a=To(t,!0),s=i.getItem(a);s&&s.web_id?o(s.web_id):Co(r,3e3,{app_key:"",app_id:t,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer},"",(function(e){if(e&&0===e.e){o(e.web_id);var t={web_id:e.web_id,ssid:e.ssid,user_unique_id:e.web_id,timestamp:Date.now()};i.setItem(a,t)}else o("")}),(function(){o("")}),!0)}(e))},e.prototype.init=function(e){var t=this;if(!this.autoBase&&!this._inited)if(this._inited=!0,e&&"object"==typeof e){this.logger=new Ho(this.name,e.log);var n=e.app_id,o=e.app_key;o||n?n&&"number"!=typeof n?this.logger.warn("app_id param is error, must be number, please check !!!"):o&&"string"!=typeof o?this.logger.warn("app_key is empty, please check!"):(e.channel_domain||-1!==["cn","sg","va"].indexOf(e.channel)||(this.logger.warn("channel must be `cn`, `sg`,`va` !!!"),e.channel="cn"),this.Native=e.Native,this._initConfig=e,this.appBridge=new Wo(this.logger),this.storage.getItem("__tea_cache_first_"+n)?this.is_first_time=!1:(this.is_first_time=!0,this.storage.setItem("__tea_cache_first_"+n,"1")),this.sdkload=!0,e.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted((function(n){n||t._init(e)})):this._init(e)):this.logger.warn("no app_key or app_id please check !!!")}else console.warn("init params is error,please check")},e.prototype._init=function(e){var t=this;this.autoPV=!0,this.sdkload=!0,this._initConfig=e,this._config=new Vo(e.app_id,e,e.configPersist||0),this.configPersist=e.configPersist||0,this._config.set("app_id",e.app_id),this.hook.on("token-ready",(function(){t.callbackSend?t._isSend?t._event&&t._event.report():t.start():t._event&&t._event.report()})),this._session=new Go(e.app_key||e.app_id,e),this._token=new Do(e,this._config,this.hook,this._session),this._event=new Po(this,e,this._config,this._token,this.plugin,this._session,this.match),this.tracer=new qo(this,e,this._processEvent.bind(this),this._event),this.spaView=new Qo(e),this._token._getToken()},e.prototype.config=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted((function(n){if(n)for(var o in e)"user_unique_id"===o?t.appBridge.setUserUniqueId(e[o]):e[o]?t.appBridge.addHeaderInfo(o,e[o]):t.appBridge.removeHeaderInfo(o);else t._setConfig(e)})):this._setConfig(e):this.logger.warn("sdk init error, api can not call")},e.prototype._setConfig=function(e){if(!this.autoBase)if(this._inited)if(e&&"object"==typeof e){e.disable_auto_pv&&(this.autoPV=!1,delete e.disable_auto_pv),e._staging_flag&&1===e._staging_flag&&(this.staging=!0);var t=ho({},e);if(this.configPersist){var n=this._config.getStore();n&&(t=Object.assign(n,e)),this._config.setStore(e)}for(var o in t)"user_unique_id"!==o?"web_id"!==o?this._config.set(o,t[o]):this._token._setWebid(t[o]):this._token._setUuid(t[o])}else this.logger.warn("config params is error, please check");else this.logger.warn("config must be use after function init")},e.prototype.on=function(e,t){try{e&&"string"==typeof e&&"function"==typeof t&&this.hook.on(e,t)}catch(e){}},e.prototype.send=function(){this.start()},e.prototype.start=function(){var e=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted((function(t){t?(e.logger.info("jsbrigeå¼å¯ï¼äºä»¶å°ç±åç sdkè¿è¡ä¸æ¥"),e.predefinePageView()):e._start()})):this._start():this.logger.warn("sdk init error, api can not call")},e.prototype._start=function(){var e=this;if(!this.autoBase)if(this._token.isTokenReady()){if(this._isSend)return void this.logger.warn("method start can not be use over one time , please check !!");this._isSend=!0,this.logger.info("userInfo:"+JSON.stringify(this._config.get("user"))),this.logger.info("sdk is ready,version is 4.2.6. you can report now !!!"),this._event.setReady(),this.autoPV&&(this.predefinePageView(),this.initPv=!1),this._initConfig.spa&&this.spaView.add("spa",this.predefinePageView),this.hook.on("uuid-change",(function(){e.initPv||e.predefinePageView()}));try{(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(e){}}else this.callbackSend=!0},e.prototype.beconEvent=function(e,t,n){var o=this;void 0===t&&(t={});var r=n||"log",i=[];i.push([e,t]),i=i.map((function(e){return o._processEvent(e[0],e[1])})),this._dealEvent(!0,i,r),this._addTracerCount(r)},e.prototype.event=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(this.sdkload){var o=fo(t,1)[0],r=[];"Array"!==Object.prototype.toString.call(o).slice(8,-1)?r[0]=t:r=t,r=r.map((function(t){return e._processEvent(t[0],t[1])})),this._dealEvent(!1,r,"log"),this._addTracerCount("log")}else this.logger.warn("sdk init error, api can not call")},e.prototype._dealEvent=function(e,t,n){var o=this;if(this.sdkload)if(this.Native&&this.appBridge.bridgeInject()){if("autotrack"===n||"sdk"===n)return;this.appBridge.hasStarted((function(n){n?t&&t.length&&t.forEach((function(e){var t=e.event,n=e.params;o.appBridge.onEventV3(t,JSON.stringify(n))})):o._commonEvent(e,t)}))}else this._commonEvent(e,t);else this.logger.warn("sdk init error, api can not call")},e.prototype._commonEvent=function(e,t){e?this._event.beconEvent(t):this._event.event(t),this._session._updateSessionId()},e.prototype._addTracerCount=function(e){this.sdkload?this.Native||this.staging||this.tracer.addCount(e):this.logger.warn("sdk init error, api can not call")},e.prototype._processEvent=function(e,t){try{var n=e;/^event\./.test(e)&&(n=e.slice(6));var o,r=t;return"object"!=typeof r&&(r={}),r.profile?delete r.profile:r.event_index=Zo(),r.local_ms?(o=r.local_ms,delete r.local_ms):o=+new Date,{event:n,params:r,local_time_ms:o,is_bav:this._initConfig.autotrack?1:0}}catch(n){return{event:e,params:t}}},e.prototype.resetStayDuration=function(e,t,n){},e.prototype.profileSet=function(e){},e.prototype.profileSetOnce=function(e){},e.prototype.profileIncrement=function(e){},e.prototype.profileUnset=function(e){},e.prototype.profileAppend=function(e){},e.prototype.setExternalAbVersion=function(e){},e.prototype.getVar=function(e,t,n){},e.prototype.getABconfig=function(e,t){},e.prototype.getAbSdkVersion=function(e){},e.prototype.onAbSdkVersionChange=function(e){},e.prototype.offAbSdkVersionChange=function(e){},e.prototype.openOverlayer=function(){},e.prototype.closeOverlayer=function(){},e.prototype.getAllVars=function(e){},e.prototype.destroy=function(){this.destroyInstance||(this.destroyInstance=!0,this.hook.off("token-ready"))},e}();function tr(e){var t=this;return uo(this,"_exportCollect",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];t._isProcess?t._executeCmd.apply(t,n):(t.cmdQueue.push(n),t._processCmd())})),uo(this,"_processCmd",(function(){if(0!==t.cmdQueue.length){var e,n=function(e,t,n){var o=-1;return e.forEach((function(e,r){(void 0!==n?e[n]:e)===t&&(o=r)})),o};-1===(e=n(t.cmdQueue,"autoInitializationRangers","0"))&&(e=n(t.cmdQueue,"init","0")),-1!==e&&(t._isProcess=!0,t._executeCmd.apply(t,t.cmdQueue[e]),t.cmdQueue.forEach((function(n,o){o!==e&&t._executeCmd.apply(t,n)})),t.cmdQueue=[])}})),uo(this,"_executeCmd",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];var r,i,a=n[0];Xo.indexOf(a)>-1?(r=t.colloctor)[a].apply(r,n.slice(1)):(i=t.colloctor).event.apply(i,n)})),this.cmdQueue=[],this.name=e,this.colloctor=new er(e),this._isProcess=!1,this._alias={},this._processCmd(),Xo.forEach((function(e){t._exportCollect[e]=t._exportCollect.bind(t,e)})),this._exportCollect}let nr={};const or=new Map;function rr(e,t,n){let o=or.get(e);o&&o.handleTopicSyncMsg&&o.handleTopicSyncMsg.call(null,t,n)}function ir(e,t,n){let o=or.get(e);o&&o.handleSyncEvent&&o.handleSyncEvent.call(null,t,n)}function ar(e,t){or.set(e,t)}function sr(e){or.delete(e)}var cr=Object.freeze({__proto__:null,send_message:rr,send_event:ir,init_ffi_sdk:function(){window.sync_sdk_ffi={setBizHandler:ar,removeBizHandler:sr}}});let lr,ur=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});ur.decode();let dr=null;function hr(){return null!==dr&&dr.buffer===lr.memory.buffer||(dr=new Uint8Array(lr.memory.buffer)),dr}function fr(e,t){return ur.decode(hr().subarray(e,e+t))}const pr=new Array(32).fill(void 0);pr.push(void 0,null,!0,!1);let gr=pr.length;function _r(e){gr===pr.length&&pr.push(pr.length+1);const t=gr;return gr=pr[t],pr[t]=e,t}function mr(e){return pr[e]}let vr=0,br=new TextEncoder("utf-8");const yr="function"==typeof br.encodeInto?function(e,t){return br.encodeInto(e,t)}:function(e,t){const n=br.encode(e);return t.set(n),{read:e.length,written:n.length}};function kr(e,t,n){if(void 0===n){const n=br.encode(e),o=t(n.length);return hr().subarray(o,o+n.length).set(n),vr=n.length,o}let o=e.length,r=t(o);const i=hr();let a=0;for(;a<o;a++){const t=e.charCodeAt(a);if(t>127)break;i[r+a]=t}if(a!==o){0!==a&&(e=e.slice(a)),r=n(r,o,o=a+3*e.length);const t=hr().subarray(r+a,r+o);a+=yr(e,t).written}return vr=a,r}let wr=null;function Er(){return null!==wr&&wr.buffer===lr.memory.buffer||(wr=new Int32Array(lr.memory.buffer)),wr}function Sr(e){const t=mr(e);return function(e){e<36||(pr[e]=gr,gr=e)}(e),t}function Tr(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let n="[";t>0&&(n+=Tr(e[0]));for(let o=1;o<t;o++)n+=", "+Tr(e[o]);return n+="]",n}const n=/\[object ([^\]]+)\]/.exec(toString.call(e));let o;if(!(n.length>1))return toString.call(e);if(o=n[1],"Object"==o)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:o}function Ir(e,t,n,o){const r={a:e,b:t,cnt:1,dtor:n},i=(...e)=>{r.cnt++;try{return o(r.a,r.b,...e)}finally{0==--r.cnt&&(lr.__wbindgen_export_2.get(r.dtor)(r.a,r.b),r.a=0)}};return i.original=r,i}function Or(e,t,n){lr._dyn_core__ops__function__Fn__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h7479134d6401c218(e,t,_r(n))}function Cr(e,t,n,o){const r={a:e,b:t,cnt:1,dtor:n},i=(...e)=>{r.cnt++;const t=r.a;r.a=0;try{return o(t,r.b,...e)}finally{0==--r.cnt?lr.__wbindgen_export_2.get(r.dtor)(t,r.b):r.a=t}};return i.original=r,i}function Lr(e,t){lr._dyn_core__ops__function__FnMut_____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h0126a0b4b375a785(e,t)}function Rr(e,t,n){lr._dyn_core__ops__function__Fn__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h8dd4ab5a5226ce8a(e,t,_r(n))}function Nr(e,t,n){lr._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h86129f0f8c01c66b(e,t,_r(n))}function Ar(e,t,n){lr._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h38d1fd3d52a44395(e,t,_r(n))}function xr(e,t){lr._dyn_core__ops__function__Fn_____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__hb2d9771dbb8e9e63(e,t)}function Dr(e,t){try{return e.apply(this,t)}catch(e){lr.__wbindgen_exn_store(_r(e))}}function Br(e,t){return hr().subarray(e/1,e/1+t)}async function Pr(e){const t={wbg:{}};t.wbg.__wbindgen_json_parse=function(e,t){return _r(JSON.parse(fr(e,t)))},t.wbg.__wbindgen_json_serialize=function(e,t){const n=mr(t);var o=kr(JSON.stringify(void 0===n?null:n),lr.__wbindgen_malloc,lr.__wbindgen_realloc),r=vr;Er()[e/4+1]=r,Er()[e/4+0]=o},t.wbg.__wbindgen_object_drop_ref=function(e){Sr(e)},t.wbg.__wbindgen_string_new=function(e,t){return _r(fr(e,t))},t.wbg.__wbindgen_string_get=function(e,t){const n=mr(t);var o="string"==typeof n?n:void 0,r=function(e){return null==e}(o)?0:kr(o,lr.__wbindgen_malloc,lr.__wbindgen_realloc),i=vr;Er()[e/4+1]=i,Er()[e/4+0]=r},t.wbg.__wbg_sendmessage_3334857cea1d6bc8=function(e,t,n,o,r){rr(fr(e,t),fr(n,o),Sr(r))},t.wbg.__wbg_sendevent_c3a0f1a06d44ed6c=function(e,t,n,o,r){ir(fr(e,t),fr(n,o),Sr(r))},t.wbg.__wbg_new_693216e109162396=function(){return _r(new Error)},t.wbg.__wbg_stack_0ddaca5d1abfb52f=function(e,t){var n=kr(mr(t).stack,lr.__wbindgen_malloc,lr.__wbindgen_realloc),o=vr;Er()[e/4+1]=o,Er()[e/4+0]=n},t.wbg.__wbg_error_09919627ac0992f5=function(e,t){try{console.error(fr(e,t))}finally{lr.__wbindgen_free(e,t)}},t.wbg.__wbindgen_object_clone_ref=function(e){return _r(mr(e))},t.wbg.__wbindgen_is_string=function(e){return"string"==typeof mr(e)},t.wbg.__wbg_fetch_0436c7fbee32fc7f=function(e){return _r(fetch(mr(e)))},t.wbg.__wbindgen_cb_drop=function(e){const t=Sr(e).original;return 1==t.cnt--&&(t.a=0,!0)},t.wbg.__wbg_instanceof_Window_c4b70662a0d2c5ec=function(e){return mr(e)instanceof Window},t.wbg.__wbg_navigator_480e592af6ad365b=function(e){return _r(mr(e).navigator)},t.wbg.__wbg_clearInterval_f94c74cd3759378b=function(e,t){mr(e).clearInterval(t)},t.wbg.__wbg_setInterval_ec2d9dc4a54a6566=function(){return Dr((function(e,t,n){return mr(e).setInterval(mr(t),n)}),arguments)},t.wbg.__wbg_setTimeout_df66d951b1726b78=function(){return Dr((function(e,t,n){return mr(e).setTimeout(mr(t),n)}),arguments)},t.wbg.__wbg_message_89579ebb65c23b17=function(e,t){var n=kr(mr(t).message,lr.__wbindgen_malloc,lr.__wbindgen_realloc),o=vr;Er()[e/4+1]=o,Er()[e/4+0]=n},t.wbg.__wbg_addEventListener_52721772cc0a7f30=function(){return Dr((function(e,t,n,o){mr(e).addEventListener(fr(t,n),mr(o))}),arguments)},t.wbg.__wbg_new_9c35e8e8b09fb4a3=function(){return Dr((function(){return _r(new Headers)}),arguments)},t.wbg.__wbg_append_fb85316567f7a798=function(){return Dr((function(e,t,n,o,r){mr(e).append(fr(t,n),fr(o,r))}),arguments)},t.wbg.__wbg_fetch_b4e81012e07ff95a=function(e,t){return _r(mr(e).fetch(mr(t)))},t.wbg.__wbg_readyState_d14de08ffb5783f5=function(e){return mr(e).readyState},t.wbg.__wbg_setonopen_33b75427f7db7ce1=function(e,t){mr(e).onopen=mr(t)},t.wbg.__wbg_setonerror_cb55f0521ac0da3a=function(e,t){mr(e).onerror=mr(t)},t.wbg.__wbg_setonclose_7094f96283d130e0=function(e,t){mr(e).onclose=mr(t)},t.wbg.__wbg_setonmessage_ca5f75e4a84134ef=function(e,t){mr(e).onmessage=mr(t)},t.wbg.__wbg_setbinaryType_c9a67ad8bb4125af=function(e,t){mr(e).binaryType=Sr(t)},t.wbg.__wbg_new_982fe22cd93d67f7=function(){return Dr((function(e,t){return _r(new WebSocket(fr(e,t)))}),arguments)},t.wbg.__wbg_newwithstrsequence_15aec70da899280b=function(){return Dr((function(e,t,n){return _r(new WebSocket(fr(e,t),mr(n)))}),arguments)},t.wbg.__wbg_close_f2a10c1de90df5f0=function(){return Dr((function(e){mr(e).close()}),arguments)},t.wbg.__wbg_send_503c2e7652e95bf5=function(){return Dr((function(e,t,n){mr(e).send(fr(t,n))}),arguments)},t.wbg.__wbg_send_73ab09dbae2da3c3=function(){return Dr((function(e,t,n){mr(e).send(Br(t,n))}),arguments)},t.wbg.__wbg_instanceof_Response_e1b11afbefa5b563=function(e){return mr(e)instanceof Response},t.wbg.__wbg_url_50e0bdb6051741be=function(e,t){var n=kr(mr(t).url,lr.__wbindgen_malloc,lr.__wbindgen_realloc),o=vr;Er()[e/4+1]=o,Er()[e/4+0]=n},t.wbg.__wbg_status_6d8bb444ddc5a7b2=function(e){return mr(e).status},t.wbg.__wbg_headers_5ffa990806e04cfc=function(e){return _r(mr(e).headers)},t.wbg.__wbg_arrayBuffer_b8937ed04beb0d36=function(){return Dr((function(e){return _r(mr(e).arrayBuffer())}),arguments)},t.wbg.__wbg_text_8279d34d73e43c68=function(){return Dr((function(e){return _r(mr(e).text())}),arguments)},t.wbg.__wbg_code_c8c420857439c0b4=function(e){return mr(e).code},t.wbg.__wbg_reason_a10c58463722f72e=function(e,t){var n=kr(mr(t).reason,lr.__wbindgen_malloc,lr.__wbindgen_realloc),o=vr;Er()[e/4+1]=o,Er()[e/4+0]=n},t.wbg.__wbg_data_9e55e7d79ab13ef1=function(e){return _r(mr(e).data)},t.wbg.__wbg_newwithstrandinit_9b0fa00478c37287=function(){return Dr((function(e,t,n){return _r(new Request(fr(e,t),mr(n)))}),arguments)},t.wbg.__wbg_initcollector_a5a2986ae7b2611f=function(e,t,n){return _r(function(e,t){let n=new tr(e);return n.init({app_id:8608,channel:"cn",disable_sdk_monitor:!0,disable_session:!0,disable_ssid:!0,...t}),n}(fr(e,t),Sr(n)))},t.wbg.__wbg_setconfig_78c7b1c3523a3b93=function(e,t){var n,o;n=mr(e),o=Sr(t),n&&n.config({...o})},t.wbg.__wbg_startcollect_0de88e816523cc4e=function(e){var t;(t=mr(e))&&t.start()},t.wbg.__wbg_sendeventstr_906e8c1143701d24=function(e,t,n,o){!function(e,t,n){if(!e)return;let{event:o,params:r}=n;try{let n=JSON.parse(r);e(o,{...nr[t],...n})}catch(e){console.error("JSON Parse Error:",e)}}(mr(e),fr(t,n),Sr(o))},t.wbg.__wbg_setcommonparams_5a6e6674e3aedb36=function(e,t,n,o){var r,i;r=fr(e,t),"string"==typeof(i=fr(n,o))&&(i=JSON.parse(i)),Object.keys(i).forEach((e=>{null===i[e]&&delete i[e]})),nr[r]={...nr[r],...i}},t.wbg.__wbg_logRecord_2b591c33cc395a15=function(e,t,n){!function(e,t){switch(console.log("logRecord",e,t),e){case 1:console.error(t);break;case 2:console.warn(t);break;case 3:console.info(t);break;case 4:console.debug(t);break;case 5:console.trace(t)}}(e,fr(t,n))},t.wbg.__wbg_new_949bbc1147195c4e=function(){return _r(new Array)},t.wbg.__wbindgen_is_function=function(e){return"function"==typeof mr(e)},t.wbg.__wbg_newnoargs_be86524d73f67598=function(e,t){return _r(new Function(fr(e,t)))},t.wbg.__wbindgen_is_object=function(e){const t=mr(e);return"object"==typeof t&&null!==t},t.wbg.__wbg_next_c4151d46d5fa7097=function(e){return _r(mr(e).next)},t.wbg.__wbg_next_7720502039b96d00=function(){return Dr((function(e){return _r(mr(e).next())}),arguments)},t.wbg.__wbg_done_b06cf0578e89ff68=function(e){return mr(e).done},t.wbg.__wbg_value_e74a542443d92451=function(e){return _r(mr(e).value)},t.wbg.__wbg_iterator_4fc4ce93e6b92958=function(){return _r(Symbol.iterator)},t.wbg.__wbg_get_4d0f21c2f823742e=function(){return Dr((function(e,t){return _r(Reflect.get(mr(e),mr(t)))}),arguments)},t.wbg.__wbg_call_888d259a5fefc347=function(){return Dr((function(e,t){return _r(mr(e).call(mr(t)))}),arguments)},t.wbg.__wbg_new_0b83d3df67ecb33e=function(){return _r(new Object)},t.wbg.__wbg_push_284486ca27c6aa8b=function(e,t){return mr(e).push(mr(t))},t.wbg.__wbg_instanceof_ArrayBuffer_764b6d4119231cb3=function(e){return mr(e)instanceof ArrayBuffer},t.wbg.__wbg_call_346669c262382ad7=function(){return Dr((function(e,t,n){return _r(mr(e).call(mr(t),mr(n)))}),arguments)},t.wbg.__wbg_getTime_10d33f4f2959e5dd=function(e){return mr(e).getTime()},t.wbg.__wbg_new0_fd3a3a290b25cdac=function(){return _r(new Date)},t.wbg.__wbg_now_af172eabe2e041ad=function(){return Date.now()},t.wbg.__wbg_new_b1d61b5687f5e73a=function(e,t){try{var n={a:e,b:t},o=new Promise(((e,t)=>{const o=n.a;n.a=0;try{return function(e,t,n,o){lr.wasm_bindgen__convert__closures__invoke2_mut__h4542240a7377cb36(e,t,_r(n),_r(o))}(o,n.b,e,t)}finally{n.a=o}}));return _r(o)}finally{n.a=n.b=0}},t.wbg.__wbg_resolve_d23068002f584f22=function(e){return _r(Promise.resolve(mr(e)))},t.wbg.__wbg_then_2fcac196782070cc=function(e,t){return _r(mr(e).then(mr(t)))},t.wbg.__wbg_then_8c2d62e8ae5978f7=function(e,t,n){return _r(mr(e).then(mr(t),mr(n)))},t.wbg.__wbg_self_c6fbdfc2918d5e58=function(){return Dr((function(){return _r(self.self)}),arguments)},t.wbg.__wbg_window_baec038b5ab35c54=function(){return Dr((function(){return _r(window.window)}),arguments)},t.wbg.__wbg_globalThis_3f735a5746d41fbd=function(){return Dr((function(){return _r(globalThis.globalThis)}),arguments)},t.wbg.__wbg_global_1bc0b39582740e95=function(){return Dr((function(){return _r(global.global)}),arguments)},t.wbg.__wbindgen_is_undefined=function(e){return void 0===mr(e)},t.wbg.__wbg_buffer_397eaa4d72ee94dd=function(e){return _r(mr(e).buffer)},t.wbg.__wbg_newwithbyteoffsetandlength_4b9b8c4e3f5adbff=function(e,t,n){return _r(new Uint8Array(mr(e),t>>>0,n>>>0))},t.wbg.__wbg_new_a7ce447f15ff496f=function(e){return _r(new Uint8Array(mr(e)))},t.wbg.__wbg_set_969ad0a60e51d320=function(e,t,n){mr(e).set(mr(t),n>>>0)},t.wbg.__wbg_length_1eb8fc608a0d4cdb=function(e){return mr(e).length},t.wbg.__wbg_has_1275b5eec3dc7a7a=function(){return Dr((function(e,t){return Reflect.has(mr(e),mr(t))}),arguments)},t.wbg.__wbg_set_82a4e8a85e31ac42=function(){return Dr((function(e,t,n){return Reflect.set(mr(e),mr(t),mr(n))}),arguments)},t.wbg.__wbg_stringify_d4507a59932eed0c=function(){return Dr((function(e){return _r(JSON.stringify(mr(e)))}),arguments)},t.wbg.__wbindgen_debug_string=function(e,t){var n=kr(Tr(mr(t)),lr.__wbindgen_malloc,lr.__wbindgen_realloc),o=vr;Er()[e/4+1]=o,Er()[e/4+0]=n},t.wbg.__wbindgen_throw=function(e,t){throw new Error(fr(e,t))},t.wbg.__wbindgen_memory=function(){return _r(lr.memory)},t.wbg.__wbindgen_closure_wrapper1255=function(e,t,n){return _r(Ir(e,t,373,Or))},t.wbg.__wbindgen_closure_wrapper1257=function(e,t,n){return _r(Cr(e,t,369,Lr))},t.wbg.__wbindgen_closure_wrapper1259=function(e,t,n){return _r(Ir(e,t,371,Rr))},t.wbg.__wbindgen_closure_wrapper1261=function(e,t,n){return _r(Cr(e,t,375,Nr))},t.wbg.__wbindgen_closure_wrapper1860=function(e,t,n){return _r(Cr(e,t,570,Ar))},t.wbg.__wbindgen_closure_wrapper1889=function(e,t,n){return _r(Ir(e,t,572,xr))},t["./snippets/sync-sdk-wasm-d51fd5cad9acb246/wasm_bind.js"]=cr,("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:o}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return lr=n.exports,Pr.__wbindgen_wasm_module=o,lr}var zr,Mr,jr;!function(e){e.Online="online",e.PreOnline="pre",e.Staging="staging",e.Boe="boe"}(zr||(zr={})),function(e){e.BIZ_KEY="BIZ_KEY",e.LAST_MSG="LAST_MSG"}(Mr||(Mr={})),function(e){e.SYNC_MSG_INVALID="SYNC_MSG_INVALID",e.TOKEN_INVALID="TOKEN_INVALID",e.RESET_SYNC_MSG="RESET_SYNC_MSG"}(jr||(jr={}));var Ur=null;function Vr(e){return co(this,void 0,void 0,(function(){function t(e){return co(this,void 0,void 0,(function(){var t;return lo(this,(function(n){switch(n.label){case 0:return t=function(e){var t=so({"internal-api":"internal-api.feishu.cn",open:"open.feishu.cn"},null==e?void 0:e.domainMap);return so(so({},e),{bizEnv:(null==e?void 0:e.bizEnv)||zr.Online,region:(null==e?void 0:e.region)||"feishu",domainMap:so(so({},t),{internal_api:t["internal-api"]})})}(e),[4,Pr(Jr(t.region))];case 1:return n.sent(),[4,(o=t,Sr(lr.init_sdk_async(_r(o))))];case 2:return[2,n.sent()]}var o}))}))}return lo(this,(function(n){switch(n.label){case 0:return Ur?[2,{context:Ur,register:Hr,subscribe:Fr,unsubscribe:Kr,invokeSyncEvent:Gr}]:[4,t(e)];case 1:return[2,{context:Ur=n.sent(),register:Hr,subscribe:Fr,unsubscribe:Kr,invokeSyncEvent:Gr}]}}))}))}function Hr(e,t){(0,window.sync_sdk_ffi.setBizHandler)(e,t),function(e){var t=kr(e,lr.__wbindgen_malloc,lr.__wbindgen_realloc),n=vr;lr.register(t,n)}(e)}function Fr(e,t,n){return function(e,t,n){return Sr(lr.subscribe(_r(e),_r(t),_r(n)))}(e,t,n)}function Kr(e,t){return function(e,t){return Sr(lr.unsubscribe(_r(e),_r(t)))}(e,t)}function Gr(e,t){!function(e,t){var n=kr(e,lr.__wbindgen_malloc,lr.__wbindgen_realloc),o=vr,r=kr(t,lr.__wbindgen_malloc,lr.__wbindgen_realloc),i=vr;lr.invoke_sync_event(n,o,r,i)}(e,JSON.stringify(t))}function Jr(e){var t=function(e){return"lark"===e}(e),n="https://lf1-cdn2-tos.bytegoofy.com";return t&&(n="https://sf16-scmcdn2-va.ipstatp.com"),n+"/lark/sync/web/0.2.0/index_bg.wasm"}const qr={host:"docs_block",locale:"zh-CN",env:"online",debug:!1,region:"feishu",platform:"pc"},Wr="block";function $r(e){return Object.assign(qr,e)}const Yr=`default_${Math.random().toString(36).slice(2)}`;let Qr;!function(e){e.getBlockList="getBlockList",e.generateBlock="generateBlock",e.getBlockEntity="getBlockEntity",e.getAuthToken="getAuthToken",e.getBlockEntityV2="getBlockEntityV2",e.cloneBlock="cloneBlock",e.generateInnerBlock="generateInnerBlock",e.checkVersion="checkVersion",e.fetchMessage="fetchMessage"}(Qr||(Qr={}));const Xr={[Qr.getBlockList]:{method:"POST",subDomain:"internal-api",path:"/lark/app_explorer/api/GetBlockTemplateList"},[Qr.generateBlock]:{method:"POST",subDomain:"open",path:"/open-apis/block/server/api/CreateBlockEntity"},[Qr.getBlockEntity]:{method:"POST",subDomain:"open",path:"/open-apis/block/server/api/MGetBlockEntityV2"},[Qr.getAuthToken]:{method:"POST",subDomain:"open",path:"/open-apis/block/server/api/GetHttpAuth"},[Qr.getBlockEntityV2]:{method:"POST",subDomain:"open",path:"/open-apis/block/server/api/client/GetBlockEntity"},[Qr.cloneBlock]:{method:"POST",subDomain:"open",path:"/open-apis/block/server/api/CloneBlock"},[Qr.generateInnerBlock]:{method:"POST",subDomain:"open",path:"/open-apis/block/server/api/GenerateBlock"},[Qr.checkVersion]:{method:"POST",subDomain:"open",path:"/open-apis/block/server/api/HeartbeatV2"},[Qr.fetchMessage]:{method:"POST",subDomain:"open",path:"/open-apis/block/server/api/MGetOpenMessage"}},Zr=["docs_block"];function ei(e,t=qr.host){return"pre"===e&&Zr.includes(qr.host)}function ti(e){return ei(e)?"online":e}function ni(e,t){return ei(t)?e.replace("-pre.","."):e}function oi(e,t="open",n="https"){const o=n?n+"://":"";if("object"==typeof e.domain&&e.domain[t]){const n=ni(e.domain[t],e.env);return function(e){return e.includes("://")}(n)?n:`${o}${n}`}const r=function(e){const t=ti(e.env),n="staging"===t||"boe"===t||"pre"===t?`-${t}`:"",o="feishu"===e.region?`feishu${n}.cn`:`larksuite${n}.com`;return`${e.prefix}.${o}`}({env:e.env,region:e.region,prefix:t});return o+r}function ri(e){return new URL(e).host}const ii="lark_block_server",ai="e9971a63-1873-4248-bf60-cee84990b60c";let si,ci=null,li=null,ui={userID:"",logID:""};function di(){return si}function hi(){const e={"internal-api":oi(qr,"internal-api"),"internal-api-lark-api":oi(qr,"internal-api-lark-api"),open:oi(qr,"open")};return Promise.resolve({bizEnv:ti(qr.env),logId:ui.logID,userId:ui.userID,region:qr.region,domainMap:{open:ni(ri(e.open),qr.env),"internal-api":ni(ri(e["internal-api"]),qr.env)}})}function fi(e,t){return ci||(e&&e.before(),ci=Promise.resolve(t||hi()).then(Vr).then((t=>(si=t.context.device_id,li&&t.register(...li),e&&e.success(),t)),(t=>{throw e&&e.fail(t),t}))),ci}function pi(e,t,n,o=0){return new Promise(((r,i)=>{setTimeout((()=>{e.subscribe({appName:ii,token:ai},t,n).then(r,i)}),o)})).catch((()=>pi(e,t,n,Math.min(o+3e3,3e4))))}function gi(e,t){return(ci||fi()).then((n=>{const o=t?{type:Mr.BIZ_KEY,value:t}:{type:Mr.LAST_MSG,value:1};return pi(n,e,{syncMsgResetConfig:o})}))}var _i;!function(e){e[e.UnknownError=-1]="UnknownError",e[e.RequestError=1]="RequestError",e[e.ParameterError=2]="ParameterError",e[e.ImportError=3]="ImportError",e[e.NetworkError=4]="NetworkError",e[e.TimeoutError=5]="TimeoutError",e[e.InitError=31]="InitError",e[e.CollaborationError=32]="CollaborationError",e[e.DiagnoseError=33]="DiagnoseError",e[e.GetBlockEntityError=34]="GetBlockEntityError"}(_i||(_i={}));class mi extends Error{constructor(t){t instanceof Error?(super(t.message),e(this,"name",void 0),e(this,"code",void 0),this.stack=t.stack,this.code=mi.code.UnknownError):"object"==typeof t&&t?(super(t.message),e(this,"name",void 0),e(this,"code",void 0),this.code=t.code||mi.code.UnknownError):(super(t),e(this,"name",void 0),e(this,"code",void 0),this.code=mi.code.UnknownError),this.name=this.code?mi.code[this.code]:"OPError"}toString(){return`${this.name}: ${this.message}`}toJSON(){return{name:this.name,code:this.code,message:this.message}}static isOPError(e){return e instanceof mi}}function vi(){const e=[],t="0123456789abcdef";for(let n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);e[14]="4";const n=Number(e[19]);e[19]=t.substr(3&n|8,1),e[8]=e[13]=e[18]=e[23]="-";return e.join("")}function bi(e,t){const n=e.indexOf(t);return!!~n&&(e.splice(n,1),!0)}e(mi,"code",_i);class yi{constructor(){e(this,"map",new Map)}on(e,t){let n=this.map.get(e);return n||(n=[],this.map.set(e,n)),n.push(t),bi.bind(null,n,t)}off(e,t){const n=this.map.get(e);return!!n&&bi(n,t)}emit(e,t){const n=this.map.get(e);n&&n.forEach((e=>e(t)))}clear(){this.map.clear()}}function ki(e){const t=new Promise(((t,n)=>{const o=document.createElement("script");o.src=e,o.onload=()=>t(),o.onerror=()=>{o.remove(),n(new mi({code:mi.code.ImportError,message:"Failed to load library, url: "+e}))},document.body.appendChild(o)}));return Si(t,{timer:10,timeoutErrorMsg:"Load library timeout, url: "+e})}function wi(e){if("object"==typeof e){if(Array.isArray(e))return`array[${e.length}]`;if(null===e)return"null";const t={};return Object.entries(e).forEach((([e,n])=>{t[e]=wi(n)})),t}return typeof e}const Ei=()=>{},Si=(e,t={timer:10,timeoutErrorMsg:"timeout"})=>{const{timer:n,timeoutErrorMsg:o}=t;return Promise.race([e,new Promise(((e,t)=>{setTimeout((()=>{t(new mi({code:mi.code.TimeoutError,message:o}))}),1e3*n)}))])};let Ti;var Ii="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Oi=function(e){return e&&e.Math==Math&&e},Ci=Oi("object"==typeof globalThis&&globalThis)||Oi("object"==typeof window&&window)||Oi("object"==typeof self&&self)||Oi("object"==typeof Ii&&Ii)||function(){return this}()||Function("return this")(),Li={},Ri=function(e){try{return!!e()}catch(e){return!0}},Ni=!Ri((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),Ai={},xi={}.propertyIsEnumerable,Di=Object.getOwnPropertyDescriptor,Bi=Di&&!xi.call({1:2},1);Ai.f=Bi?function(e){var t=Di(this,e);return!!t&&t.enumerable}:xi;var Pi=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},zi={}.toString,Mi=function(e){return zi.call(e).slice(8,-1)},ji=Mi,Ui="".split,Vi=Ri((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==ji(e)?Ui.call(e,""):Object(e)}:Object,Hi=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},Fi=Vi,Ki=Hi,Gi=function(e){return Fi(Ki(e))},Ji=function(e){return"object"==typeof e?null!==e:"function"==typeof e},qi=Ji,Wi=function(e,t){if(!qi(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!qi(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!qi(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!qi(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")},$i=Hi,Yi=function(e){return Object($i(e))},Qi=Yi,Xi={}.hasOwnProperty,Zi=Object.hasOwn||function(e,t){return Xi.call(Qi(e),t)},ea=Ji,ta=Ci.document,na=ea(ta)&&ea(ta.createElement),oa=function(e){return na?ta.createElement(e):{}},ra=!Ni&&!Ri((function(){return 7!=Object.defineProperty(oa("div"),"a",{get:function(){return 7}}).a})),ia=Ni,aa=Ai,sa=Pi,ca=Gi,la=Wi,ua=Zi,da=ra,ha=Object.getOwnPropertyDescriptor;Li.f=ia?ha:function(e,t){if(e=ca(e),t=la(t,!0),da)try{return ha(e,t)}catch(e){}if(ua(e,t))return sa(!aa.f.call(e,t),e[t])};var fa={},pa=Ji,ga=function(e){if(!pa(e))throw TypeError(String(e)+" is not an object");return e},_a=Ni,ma=ra,va=ga,ba=Wi,ya=Object.defineProperty;fa.f=_a?ya:function(e,t,n){if(va(e),t=ba(t,!0),va(n),ma)try{return ya(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var ka=fa,wa=Pi,Ea=Ni?function(e,t,n){return ka.f(e,t,wa(1,n))}:function(e,t,n){return e[t]=n,e},Sa={exports:{}},Ta=Ci,Ia=Ea,Oa=function(e,t){try{Ia(Ta,e,t)}catch(n){Ta[e]=t}return t},Ca=Oa,La="__core-js_shared__",Ra=Ci[La]||Ca(La,{}),Na=Ra,Aa=Function.toString;"function"!=typeof Na.inspectSource&&(Na.inspectSource=function(e){return Aa.call(e)});var xa=Na.inspectSource,Da=xa,Ba=Ci.WeakMap,Pa="function"==typeof Ba&&/native code/.test(Da(Ba)),za={exports:{}},Ma=Ra;(za.exports=function(e,t){return Ma[e]||(Ma[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.15.2",mode:"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"});var ja,Ua,Va,Ha=0,Fa=Math.random(),Ka=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++Ha+Fa).toString(36)},Ga=za.exports,Ja=Ka,qa=Ga("keys"),Wa={},$a=Pa,Ya=Ji,Qa=Ea,Xa=Zi,Za=Ra,es=function(e){return qa[e]||(qa[e]=Ja(e))},ts=Wa,ns="Object already initialized",os=Ci.WeakMap;if($a||Za.state){var rs=Za.state||(Za.state=new os),is=rs.get,as=rs.has,ss=rs.set;ja=function(e,t){if(as.call(rs,e))throw new TypeError(ns);return t.facade=e,ss.call(rs,e,t),t},Ua=function(e){return is.call(rs,e)||{}},Va=function(e){return as.call(rs,e)}}else{var cs=es("state");ts[cs]=!0,ja=function(e,t){if(Xa(e,cs))throw new TypeError(ns);return t.facade=e,Qa(e,cs,t),t},Ua=function(e){return Xa(e,cs)?e[cs]:{}},Va=function(e){return Xa(e,cs)}}var ls={set:ja,get:Ua,has:Va,enforce:function(e){return Va(e)?Ua(e):ja(e,{})},getterFor:function(e){return function(t){var n;if(!Ya(t)||(n=Ua(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},us=Ci,ds=Ea,hs=Zi,fs=Oa,ps=xa,gs=ls.get,_s=ls.enforce,ms=String(String).split("String");(Sa.exports=function(e,t,n,o){var r,i=!!o&&!!o.unsafe,a=!!o&&!!o.enumerable,s=!!o&&!!o.noTargetGet;"function"==typeof n&&("string"!=typeof t||hs(n,"name")||ds(n,"name",t),(r=_s(n)).source||(r.source=ms.join("string"==typeof t?t:""))),e!==us?(i?!s&&e[t]&&(a=!0):delete e[t],a?e[t]=n:ds(e,t,n)):a?e[t]=n:fs(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&gs(this).source||ps(this)}));var vs=Ci,bs=vs,ys=Ci,ks=function(e){return"function"==typeof e?e:void 0},ws=function(e,t){return arguments.length<2?ks(bs[e])||ks(ys[e]):bs[e]&&bs[e][t]||ys[e]&&ys[e][t]},Es={},Ss=Math.ceil,Ts=Math.floor,Is=function(e){return isNaN(e=+e)?0:(e>0?Ts:Ss)(e)},Os=Is,Cs=Math.min,Ls=function(e){return e>0?Cs(Os(e),9007199254740991):0},Rs=Is,Ns=Math.max,As=Math.min,xs=Gi,Ds=Ls,Bs=function(e,t){var n=Rs(e);return n<0?Ns(n+t,0):As(n,t)},Ps=function(e){return function(t,n,o){var r,i=xs(t),a=Ds(i.length),s=Bs(o,a);if(e&&n!=n){for(;a>s;)if((r=i[s++])!=r)return!0}else for(;a>s;s++)if((e||s in i)&&i[s]===n)return e||s||0;return!e&&-1}},zs={includes:Ps(!0),indexOf:Ps(!1)},Ms=Zi,js=Gi,Us=zs.indexOf,Vs=Wa,Hs=function(e,t){var n,o=js(e),r=0,i=[];for(n in o)!Ms(Vs,n)&&Ms(o,n)&&i.push(n);for(;t.length>r;)Ms(o,n=t[r++])&&(~Us(i,n)||i.push(n));return i},Fs=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ks=Hs,Gs=Fs.concat("length","prototype");Es.f=Object.getOwnPropertyNames||function(e){return Ks(e,Gs)};var Js={};Js.f=Object.getOwnPropertySymbols;var qs,Ws,$s=Es,Ys=Js,Qs=ga,Xs=ws("Reflect","ownKeys")||function(e){var t=$s.f(Qs(e)),n=Ys.f;return n?t.concat(n(e)):t},Zs=Zi,ec=Xs,tc=Li,nc=fa,oc=Ri,rc=/#|\.prototype\./,ic=function(e,t){var n=sc[ac(e)];return n==lc||n!=cc&&("function"==typeof t?oc(t):!!t)},ac=ic.normalize=function(e){return String(e).replace(rc,".").toLowerCase()},sc=ic.data={},cc=ic.NATIVE="N",lc=ic.POLYFILL="P",uc=ic,dc=Ci,hc=Li.f,fc=Ea,pc=Sa.exports,gc=Oa,_c=function(e,t){for(var n=ec(t),o=nc.f,r=tc.f,i=0;i<n.length;i++){var a=n[i];Zs(e,a)||o(e,a,r(t,a))}},mc=uc,vc=function(e,t){var n,o,r,i,a,s=e.target,c=e.global,l=e.stat;if(n=c?dc:l?dc[s]||gc(s,{}):(dc[s]||{}).prototype)for(o in t){if(i=t[o],r=e.noTargetGet?(a=hc(n,o))&&a.value:n[o],!mc(c?o:s+(l?".":"#")+o,e.forced)&&void 0!==r){if(typeof i==typeof r)continue;_c(i,r)}(e.sham||r&&r.sham)&&fc(i,"sham",!0),pc(n,o,i,e)}},bc=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},yc=function(e,t,n){if(bc(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,o){return e.call(t,n,o)};case 3:return function(n,o,r){return e.call(t,n,o,r)}}return function(){return e.apply(t,arguments)}},kc=Mi,wc=Array.isArray||function(e){return"Array"==kc(e)},Ec=ws("navigator","userAgent")||"",Sc=Ci.process,Tc=Sc&&Sc.versions,Ic=Tc&&Tc.v8;Ic?Ws=(qs=Ic.split("."))[0]<4?1:qs[0]+qs[1]:Ec&&(!(qs=Ec.match(/Edge\/(\d+)/))||qs[1]>=74)&&(qs=Ec.match(/Chrome\/(\d+)/))&&(Ws=qs[1]);var Oc=Ws&&+Ws,Cc=Ri,Lc=!!Object.getOwnPropertySymbols&&!Cc((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Oc&&Oc<41})),Rc=Lc&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Nc=Ci,Ac=za.exports,xc=Zi,Dc=Ka,Bc=Lc,Pc=Rc,zc=Ac("wks"),Mc=Nc.Symbol,jc=Pc?Mc:Mc&&Mc.withoutSetter||Dc,Uc=Ji,Vc=wc,Hc=function(e){return xc(zc,e)&&(Bc||"string"==typeof zc[e])||(Bc&&xc(Mc,e)?zc[e]=Mc[e]:zc[e]=jc("Symbol."+e)),zc[e]},Fc=Hc("species"),Kc=yc,Gc=Vi,Jc=Yi,qc=Ls,Wc=function(e,t){var n;return Vc(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!Vc(n.prototype)?Uc(n)&&null===(n=n[Fc])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},$c=[].push,Yc=function(e){var t=1==e,n=2==e,o=3==e,r=4==e,i=6==e,a=7==e,s=5==e||i;return function(c,l,u,d){for(var h,f,p=Jc(c),g=Gc(p),_=Kc(l,u,3),m=qc(g.length),v=0,b=d||Wc,y=t?b(c,m):n||a?b(c,0):void 0;m>v;v++)if((s||v in g)&&(f=_(h=g[v],v,p),e))if(t)y[v]=f;else if(f)switch(e){case 3:return!0;case 5:return h;case 6:return v;case 2:$c.call(y,h)}else switch(e){case 4:return!1;case 7:$c.call(y,h)}return i?-1:o||r?r:y}},Qc={forEach:Yc(0),map:Yc(1),filter:Yc(2),some:Yc(3),every:Yc(4),find:Yc(5),findIndex:Yc(6),filterOut:Yc(7)},Xc=Ri,Zc=Qc.forEach,el=function(e,t){var n=[][e];return!!n&&Xc((function(){n.call(null,t||function(){throw 1},1)}))}("forEach")?[].forEach:function(e){return Zc(this,e,arguments.length>1?arguments[1]:void 0)};vc({target:"Array",proto:!0,forced:[].forEach!=el},{forEach:el});var tl=Ci,nl=yc,ol=Function.call;(function(e,t,n){nl(ol,tl[e].prototype[t],n)})("Array","forEach"),function(e){var t,n;if(e&&!("href"in(null!==(n=null===(t=e.URL)||void 0===t?void 0:t.prototype)&&void 0!==n?n:{}))){r.prototype={toString:function(){return this.href},get href(){return this._anchorElement.href},set href(e){this._anchorElement.href=e},get protocol(){return this._anchorElement.protocol},set protocol(e){this._anchorElement.protocol=e},get host(){return this._anchorElement.host},set host(e){this._anchorElement.host=e},get hostname(){return this._anchorElement.hostname},set hostname(e){this._anchorElement.hostname=e},get port(){return this._anchorElement.port},set port(e){this._anchorElement.port=e},get pathname(){return this._anchorElement.pathname},set pathname(e){this._anchorElement.pathname=e},get search(){return this._anchorElement.search},set search(e){this._anchorElement.search=e},get hash(){return this._anchorElement.hash},set hash(e){this._anchorElement.hash=e}};var o=e.URL||e.webkitURL||e.mozURL;r.createObjectURL=function(e){return o.createObjectURL(e)},r.revokeObjectURL=function(e){return o.revokeObjectURL(e)},Object.defineProperty(r.prototype,"toString",{enumerable:!1}),e.URL=r}function r(e,t){if(!e)throw new TypeError("Invalid argument");var n=document.implementation.createHTMLDocument("");if(t){var o=n.createElement("base");o.href=t,n.head.appendChild(o)}var r=n.createElement("a");if(r.href=e,n.body.appendChild(r),":"===r.protocol||!/:/.test(r.href))throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:r})}}(void 0!==Ii?Ii:"undefined"!=typeof window?window:"undefined"!=typeof self?self:Ii),function(){if(!Element.prototype.addEventListener){var e=[],t=function(t,n){var o=this,r=function(e){e.target=e.srcElement,e.currentTarget=o,void 0!==n.handleEvent?n.handleEvent(e):n.call(o,e)};if("DOMContentLoaded"===t){var i=function(e){"complete"===document.readyState&&r(e)};if(document.attachEvent("onreadystatechange",i),e.push({object:this,type:t,listener:n,wrapper:i}),"complete"===document.readyState){var a=new Event;a.srcElement=window,i(a)}}else this.attachEvent("on"+t,r),e.push({object:this,type:t,listener:n,wrapper:r})},n=function(t,n){for(var o=0;o<e.length;){var r=e[o];if(r.object===this&&r.type===t&&r.listener===n){"DOMContentLoaded"===t?this.detachEvent("onreadystatechange",r.wrapper):this.detachEvent("on"+t,r.wrapper),e.splice(o,1);break}++o}};Element.prototype.addEventListener=t,Element.prototype.removeEventListener=n,HTMLDocument&&!HTMLDocument.prototype.addEventListener&&(HTMLDocument.prototype.addEventListener=t,HTMLDocument.prototype.removeEventListener=n),Window&&!Window.prototype.addEventListener&&(Window.prototype.addEventListener=t,Window.prototype.removeEventListener=n)}}();var rl=Hs,il=Fs,al=Object.keys||function(e){return rl(e,il)},sl=Yi,cl=al;vc({target:"Object",stat:!0,forced:Ri((function(){cl(1)}))},{keys:function(e){return cl(sl(e))}}),vs.Object.keys;
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
var ll=function(e,t){return ll=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},ll(e,t)};function ul(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}ll(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var dl=function(){return dl=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},dl.apply(this,arguments)};function hl(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}function fl(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function pl(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}function gl(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||t)}function _l(e){return"object"==typeof e&&null!==e&&!bl(e)}function ml(e){return"function"==typeof e}function vl(e){return"[object String]"===Object.prototype.toString.call(e)}function bl(e){return"[object Array]"===Object.prototype.toString.call(e)}function yl(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function kl(e,t){if(_l(e))for(var n in e)yl(e,n)&&t.call(null,n,e[n])}function wl(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n={},o=0;o<e.length;)n=Il(n,e[o]),o++;return n}var El=Object.getPrototypeOf?Object.getPrototypeOf({}):null;function Sl(e){return Object.getPrototypeOf?Object.getPrototypeOf(e)===El:e.constructor===Object}function Tl(e,t){var n=dl({},e);for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&void 0!==t[o]&&(_l(t[o])&&Sl(t[o])?n[o]=Il(_l(e[o])?e[o]:{},t[o]):bl(t[o])?n[o]=t[o].slice():n[o]=t[o]);return n}function Il(e,t){var n=dl({},e);for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&void 0!==t[o]&&(_l(t[o])&&Sl(t[o])?n[o]=Il(_l(e[o])?e[o]:{},t[o]):bl(e[o])||bl(t[o])?n[o]=Ol(e[o],t[o]):n[o]=t[o]);return n}function Ol(e,t){var n=bl(e)?e:[],o=bl(t)?t:[];return Array.prototype.concat.call(n,o).map((function(e){return e instanceof RegExp?e:bl(e)||_l(e)&&Sl(e)?bl(e)?Ol([],e):Il({},e):e}))}function Cl(e,t){if(!bl(e))return!1;if(0===e.length)return!1;for(var n=0;n<e.length;){if(e[n]===t)return!0;n++}return!1}function Ll(){return!!_l(window)}function Rl(){return!(!Ll()||!_l(window.performance))&&!!_l(window.performance.timing)}function Nl(e){var t=function(e){if(!_l(e))return{};var t={};return kl(e,(function(e,n){_l(n)||bl(n)?t[e]=JSON.stringify(n):t[e]=n})),t}(e),n=function(e){var t={};return kl(e,(function(e,n){t[encodeURIComponent(e)]=encodeURIComponent(n)})),t}(t),o=[];return kl(n,(function(e,t){o.push(e+"="+t)})),o.join("&")}function Al(e){var t=document.createElement("a");t.href=e;var n=t.pathname||"/";return"/"!==n[0]&&(n="/"+n),{href:t.href,protocol:t.protocol.slice(0,-1),hostname:t.hostname,host:t.host,search:t.search,pathname:n,hash:t.hash}}var xl=new RegExp("("+["cookie","auth","jwt","token","key","ticket","secret","credential","session","password"].join("|")+")","i"),Dl=new RegExp("("+["bearer","session"].join("|")+")","i"),Bl=function(e,t){return!(!e||!t)&&(xl.test(e)||Dl.test(t))};function Pl(){}function zl(e){var t="[object String]"===Object.prototype.toString.call(e);return e?t?e.length:ArrayBuffer&&e instanceof ArrayBuffer?e.byteLength:window.Blob&&e instanceof Blob?e.size:e.length?e.length:0:0}function Ml(e){if(!e)return"";if(!ml(e.forEach))return"";var t=[];return e.forEach((function(e){if(bl(e)&&e[0]&&!Bl(e[0],e[1])){var n=e[0],o=e[1]||"";t.push(n+": "+o)}})),t.join("\r\n")}function jl(e){var t={},n=Al(e);return t.ax_protocol=n.protocol,t.ax_domain=n.hostname,t.ax_path=n.pathname,t.ax_url=(n.href||e).split("?")[0],t.ax_search=n.search,t.ax_href=n.href,t}function Ul(e){return bl(e)&&e.length?function(e){for(var t=[],n=e.length,o=0;o<n;o++){var r=e[o];vl(r)?t.push(r.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")):r&&r.source&&t.push(r.source)}return new RegExp(t.join("|"),"i")}(e):null}function Vl(e){return!!e&&Math.random()<Number(e)}var Hl=function(){function e(t){var n=this;this.postEvent=function(t){var o=dl(dl({},t),n.getCommonParams());e.post(n.url,o)},this.getEvent=function(t){var o=Nl(dl(dl({},t),n.getCommonParams())),r=n.url+"?"+o;e.get(r)},this.getURL=function(){return n.url},this.options=t,this.url=this.options.reportURL}return e.post=function(e,t,n){var o=n&&n.success||Pl,r=n&&n.fail||Pl,i=new XMLHttpRequest;i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify(t)),i.onload=function(){try{if(this.responseText){var e=JSON.parse(this.responseText);o(e)}else o({})}catch(e){r()}},i.onerror=function(){r()},i.onabort=function(){r()}},e.get=function(e,t){var n=t&&t.success||Pl,o=t&&t.fail||Pl,r=t&&t.getResponse||Pl,i=t&&t.getResponseText||Pl,a=new XMLHttpRequest;t&&t.withCredentials&&(a.withCredentials=t.withCredentials),a.open("GET",e),a.send(),a.onload=function(){r(null==this?void 0:this.response),i(this.responseText);try{if(this.responseText){var e=JSON.parse(this.responseText);n(e)}else n({})}catch(e){o()}},a.onerror=function(){o()},a.onabort=function(){o()}},e.prototype.getCommonParams=function(){return{timestamp:Date.now()}},e}();function Fl(e,t,n){if(void 0===n&&(n="0"),n.length>1)throw new TypeError("expect the length of pad to be 1, but got "+e.length);return e.length>=t?e:""+Array.from({length:t-e.length}).fill(n).join("")+e}function Kl(e){return e?Math.floor(Math.random()*Math.pow(10,12)).toString(16).substr(0,e):""}var Gl="x-tt-trace-id",Jl="x-tt-trace-host",ql="x-tt-logid";function Wl(e,t,n){void 0===n&&(n="01");var o=""+Fl((Date.now()%4294967295).toString(16),8)+function(e){var t;if("number"==typeof e)t=e;else{var n=e.replace(/-/g,"");if(!/^[0-9]+$/.test(n)){if(n.length>18)return"18"+Kl(18);var o=22-n.length-4;return""+Fl(""+n.length,2)+n+Kl(o)}t=parseInt(n,10)}var r=t.toString(16),i=22-r.length-4;return""+Fl(""+r.length,2)+r+Kl(i)}(e)+("string"==typeof t?Kl(4):Fl(t.toString(16),4));return"00-"+o+"-"+o.substr(0,16)+"-"+n}function $l(){var e=function(){for(var e=new Array(16),t=0,n=0;n<16;n++)0==(3&n)&&(t=4294967296*Math.random()),e[n]=t>>>((3&n)<<3)&255;return e}();return e[6]=15&e[6]|64,e[8]=63&e[8]|128,function(e){for(var t=[],n=0;n<256;++n)t[n]=(n+256).toString(16).substr(1);var o=0,r=t;return[r[e[o++]],r[e[o++]],r[e[o++]],r[e[o++]],"-",r[e[o++]],r[e[o++]],"-",r[e[o++]],r[e[o++]],"-",r[e[o++]],r[e[o++]],"-",r[e[o++]],r[e[o++]],r[e[o++]],r[e[o++]],r[e[o++]],r[e[o++]]].join("")}(e)}var Yl=["/log/sentry/","/monitor_browser/collect"],Ql="MONITOR_WEB_ID",Xl=$l(),Zl=$l(),eu=function(){};function tu(e,t){if(void 0===t&&(t=eu),e&&vl(e)&&Ll()&&_l(document)&&ml(document.createElement)){var n=document.createElement("script"),o=document.head;_l(n)&&_l(o)&&(n.src=e,n.async=!0,n.crossOrigin="anonymous",n.onload=function(){t()},ml(o.appendChild)&&o.appendChild(n))}}function nu(){try{return new Headers,new Request(""),new Response,window.fetch}catch(e){}}function ou(){if(_l(window))return window}function ru(){if(_l(document))return document}function iu(){if(ou()&&_l(window.performance))return window.performance}function au(){if(ml(XMLHttpRequest))return XMLHttpRequest}var su=function(e,t,n){var o=e.commonParams,r=e.ajaxMonitorOptions,i=o||{},a=i.bid,s=i.web_id,c=(r||{}).sampleHitTrace,l=function(e,t){var n=Al(e),o=Al(t);return n.protocol===o.protocol&&n.host===o.host}(n,t);return a&&s&&c&&l},cu=function(e,t,n){return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];if(!e)return Pl;var i=e[t],a=n.apply(void 0,gl([i],pl(o))),s=a;return ml(s)&&(s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return a.apply(this,e)}catch(t){return ml(i)&&i.apply(this,e)}}),e[t]=s,function(n){n&&s!==e[t]||(e[t]=i)}}};function lu(e,t){return e instanceof t}function uu(e,t){return e instanceof t}var du=function(e){var t,n;return null!==(n=null===(t=e.ajaxMonitorOptions)||void 0===t?void 0:t.errorRequestCollect)&&void 0!==n&&n},hu=function(e){var t=e,n={},o=function(){return Object.keys(t).forEach((function(e){return!(e in n)&&Object.defineProperty(n,e,{get:function(){return t[e]}})}))};return o(),[n,function(e){t=wl({},t,e),o()}]},fu=function(e){var t,n=window.requestAnimationFrame,o=window.cancelAnimationFrame,r=!ml(n)||e&&document&&document.hidden?function(e){return e(0),0}:n,i=ml(o)?o:Pl;return[function(e){t&&i(t),t=r(e)},r,i]};function pu(e,t){void 0===t&&(t=iu());var n=pl(function(e){var t=e&&e.timing||void 0;return[t,function(){return e&&e.now?e.now():(Date.now?Date.now():+new Date)-(t&&t.navigationStart||0)},function(t){var n=(e||{}).getEntriesByType;return ml(n)&&n.call(e,t)||[]},function(){var t=(e||{}).clearResourceTimings;ml(t)&&t.call(e)},function(t){var n=(e||{}).getEntriesByName;return ml(n)&&n.call(e,t)||[]}]}(t),5);return(0,n[4])(e).pop()}var gu=function(e,t,n,o){var r,i=e._method,a=e._requestHeaders,s=e._url,c=e._start,l=e._data,u={ev_type:"ajax",ax_status:(e.status||0).toString(),ax_type:i,ax_request_header:Ml(a||[]),ax_domain:"",ax_duration:0,ax_path:"",ax_protocol:"",ax_response_header:"",ax_size:0,ax_url:"",ax_href:""};if("function"==typeof e.getAllResponseHeaders&&(u.ax_response_header=function(e){if(vl(e)){var t=e.split("\r\n"),n=[];return t.forEach((function(e,t){if(e&&ml(e.split)){var o=e.split(": ");Bl(o[0],o[1])||n.push([o[0],o[1]])}})),Ml(n)}return _l(e)?Ml(Object.keys(e).filter((function(t){return!Bl(t,e[t])})).map((function(t){return[t,e[t]]}))):e}(e.getAllResponseHeaders())),su(t,s,o)){var d=n||e.getResponseHeader(Gl);d&&(u.trace_id=d,u.trace_host=e.getResponseHeader(Jl)||void 0,u.log_id=e.getResponseHeader(ql)||void 0)}u.ax_duration=Date.now()-c,200===e.status&&(u.ax_size=function(e){if(""===e.responseType||"text"===e.responseType)return zl(e.responseText);if(e.response)return zl(e.response);try{return zl(e.responseText)}catch(e){return 0}}(e)),(u=dl(dl({},u),jl(s))).resource_timing=pu(u.ax_href);var h=u.ax_status;return du(t)&&"2"!==h[0]&&"3"!==h[0]&&(u.ax_request={body:l?""+l:void 0,search:Al(s).search,content_type:a&&(null===(r=a.find((function(e){return"content-type"===e[0].toLowerCase()})))||void 0===r?void 0:r[1])}),u},_u="AjaxMonitor",mu=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=pl(t,2),r=o[0],i=o[1];return this._url=i||"",this._method=r&&r.toLowerCase()||"",e.apply(this,t)}},vu=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this._requestHeaders=this._requestHeaders||[],this._requestHeaders.push(t),e&&e.apply(this,t)}},bu=function(e,t,n,o){var r=null;return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];if(su(t,this._url,o)){var s=t.commonParams||{},c=s.bid,l=s.web_id;c&&l&&(r=Wl(l,c),this.setRequestHeader(Gl,r))}return yu(this)(t,r,n,o),this._start=Date.now(),this._data=null==i?void 0:i[0],e.apply(this,i)}},yu=function(e){return cu(e,"onreadystatechange",(function(t,n,o,r,i){return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return 4===this.readyState&&r&&r({name:_u,type:"get",event:gu(e,n,o,i)}),t&&t.apply(this,a)}}))},ku=function(e,t,n){void 0===t&&(t=!1);var o="";return o=lu(e,n)?e.url:e,t||(o=vl(o)?o.split("?")[0]:o),o};var wu=function(e,t,n){return lu(e,n)?e.body:null==t?void 0:t.body},Eu=function(e,t){if(!e)return"";var n=[];return uu(e,t)?e.forEach((function(e,t){n.push([t,e])})):bl(e)?n.push.apply(n,gl([],pl(e))):n.push.apply(n,gl([],pl(Object.entries(e)))),Ml(n)};function Su(e,t,n){if(e){if(uu(e,n))return e.get(t)||void 0;if(bl(e)){var o=e.find((function(e){return t===e[0]}));return null==o?void 0:o[1]}return e[t]}}var Tu="FetchMonitor",Iu=function(e,t,n,o,r,i){return function(a,s){void 0===s&&(s={});var c=ku(a,void 0,r);if(!function(e){if(!vl(e))return!1;var t=pl(e.split(":"),2),n=t[0];return!t[1]||"http"===n||"https"===n}(c))return e(a,s);var l=t.commonParams||{},u=l.bid,d=l.web_id,h=Date.now(),f={ev_type:"ajax",ax_size:0};try{su(t,c,i)&&(s.headers||(s.headers=[]),u&&d&&(f.trace_id=Wl(u,d),function(e,t,n,o){uu(e,o)?e.append(t,n):bl(e)?e.push([t,n]):e[t]=n}(s.headers,Gl,f.trace_id,o)))}catch(e){}f.ax_type=function(e,t,n){var o=t&&t.method||"get";return lu(e,n)&&(o=e.method||o),o.toLowerCase()}(a,s,r),f=dl(dl({},f),jl(ku(a,!0,r)));var p=function(){f.resource_timing=pu(f.ax_href),function(e,t,n,o,r,i){var a,s=t.ax_status;if(du(e)&&"2"!==s[0]&&"3"!==s[0]){var c=ku(n,!0,r);t.ax_request={body:null===(a=wu(n,o,r))||void 0===a?void 0:a.toString(),search:Al(c).search,content_type:Su(o.headers,"Content-Type",i)}}}(t,f,a,s,r,o),null==n||n({name:Tu,type:"get",event:f})};return e(a,s).then((function(e){var n;try{f.ax_status=(e.status||0).toString(),f.ax_duration=Date.now()-h,f.ax_response_header=Eu(e.headers,o),f.ax_request_header=Eu(function(e,t,n,o){var r=new n;return lu(e,o)&&e.headers&&ml(e.headers.forEach)&&e.headers.forEach((function(e,t){r.append(t,e)})),t.headers&&new n(t.headers).forEach((function(e,t){r.append(t,e)})),r}(a,s,o,r),o);var l=function(t,n){e.headers.has(t)&&(f[n]=e.headers.get(t)||void 0)};ml(null===(n=e.headers)||void 0===n?void 0:n.has)&&(e.headers.has("content-length")&&(f.ax_size=Number(e.headers.get("content-length"))||0),su(t,c,i)&&(l(Jl,"trace_host"),l(Gl,"trace_id"),l(ql,"log_id"))),setTimeout((function(){p()}),100)}catch(e){}return e}),(function(e){try{f.ax_status="0",f.ax_duration=Date.now()-h,p()}catch(e){}return Promise.reject(e)}))}},Ou=["SCRIPT","STYLE","META","HEAD"],Cu=function(e,t,n,o){if(!e||o.indexOf(e.tagName)>-1)return 0;var r=e.children,i=void 0===r?[]:r,a=[].slice.call(i).reduceRight((function(e,n){return e+Cu(n,t+1,e>0,o)}),0);if(a<=0&&!n){if(!ml(e.getBoundingClientRect))return 0;var s=e.getBoundingClientRect()||{},c=s.top,l=s.height;if(c>window.innerHeight||l<=0)return 0}return a+1+.5*t},Lu=function(e,t,n){var o;return void 0===e&&(e=ru()),void 0===t&&(t=function(){if(ou()&&ml(window.MutationObserver))return window.MutationObserver}()),void 0===n&&(n=null===(o=function(){var e=iu();if(e&&_l(e.timing))return e.timing}())||void 0===o?void 0:o.navigationStart),function(o,r){var i=Date.now(),a=[],s=Ou.concat(o.ignoreTags||[]),c=function(){return a.push({time:Date.now()-i,score:Cu(e&&e.body,1,!1,s)})},l=pl(fu(!0),1)[0],u=pl(function(e,t){var n=e&&new e(t);return[function(e,t){n&&e&&n.observe(e,t)},function(){return n&&n.disconnect()}]}(t,(function(){return l(c)})),2),d=u[0],h=u[1],f=function(e){void 0===e&&(e=0),h();var t=function(e){var t=pl(void 0===e?[]:e),n=t[0],o=t.slice(1);return o&&o.reduce((function(e,t){var n=pl(e,2),o=n[0],r=n[1],i=t.score-o.score;return[t,t.time>=o.time&&r.rate<i?{time:t.time,rate:i}:r]}),[n,{time:null==n?void 0:n.time,rate:0}])[1].time||0}(a),n={name:"FMPMonitor",type:"post",event:{ev_type:"fmp",fmp:t?t+e:0}};return r&&r(n),n},p=i-(n||0);return d(e,{subtree:!0,childList:!0}),[h,f,f.bind(null,p)]}},Ru="PathMonitor",Nu=function(){function e(){this.name=Ru,this.callback=Pl,this.onPathChange=Pl,this.currentURL=""}return e.prototype.setup=function(e){Ll()&&(this.currentURL=location.href,this.callback=e,this.start())},e.prototype.onChange=function(e){this.onPathChange=e},e.prototype.start=function(){this.monitorHashChange(),Ll()&&_l(window.history)&&ml(window.history.pushState)&&ml(window.history.replaceState)&&(this.monitorPopState(),this.monitorPushState(),this.monitorReplaceState())},e.prototype.monitorPopState=function(){var e=this;window.addEventListener("popstate",(function(){e.handleStateChange(e.currentURL,location.href),e.replaceCurrentURL(location.href)}))},e.prototype.monitorHashChange=function(){var e=this;window.addEventListener("hashchange",(function(){var t=e.parseHash(location.hash);t&&e.pathChangeHandler(e.getPath(t),"hash"),e.replaceCurrentURL(location.href)}))},e.prototype.monitorPushState=function(){var e=this,t=window.history.pushState;t&&(window.history.pushState=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{return t.apply(this,n)}finally{e.handleHistoryStateChange.apply(e,gl([],pl(n)))}})},e.prototype.monitorReplaceState=function(){var e=this,t=window.history.replaceState;t&&(window.history.replaceState=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{return t.apply(this,n)}finally{e.handleHistoryStateChange.apply(e,gl([],pl(n)))}})},e.prototype.pathChangeHandler=function(e,t,n){vl(e)&&ml(this.callback)&&(this.onPathChange&&this.onPathChange({path:e,type:t,url:n}),this.callback({name:this.name,type:"get",event:{ev_type:"pageview",path:e,type:t}}))},e.prototype.handleHistoryStateChange=function(e,t,n){n&&(this.handleStateChange(this.currentURL,n),this.replaceCurrentURL(n))},e.prototype.handleStateChange=function(e,t){var n=this.parseURL(e),o=this.parseURL(t);o&&n&&(o.pathname===n.pathname?o.hash!==n.hash&&this.pathChangeHandler(this.getPath(o.hash),"hash",o):this.pathChangeHandler(this.getPath(o.pathname),"pathname",o))},e.prototype.parseURL=function(e){var t=null;if(!e)return t;if("string"!=typeof e)return t;if(e.match(/^\/[^\/]/))return new URL(location.protocol+"//"+location.host+e);try{return new URL(e)}catch(e){return t}},e.prototype.parseHash=function(e){return e?"string"!=typeof e?"/":e.replace(/^#/,""):"/"},e.prototype.getPath=function(e){var t=e&&"string"==typeof e?e.replace(/^(https?:)?\/\//,"").replace(/\?.*$/,""):"";return t=this.parseHash(t)},e.prototype.replaceCurrentURL=function(e){this.currentURL!==e&&(this.currentURL=e)},e.monitorName=Ru,e}(),Au=function(e,t,n,o){var r=function(){function n(t){this.props=t,this.name=e}return n.prototype.setup=function(e){this.monitor=function(e,t,n,o){void 0===t&&(t={}),void 0===o&&(o=[]);try{var r=e.apply(void 0,gl([],pl(o)));return r&&r(t,n)||[]}catch(e){return[]}}(t,this.props,e,o)},n.monitorName=e,n}();return n.forEach((function(e,t){return r.prototype[e]=function(){for(var e,n,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return null===(n=null===(e=this.monitor)||void 0===e?void 0:e[t])||void 0===n?void 0:n.call.apply(n,gl([e],pl(o)))}})),r},xu=Au(_u,(function(e,t){void 0===e&&(e=au()),void 0===t&&(t=null===location||void 0===location?void 0:location.href);var n=e&&e.prototype;if(n)return function(e,o){var r=pl(hu(e),2),i=r[0],a=r[1];return cu(n,"open",mu)(),cu(n,"send",bu)(i,o,t||""),cu(n,"setRequestHeader",vu)(),[a]}}),["updateConfig"]),Du=Au(Tu,(function(e,t,n,o){if(void 0===e&&(e=nu()&&ou()),void 0===t&&(t=window.Headers),void 0===n&&(n=window.Request),void 0===o&&(o=null===location||void 0===location?void 0:location.href),e&&t&&n)return function(r,i){var a=pl(hu(r),2),s=a[0],c=a[1];return cu(e,"fetch",Iu)(s,i,t,n,o||""),[c]}}),["updateConfig"]),Bu=function(){function e(){}return e.prototype.sendEvent=function(e){var t=this.getEventToBeSent(e);t&&this.idleSendEvent(t)},e.prototype.getEventToBeSent=function(e){var t=this._modifyEvent(e);if(this._shouldSend(t))return t},e.prototype._modifyEvent=function(e){return e},e.prototype._shouldSend=function(e){return!0},e.prototype._send=function(e){},e.prototype.idleSendEvent=function(e){this._send(e)},e}(),Pu=function(e){function t(t){var n,o,r=e.call(this)||this;return r.reportQueue=[],r.isReady=!0,r.batchReportLength=null!==(n=t.maxBatchReportLength)&&void 0!==n?n:10,r.batchReportWait=null!==(o=t.batchReportWait)&&void 0!==o?o:1e3,r.batchReportTimeout=null,r}return ul(t,e),Object.defineProperty(t.prototype,"ready",{get:function(){return this.isReady},set:function(e){this.isReady=e,this.isReady&&this._uploadQueue()},enumerable:!1,configurable:!0}),t.prototype._send=function(e){var t=this,n=this.buildParams(e);null===n||function(e){return void 0===e}(n)||(this.reportQueue.push(n),this.isReady&&(this.reportQueue.length>=this.batchReportLength&&this._uploadQueue(),this.batchReportTimeout&&clearTimeout(this.batchReportTimeout),this.batchReportTimeout=setTimeout((function(){t._uploadQueue()}),this.batchReportWait)))},t.prototype._uploadQueue=function(){if(this.reportQueue.length&&this.ready){var e={ev_type:"batch",list:this.reportQueue};this.reportQueue=[],this._request({event:e,type:"post"})}},t.prototype._request=function(e){},t}(Bu),zu="https://lf3-cdn-tos.bytegoofy.com/goofy/slardar/fe/sdk/plugins",Mu=zu+"/sentry.3.6.34.cn.js",ju="i.snssdk.com";function Uu(e){return!!e&&Math.random()<Number(e)}function Vu(e,t){return _l(e)?_l(t)?dl(dl({},e),{overrides:t}):e:{}}function Hu(e){return"error"===e.type}function Fu(e){return"unhandledrejection"===e.type}function Ku(e){var t,n,o;if((null===(t=window.__SLARDAR__)||void 0===t?void 0:t.plugins)&&bl(null===(n=window.__SLARDAR__)||void 0===n?void 0:n.plugins)){var r=null===(o=window.__SLARDAR__)||void 0===o?void 0:o.plugins,i=void 0;return r.forEach((function(t){t.version===e.version&&t[e.name]&&(i=t[e.name])})),i}}var Gu=function(e){function t(t){var n,o=e.call(this,null!=t?t:{reportURL:""})||this;return o.setTransport=function(){o.transport||(o.transport=new Hl({reportURL:o.getReportURL()}),o.updateStatus())},o.setOnOptionsUpdate=function(e){o.onOptionsUpdate=e},o.uploadQueue=function(){o._uploadQueue()},o.updateConfig=function(e){var t,n,r,i=null===(n=null===(t=o.options)||void 0===t?void 0:t.commonParams)||void 0===n?void 0:n.pid;o.options=o.normalizeOptions(e),i&&(null===(r=null==e?void 0:e.commonParams)||void 0===r?void 0:r.pid)&&e.commonParams.pid!==i&&o.sendPageview(),o.onOptionsUpdate&&o.onOptionsUpdate(o.options)},o.sendPageview=function(){ml(o.sendEvent)&&o.sendEvent({name:"PageViewMonitor",type:"get",event:{ev_type:"pageview"}})},o.sendEvent=function(t){o.chechIsReady()?e.prototype.sendEvent.call(o,t):o.preQueue.push(t)},o.buildSendParams=function(e){return o.buildParams(e)},o.reportURL=null!==(n=null==t?void 0:t.reportURL)&&void 0!==n?n:"",o.preQueue=[],o.clientStatus=0,o.enable=!1,o}return ul(t,e),t.prototype.setEnable=function(e){this.enable||(this.enable=e,this.enable&&this.updateStatus())},t.prototype.getReportURL=function(){return this.reportURL||this.getBatchReportURL()},Object.defineProperty(t.prototype,"contextAgent",{get:function(){var e=this,t={set:function(n,o){return e.options?(e.options.commonParams.context||(e.options.commonParams.context={}),e.options.commonParams.context[n]=o,t):t},delete:function(n){var o;return(null===(o=e.options)||void 0===o?void 0:o.commonParams.context)&&"string"!=typeof e.options.commonParams.context&&yl(e.options.commonParams.context,n)&&delete e.options.commonParams.context[n],t},clear:function(){return e.options?(e.options.commonParams.context={},t):t},get:function(t){var n,o,r;return null===(r=null===(o=null===(n=e.options)||void 0===n?void 0:n.commonParams)||void 0===o?void 0:o.context)||void 0===r?void 0:r[t]},toObject:function(){var t,n,o;return"string"==typeof(null===(t=e.options)||void 0===t?void 0:t.commonParams.context)?{}:dl({},null===(o=null===(n=e.options)||void 0===n?void 0:n.commonParams)||void 0===o?void 0:o.context)}};return t},enumerable:!1,configurable:!0}),t.prototype._shouldSend=function(e){var t,n;if(!((null===(t=this.options)||void 0===t?void 0:t.monitors)&&e&&_l(e)&&(null===(n=e.event)||void 0===n?void 0:n.ev_type)))return!1;var o=this.options.monitors;if("AjaxMonitor"===e.name||"FetchMonitor"===e.name){var r=Ul(Yl||[]);if(r&&r.test(e.event.ax_url))return!1}return!!o.BaseMonitor.webIDHit||!!o.BaseMonitor.sampleHit&&("PathMonitor"===e.name?function(e){var t=e.sendParams,n=e.pageViewMonitor,o=e.baseMonitor;if(1===o.appTypeSetting.type&&t.event.type===o.appTypeSetting.SPA)return!n||(!!n.webIDHit||!!n.sampleHit);return!1}({sendParams:e,pageViewMonitor:o.PageViewMonitor,baseMonitor:o.BaseMonitor}):"PageViewMonitor"===e.name?function(e){var t=e.pageViewMonitor;if(!t)return!0;if(t.webIDHit)return!0;if(!t.sampleHit)return!1;return!0}({pageViewMonitor:o.PageViewMonitor}):"AjaxMonitor"===e.name||"FetchMonitor"===e.name?function(e){var t=e.sendParams,n=e.ajaxMonitor;if(!n)return!0;if(n.webIDHit)return!0;if(!n.sampleHit)return!1;var o=n.whitelistUrls;if(bl(o)&&o.length>0){var r=Ul(n.whitelistUrls||[]);return!(!r||!r.test(t.event.ax_url))}var i=Ul(n.ignore||[]);if(i&&i.test(t.event.ax_url))return!1;var a=n.statusCodeSample;if(a&&yl(a,t.event.ax_status))return Uu(a[t.event.ax_status]);var s=n.requestUrlSample;if(s){var c=!1,l=!1;if(s.forEach((function(e){if(!c){var n=Ul([e.url]);(null==n?void 0:n.test(t.event.ax_url))&&(c=!0,l=Uu(e.sampleRate))}})),c)return l}return!0}({sendParams:e,ajaxMonitor:o.AjaxMonitor}):"PerformanceMonitor"===e.name?function(e){var t=e.performanceMonitor;if(!t)return!0;if(t.webIDHit)return!0;if(!t.sampleHit)return!1;return!0}({performanceMonitor:o.PerformanceMonitor}):"EmitMonitor"===e.name?function(e){var t=e.sendParams,n=e.flexibleMonitor;if(!n)return!0;if(n.webIDHit)return!0;if(!n.sampleHit)return!1;var o=n.eventNameHit;if(o){var r=t.event.flexible_data_list[0].event_name;if(yl(o,r))return Uu(o[r])}return!0}({sendParams:e,flexibleMonitor:o.FlexibleMonitor}):"StaticErrorMonitor"===e.name?function(e){var t=e.sendParams,n=e.staticErrorMonitor;if(!n)return!0;if(n.webIDHit)return!0;if(!n.sampleHit)return!1;var o=Ul(n.ignore||[]);if(o&&o.test(t.event.st_src))return!1;return!0}({sendParams:e,staticErrorMonitor:o.StaticErrorMonitor}):"HijackMonitor"===e.name?function(e){var t=e.hijackMonitor;if(!t)return!0;if(t.webIDHit)return!0;if(!t.sampleHit)return!1;return!0}({hijackMonitor:o.HijackMonitor}):"JSErrorMonitor"!==e.name||function(e){var t=e.jsErrorMonitor;if(!t)return!0;if(t.webIDHit)return!0;if(!t.sampleHit)return!1;return!0}({jsErrorMonitor:o.JSErrorMonitor}))},t.prototype._modifyEvent=function(e){var t;if(!(null===(t=this.options)||void 0===t?void 0:t.monitors)||!e||!_l(e))return{};var n=this.options.monitors;return"PerformanceMonitor"===e.name?function(e){var t,n=e.sendParams,o=e.performanceMonitor;if(!o)return n;if(!Rl())return{};if(n.event.isAsync)t=n.event.load>o.spaSlowSessionTime;else{var r=window.performance.timing;t=r.loadEventEnd-r.navigationStart>o.slowSessionTime}if(n.event.resources&&bl(n.event.resources)){var i=Ul(o.geckoUrls||[]);n.event.resources.forEach((function(e,t){var o,r,a,s;(null===(o=n.event.resources)||void 0===o?void 0:o[t])&&_l(null===(r=n.event.resources)||void 0===r?void 0:r[t])&&ml(null===(a=n.event.resources)||void 0===a?void 0:a[t].toJSON)&&(n.event.resources[t]=null===(s=n.event.resources)||void 0===s?void 0:s[t].toJSON(),n.event.resources[t].is_gecko=i&&i.test(e.name||"")?"1":"0")}))}o.webIDHitStaticResource||o.sampleHitStaticResource?n.event.upload_reason="sample":t?n.event.upload_reason="slow_session":(delete n.event.resources,n.event.has_resource=0);return n}({sendParams:e,performanceMonitor:n.PerformanceMonitor}):"PathMonitor"===e.name?function(e){var t=e.sendParams,n=e.baseMonitor,o=e.effect;1===n.appTypeSetting.type&&n.appTypeSetting.SPA===t.event.type&&(o({commonParams:{pid:t.event.path}}),delete t.event.type,delete t.event.path);return{}}({sendParams:e,baseMonitor:n.BaseMonitor,effect:this.updateConfig}):e},t.prototype.buildParams=function(e){var t,n,o,r,i=e.event||{},a=e.overrides||{},s=a.context,c=hl(a,["context"]),l=dl({},null!==(n=null===(t=this.options)||void 0===t?void 0:t.commonParams)&&void 0!==n?n:{});if(_l(s)){var u=dl(dl({},null!==(o=_l(l.context)&&l.context)&&void 0!==o?o:{}),s||{});l.context=u}var d=dl(dl(dl({},i),l||{}),c);return d=this.normalizeEvent(d),(null===(r=this.options)||void 0===r?void 0:r.custom)&&ml(this.options.custom.beforeSend)&&(d=this.options.custom.beforeSend(d||{})),d},t.prototype._request=function(e){var t;if(e&&e.event){var n=e.type,o=e.event,r=window.automation_test_info;if(r&&(o.automation_test_info=r),"beacon"===(null===(t=this.options)||void 0===t?void 0:t.commonParams.report_type)&&navigator&&navigator.sendBeacon){var i=JSON.stringify(o);navigator.sendBeacon(this.getReportURL(),i)}else this.transport&&("get"!==n?"post"===n&&this.transport.postEvent(o):this.transport.getEvent(o))}},t.prototype.chechIsReady=function(){return 2===this.clientStatus},t.prototype.updateStatus=function(){var t=this;switch(this.clientStatus){case 0:this.clientStatus=1;break;case 1:if(this.clientStatus=2,!this.preQueue.length)return;this.preQueue.forEach((function(n){e.prototype.sendEvent.call(t,n)})),this.preQueue=[]}},t.prototype.getBatchReportURL=function(){var e;return"https://"+(null===(e=this.options)||void 0===e?void 0:e.commonParams.report_domain)+"/log/sentry/v2/api/slardar/batch/"},t.prototype.normalizeOptions=function(e){var t;return wl({},null!==(t=this.options)&&void 0!==t?t:{},e)},t.prototype.normalizeEvent=function(e){var t=dl(dl({},e),{url:window.location.href,client_time:Date.now()});return _l(e.context)&&(t.context=JSON.stringify(e.context)),t||{}},t}(Pu);var Ju=function(){var e="";return(null===document||void 0===document?void 0:document.cookie)&&(e=function(e,t){var n,o;if(!e||!t)return"";var r=e.split(";"),i={};try{for(var a=fl(r),s=a.next();!s.done;s=a.next()){var c=s.value.split("="),l=vl(c[0])&&c[0].trim();l&&vl(c[1])&&(i[l]=c[1].trim())}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return i[t]||""}(document.cookie,Ql)),e};function qu(e){var t,n,o,r,i;return wl({},{commonParams:{version:"",hostname:window.location.hostname,protocol:window.location.protocol.slice(0,-1),url:window.location.href,slardar_session_id:Xl,sample_rate:1,pid:location.pathname,report_domain:ju,screen_resolution:(void 0===o&&(o=window),Ll()&&(null===(r=o.screen)||void 0===r?void 0:r.width)&&(null===(i=o.screen)||void 0===i?void 0:i.height)?o.screen.width+"x"+o.screen.height:"0x0"),network_type:(t="unknown",n=navigator.connection||navigator.mozConnection||navigator.webkitConnection,n&&vl(n.effectiveType)?n.effectiveType:t),bid:"",context:{},slardar_web_id:Ju()||Zl,report_type:"xhr",performanceAuto:!0,reportURLSingle:"",region:"cn",env:"production",refreshPrecollectedContext:!1,maxBatchReportLength:10,batchReportWait:1e3},flags:{hookPath:!0,hookXHR:!0,hookFetch:!0,enableSizeStats:!0,enableFMP:!0,enablePerformance:!0,enableResourcePerformance:!0,enableStaticError:!0,enableCatchJSError:!0,enableCatchGlobalJSError:!0,enableCatchJSErrorV2:!1,enableCrash:!1,enableMemoryRecord:!1,enableFPSJankTimesMonitor:!1,enableBreadcrumb:!0,catchUnhandledRejection:!0,catchUnhandledRejectionV2:!0,hookConsole:!1,hookDom:!0},monitors:{BaseMonitor:{appTypeSetting:{type:0,SPA:"",renderType:0},webIDHit:!1,sampleHit:Vl(1)},PageViewMonitor:{webIDHit:!1,sampleHit:Vl(1)},JSErrorMonitor:{webIDHit:!1,sampleHit:Vl(1),webIDHitBehavior:Vl(0),sampleHitBehavior:Vl(0),ignoreErrors:[],whitelistUrls:[],blacklistUrls:[],download_link:""},AjaxMonitor:{webIDHit:!1,sampleHit:Vl(1),sampleHitTrace:Vl(0),ignore:Yl,abort:!1,whitelistUrls:[],statusCodeSample:{},requestUrlSample:[],errorRequestCollect:!1},PerformanceMonitor:{webIDHit:!1,sampleHit:Vl(1),webIDHitStaticResource:!1,sampleHitStaticResource:Vl(.1),slowSessionTime:8e3,spaSlowSessionTime:4e3,geckoUrls:[],interval:0,checkPoint:[]},FlexibleMonitor:{webIDHit:!1,sampleHit:Vl(1),eventNameHit:{},eventNameSampleHit:Vl(1)},StaticErrorMonitor:{webIDHit:!1,sampleHit:Vl(1),ignore:Yl},HijackMonitor:{webIDHit:!1,sampleHit:Vl(.1)},FMPMonitor:{}},plugins:{render:{enable:0},spa:{enable:0,type:""},behavior:{enable:0,slardar_web_ids:[],sample_rate:0,download_link:"https://lf3-cdn-tos.bytegoofy.com/goofy/slardar/fe/sdk/plugins/behavior.3.6.34.cn.js"},sentry:{enable:0,behavior_enable:0,behavior_sample_rate:0,behavior_slardar_web_ids:[],download_link:Mu}},custom:{beforeSend:function(e){return e}},heatmap:{openList:[]}},e)}var Wu=function(e,t){var n=!1;return e?(e.forEach((function(e){n||!e.condition.is_default&&"slardar_web_id"===e.condition.field&&Cl(e.condition.values,t.web_id)&&(n=!0)})),n):n},$u=function(e){var t=!1;return!e||(e.forEach((function(e){e.condition.field&&t||(t=Uu(Number(e.value)))})),t)},Yu=function(e){var t=[];if(e)try{t=JSON.parse(e)}catch(e){t=[]}return t},Qu=function(e){var t=[];return e.forEach((function(e){if(e.value){var n=Yu(e.value);t.push.apply(t,gl([],pl(n)))}})),t},Xu=function(e,t){var n={},o=[];return e.forEach((function(e){e.condition.field===t&&e.condition.values&&e.condition.values.forEach((function(t){yl(n,t)||(n[t]=Number(e.value)||0,o.push({url:t,sampleRate:n[t]}))}))})),{flatten:n,list:o}},Zu=function(e){var t;void 0===e&&(e={});var n=wl({},null!==(t=e.commonParams)&&void 0!==t?t:{});if(!_l(e))return n;var o=["bid","context","pid","slardar_web_id","slardar_session_id","performanceAuto","report_type","region","env","refreshPrecollectedContext","maxBatchReportLength","batchReportWait"];return kl(e,(function(e,t){Cl(o,e)&&("report_domain"===e&&"mon-va.byteoversea.com"===t?n.region="maliva":n[e]=t)})),kl({cookieid:"slardar_web_id",sampleRate:"sample_rate",reportDomain:"report_domain",domain:"report_domain",sample_rate:"sample_rate",slardar_web_id:"slardar_web_id"},(function(t,o){yl(e,t)&&(n[o]=e[t])})),n.slardar_web_id&&(n.slardar_web_id=n.slardar_web_id.toString()),n};function ed(e,t){var n,o,r,i,a,s,c,l,u,d={PageViewMonitor:{},JSErrorMonitor:{},AjaxMonitor:{},PerformanceMonitor:{},FlexibleMonitor:{},StaticErrorMonitor:{},HijackMonitor:{},BaseMonitor:{}},h=null!==(n=e.setting)&&void 0!==n?n:{};if((null===(r=null===(o=h.page_view)||void 0===o?void 0:o.enable_rate)||void 0===r?void 0:r.length)&&(d.PageViewMonitor.webIDHit=Wu(h.page_view.enable_rate,t),d.PageViewMonitor.sampleHit=$u(h.page_view.enable_rate)),h.jserr&&((null===(i=h.jserr.enable_rate)||void 0===i?void 0:i.length)&&(d.JSErrorMonitor.webIDHit=Wu(h.jserr.enable_rate,t),d.JSErrorMonitor.sampleHit=$u(h.jserr.enable_rate)),h.jserr.ignore_errors&&(d.JSErrorMonitor.ignoreErrors=Qu(h.jserr.ignore_errors)),h.jserr.blacklist_urls&&(d.JSErrorMonitor.blacklistUrls=Qu(h.jserr.blacklist_urls)),h.jserr.whitelist_urls&&(d.JSErrorMonitor.whitelistUrls=Qu(h.jserr.whitelist_urls))),h.ajax&&(h.ajax.enable_rate&&(d.AjaxMonitor.webIDHit=Wu(h.ajax.enable_rate,t),d.AjaxMonitor.sampleHit=$u(h.ajax.enable_rate)),h.ajax.request_sample_rate&&(d.AjaxMonitor.statusCodeSample=Xu(h.ajax.request_sample_rate,"status_code").flatten,d.AjaxMonitor.requestUrlSample=Xu(h.ajax.request_sample_rate,"request_url").list),h.ajax.trace_rate&&(d.AjaxMonitor.sampleHitTrace=$u(h.ajax.trace_rate)),h.ajax.enable_request_param_collect_on_error&&(d.AjaxMonitor.errorRequestCollect=function(e,t){var n,o;void 0===t&&(t=!1);try{for(var r=fl(e),i=r.next();!i.done;i=r.next()){var a=i.value;if(a.value)return"true"===a.value}}catch(e){n={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}return t}(h.ajax.enable_request_param_collect_on_error))),(null===(a=h.static_resource)||void 0===a?void 0:a.enable_rate)&&(d.PerformanceMonitor.webIDHitStaticResource=Wu(h.static_resource.enable_rate,t),d.PerformanceMonitor.sampleHitStaticResource=$u(h.static_resource.enable_rate)),(null===(s=h.performance)||void 0===s?void 0:s.enable_rate)&&(d.PerformanceMonitor.webIDHit=Wu(h.performance.enable_rate,t),d.PerformanceMonitor.sampleHit=$u(h.performance.enable_rate)),h.flexible&&(h.flexible.enable_rate&&(d.FlexibleMonitor.webIDHit=Wu(h.flexible.enable_rate,t),d.FlexibleMonitor.sampleHit=$u(h.flexible.enable_rate)),h.flexible.event_name_sample_rate&&(d.FlexibleMonitor.eventNameHit=Xu(h.flexible.event_name_sample_rate,"event_name").flatten,d.FlexibleMonitor.eventNameSampleHit=$u(h.flexible.event_name_sample_rate))),(null===(c=h.static_err)||void 0===c?void 0:c.enable_rate)&&(d.StaticErrorMonitor.webIDHit=Wu(h.static_err.enable_rate,t),d.StaticErrorMonitor.sampleHit=$u(h.static_err.enable_rate)),h.general){var f=h.general.app_type_setting;if(f){var p={type:Number(f.app_type[0].value),SPA:f.app_type_spa[0].value,renderType:td({renderRules:(l=f.app_render_type,u=[],l.forEach((function(e){"pid"===e.condition.field.toLowerCase()&&"like"===e.condition.op.toLowerCase()&&e.value?u.push({pids:Yu(e.value),value:parseInt(e.value,10),isDefault:!1}):e.condition.is_default&&u.push({pids:[],value:parseInt(e.value,10),isDefault:!0})})),u),pid:t.pid})};d.BaseMonitor.appTypeSetting=p}}var g=e.whitelist;return bl(g)&&g.forEach((function(e){t.web_id===e&&(d.BaseMonitor.webIDHit=!0,d.AjaxMonitor.sampleHitTrace=!0)})),d}function td(e){var t=e.renderRules,n=e.pid;if(!t||!n)return 0;for(var o=0;o<t.length;o++){var r=t[o];if(bl(r.pids)&&r.pids.length>0){var i=Ul(r.pids);if(i&&i.test(n))return r.value}if(r.isDefault&&o===t.length-1)return r.value}return 0}var nd=function(){function e(){var e=this;this.version="3.6.34",this.instance=function(){for(var t,n,o,r,i,a,s,c,l,u,d,h,f,p,g=[],_=0;_<arguments.length;_++)g[_]=arguments[_];switch(g[0]){case"init":return void e.init(g[1]);case"config":return void e.config(g[1]);case"sendCustomCountLog":case"sendCustomTimeLog":case"emit":case"send":return void(e.shared.monitors.EmitMonitor?(t=e.shared.monitors.EmitMonitor).handOut.apply(t,gl([],pl(g))):e.instance("precollect","emit",g));case"precollect":var m=e.shared.collect,v=e.finalConfig.commonParams.refreshPrecollectedContext?{}:{pid:e.finalConfig.commonParams.pid,url:e.finalConfig.commonParams.url,context:e.finalConfig.commonParams.context};if("sentry"===g[1])return void m.sentry.push({event:g[2],params:v});if("exception"===g[1]){var b=g[3]||{},y=b.context,k=hl(b,["context"]),w=dl(dl({},_l(v.context)&&v.context),y);return v.context=w,void m.exception.push({exception:g[2],params:dl(dl({},v),k)})}if("error"===g[1]){if(!g[2]||!g[2][0])return;var E=g[2][0]||{};return Hu(E)&&((E.error||E.message)&&m.jsError.push({event:E,params:v}),(null===(n=E.target)||void 0===n?void 0:n.tagName)&&m.staticError.push({event:E,params:v})),void(Fu(E)&&m.jsError.push({event:E,params:v}))}return void("emit"===g[1]&&m.emit.push({event:g[2],params:v}));case"Sentry":var S=g[1];if(ml(S)){var T=null===(r=null===(o=e.shared.monitors)||void 0===o?void 0:o.JSErrorMonitor)||void 0===r?void 0:r.getSentry();T?S(T):e.instance("precollect","sentry",g[1])}return;case"report":return void(e.client&&e.client.uploadQueue());case"performanceSend":return void(null===(s=null===(a=null===(i=e.shared.monitors)||void 0===i?void 0:i.PerformanceMonitor)||void 0===a?void 0:a.send)||void 0===s||s.call(a));case"performanceInit":return void(null===(u=null===(l=null===(c=e.shared.monitors)||void 0===c?void 0:c.PerformanceMonitor)||void 0===l?void 0:l.initAsync)||void 0===u||u.call(l,e.finalConfig.commonParams.pid));case"captureException":if(e.shared.monitors.JSExceptionMonitor){var I=e.shared.monitors.JSExceptionMonitor.buildEvent(g[1]),O=Vu(I,null!==(d=g[2])&&void 0!==d?d:{});null===(f=null===(h=e.client)||void 0===h?void 0:h.sendEvent)||void 0===f||f.call(h,O)}else e.instance("precollect","exception",g[1],g[2]);return;case"context":return void(e.client&&(null===(p=g[1])||void 0===p||p.call(g,e.client.contextAgent)));default:return}},this.changeReortType=function(t){var n;e.finalConfig.commonParams.report_type=t,null===(n=e.client)||void 0===n||n.updateConfig(e.finalConfig)},this.onClose=function(){var t,n;t=e.onCloseReport,n=e.visibilityChange,ml(t)&&(ml(window.addEventListener)&&(window.addEventListener("unload",t),window.addEventListener("beforeunload",t),window.addEventListener("pagehide",t)),ml(document.addEventListener)&&document.addEventListener("visibilitychange",(function(e){ml(n)?n(e):"hidden"===document.visibilityState&&t(e)})))},this.visibilityChange=function(){"hidden"===document.visibilityState&&e.onCloseReport(),"visible"===document.visibilityState&&e.changeReortType("xhr")},this.onCloseReport=function(){var t;e.changeReortType("beacon"),null===(t=e.client)||void 0===t||t.uploadQueue()},this.defaultClientConfig=qu({commonParams:{version:this.version}}),this.finalConfig=qu({commonParams:{version:this.version}}),this.client=void 0,this.userConfig={},this.inited=!1,this.configed=!1,this.shared={config:this.finalConfig,instance:[],collect:{sentry:[],jsError:[],staticError:[],emit:[],exception:[]},monitors:{}},this.baseParams={bid:this.shared.config.commonParams.bid||"",pid:this.shared.config.commonParams.pid||""},this.serverSetting=this.__SLARDAR__REPALCE__HOLDER__,this.saveInstance()}return e.prototype.handleUserConfig=function(e){var t;this.userConfig=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n={},o=0;o<e.length;)n=Tl(n,e[o]),o++;return n}(this.userConfig,e),(null===(t=this.userConfig)||void 0===t?void 0:t.onlyUseLocalSetting)&&(this.serverSetting={}),this.mergeSettings()},e.prototype.setBaseParams=function(){this.baseParams.bid=this.shared.config.commonParams.bid||"",this.baseParams.pid=this.shared.config.commonParams.pid||""},e.prototype.init=function(e){var t=this;this.handleUserConfig(e);var n=this.finalConfig;if(!this.inited){var o;this.inited=!0,this.client=new Gu({reportURL:(o=n.commonParams.report_domain,"https://"+(null!=o?o:ju)+"/log/sentry/v2/api/slardar/batch/"),maxBatchReportLength:n.commonParams.maxBatchReportLength,batchReportWait:n.commonParams.batchReportWait}),this.client.setOnOptionsUpdate((function(e){e&&e.commonParams.pid!==t.finalConfig.commonParams.pid&&t.handleUserConfig({pid:e.commonParams.pid})})),n.commonParams.refreshPrecollectedContext&&this.refreshPrecollectedContext();var r=this.setMonitors();this.setupMonitors(r),this.shared.instance&&bl(this.shared.instance)&&this.shared.instance.push(n.commonParams.bid),this.getServerSetting(n.commonParams.bid),this.onClose()}},e.prototype.config=function(e){var t;if(this.configed=!0,this.inited){this.handleUserConfig(e);var n=this.finalConfig;null===(t=this.client)||void 0===t||t.updateConfig(n)}else this.init(e);this.tryUnlockClient()},e.prototype.getServerSetting=function(e){var t=this;if(this.serverSetting)this.handleServerSetting();else{var n,o="https://"+(null!=(n=this.finalConfig.commonParams.report_domain)?n:ju)+"/slardar/sdk_setting?bid="+e;Hl.get(o,{success:function(e){try{t.serverSetting=e.data||{},t.handleServerSetting()}catch(e){t.userConfig.sampleRate=.001,t.handleServerSetting()}},fail:function(){t.userConfig.sampleRate=.001,t.handleServerSetting()},withCredentials:!0})}},e.prototype.setMonitors=function(){var e,t,n=this,o=[],r=this.finalConfig.flags,i=this.finalConfig.commonParams;if(r.hookPath&&o.push(new Nu),r.hookXHR&&o.push(new xu({commonParams:{web_id:i.slardar_web_id,bid:i.bid},ajaxMonitorOptions:this.finalConfig.monitors.AjaxMonitor})),r.hookFetch&&o.push(new Du({commonParams:{web_id:i.slardar_web_id,bid:i.bid},ajaxMonitorOptions:this.finalConfig.monitors.AjaxMonitor})),r.enableFMP){var a=null===(e=Lu())||void 0===e?void 0:e(this.finalConfig.monitors.FMPMonitor);this.shared.FMPMonitor=a}return(null===(t=this.shared)||void 0===t?void 0:t.monitors)&&o.forEach((function(e){n.shared.monitors[e.name]=e})),o},e.prototype.setupMonitors=function(e){var t=this;this.client&&this.client.sendEvent&&e.forEach((function(e){var n;e.setup(null===(n=t.client)||void 0===n?void 0:n.sendEvent)}))},e.prototype.shouldSetClientEnable=function(){return"production"===this.finalConfig.commonParams.env},e.prototype.tryUnlockClient=function(){var e;null===(e=this.client)||void 0===e||e.setEnable(this.shouldSetClientEnable()&&this.configed&&!!this.serverSetting)},e.prototype.handleServerSetting=function(){var e,t;this.mergeSettings();var n=this.finalConfig;this.client.updateConfig(n),this.client.setTransport(),this.tryUnlockClient(),this.client.sendPageview(),this.shared.transport=this.client.transport,this.shared.sendEvent=this.client.sendEvent.bind(this.client),this.setCookie(n.commonParams.slardar_web_id),null===(e=this.shared.monitors.FetchMonitor)||void 0===e||e.updateConfig({commonParams:{web_id:n.commonParams.slardar_web_id,bid:n.commonParams.bid},ajaxMonitorOptions:n.monitors.AjaxMonitor}),null===(t=this.shared.monitors.AjaxMonitor)||void 0===t||t.updateConfig({commonParams:{web_id:n.commonParams.slardar_web_id,bid:n.commonParams.bid},ajaxMonitorOptions:n.monitors.AjaxMonitor}),this.loadMonitors(),n.flags.enableCatchJSError&&this.loadSentry(),n.heatmap.openList.length&&this.loadHeatmap(),location.search.indexOf("slardar_heatmap_draw")>-1&&this.loadHeatmapDraw()},e.prototype.loadSentry=function(){var e=this;tu("https://lf3-cdn-tos.bytegoofy.com/goofy/slardar/fe/sdk/plugins/sentry.3.6.34.cn.js",(function(){var t=Ku({name:"SetSentryMonitors",version:e.version});if(t){var n=new t({catchUnhandledRejection:e.finalConfig.flags.catchUnhandledRejection,hookConsole:e.finalConfig.flags.hookConsole,hookDom:e.finalConfig.flags.hookDom,memoryRecordMonitor:e.shared.monitors.MemoryRecordMonitor,collect:e.shared.collect,sendEvent:e.client.sendEvent,jsErrorOptions:e.shared.config.monitors.JSErrorMonitor});n.init(),e.shared.monitors=dl(dl({},e.shared.monitors),n.getInstalledMonitors())}}))},e.prototype.loadMonitors=function(){var e=this;tu("https://lf3-cdn-tos.bytegoofy.com/goofy/slardar/fe/sdk/plugins/monitors.3.6.34.cn.js",(function(){var t,n=Ku({name:"SetMonitors",version:e.version});if(n)try{var o=new n({config:e.finalConfig,fmpMonitor:e.shared.FMPMonitor,report:function(){return e.instance("report")},sendEvent:null===(t=e.client)||void 0===t?void 0:t.sendEvent,captureException:function(t){return e.instance("Sentry",(function(e){e.captureException(t)}))},collect:e.shared.collect});o.init(),e.shared.monitors=dl(dl({},e.shared.monitors),o.getInstalledMonitors())}catch(t){e.instance("Sentry",(function(e){e.captureException(t);try{e.withScope((function(t){t.setTag("from","slardar-sdk"),e.captureMessage("SLARDAR_ERROR: "+typeof n),e.captureMessage("SLARDAR_ERROR: "+n.toString())}))}catch(t){e.withScope((function(n){n.setTag("from","slardar-sdk"),e.captureException(t)}))}}))}}))},e.prototype.loadHeatmap=function(){var e=this;tu("https://lf3-cdn-tos.bytegoofy.com/goofy/slardar/fe/sdk/plugins/heatmap.3.6.34.cn.js",(function(){var t=Ku({name:"SetHeatmap",version:e.version});if(t){var n=new t({config:e.finalConfig,report:function(){return e.instance("report")},sendEvent:e.client.sendEvent,collect:e.shared.collect,pathMonitor:e.shared.monitors.PathMonitor,buildSendParams:e.client.buildSendParams,reportURL:e.client.getReportURL()});n.init(),e.shared.monitors=dl(dl({},e.shared.monitors),n.getInstalledMonitors())}}))},e.prototype.loadHeatmapDraw=function(){var e=this;tu("https://lf3-cdn-tos.bytegoofy.com/goofy/slardar/fe/sdk/plugins/heatmap-draw.3.6.34.cn.js",(function(){var t=Ku({name:"SetHeatmapDraw",version:e.version});t&&new t({config:e.finalConfig,pathMonitor:e.shared.monitors.PathMonitor}).init()}))},e.prototype.setCookie=function(e){e&&(document.cookie="MONITOR_WEB_ID="+e+";max-age=7776000;domain="+location.hostname+";path=/")},e.prototype.normalizeSetting=function(e){return{commonParams:this.getClientCommonParams(e),flags:this.getClientFlags(e),plugins:this.getClientPluginsSetting(e),monitors:this.getClientMonitorsSetting(e),custom:this.getClientCustom(e),heatmap:this.getClientHeatmap(e)}},e.prototype.normalizeServerSetting=function(e){var t;return yl(e,"setting")?{commonParams:Zu(e),monitors:ed(e,this.getNormoalizeInfo()),heatmap:e.heatmap}:this.normalizeSetting({cookieid:e.cookieid,reportDomain:e.reportDomain,bid:e.bid,plugins:e.plugins,heatmap:null!==(t=e.heatmap)&&void 0!==t?t:{openList:[]}})},e.prototype.getClientHeatmap=function(e){var t;return null!==(t=e.heatmap)&&void 0!==t?t:{}},e.prototype.mergeSettings=function(){var e,t=this.serverSetting?this.normalizeServerSetting(this.serverSetting):{},n=this.normalizeSetting(this.userConfig),o=wl(this.defaultClientConfig,t,n);o.commonParams.reportURLSingle="https://"+(null!=(e=o.commonParams.report_domain)?e:ju)+"/log/sentry/v2/api/slardar/main/",o.commonParams.pid=this.getPid(o),this.shared.config=o,this.setBaseParams(),this.finalConfig=o},e.prototype.getPid=function(e){if(e.commonParams.pid)return e.commonParams.pid;var t=e.monitors.BaseMonitor;return 1===t.appTypeSetting.type&&"hash"===t.appTypeSetting.SPA?location.hash.slice(1)||"/":location.pathname},e.prototype.getClientCommonParams=function(e){return Zu(e)},e.prototype.getClientFlags=function(e){return function(e){var t;void 0===e&&(e={});var n=wl({},null!==(t=e.flags)&&void 0!==t?t:{});if(!_l(e))return n;var o=["hookPath","hookXHR","hookFetch","enableSizeStats","enableFMP","enablePerformance","enableStaticError","enableCatchJSError","enableCatchJSErrorV2","enableCatchGlobalJSError","enableResourcePerformance","enableCrash","enableMemoryRecord","enableFPSJankTimesMonitor","enableBreadcrumb","catchUnhandledRejection","catchUnhandledRejectionV2","hookConsole","hookDom"];return kl(e,(function(e,t){Cl(o,e)&&(n[e]=t)})),n}(e)},e.prototype.getClientCustom=function(e){var t={};return e.beforeSend&&ml(e.beforeSend)&&(t.beforeSend=e.beforeSend),t},e.prototype.getClientMonitorsSetting=function(e){return function(e){var t,n,o=e.setting,r=e.info,i=wl({PageViewMonitor:{},JSErrorMonitor:{},AjaxMonitor:{},PerformanceMonitor:{},FlexibleMonitor:{},StaticErrorMonitor:{},HijackMonitor:{},BaseMonitor:{appTypeSetting:{}},FMPMonitor:{}},o.monitors);o.ajaxWhitelistUrls&&bl(o.ajaxWhitelistUrls)&&(i.AjaxMonitor.whitelistUrls=(i.AjaxMonitor.whitelistUrls||[]).concat(o.ajaxWhitelistUrls)),o.ignoreAjax&&bl(o.ignoreAjax)&&(i.AjaxMonitor.ignore=(i.AjaxMonitor.ignore||[]).concat(o.ignoreAjax)),yl(o,"geckoUrls")&&(i.PerformanceMonitor.geckoUrls=o.geckoUrls),o.ignoreStatic&&bl(o.ignoreStatic)&&(i.StaticErrorMonitor.ignore=(i.StaticErrorMonitor.ignore||[]).concat(o.ignoreStatic)),(null===(t=o.plugins)||void 0===t?void 0:t.sentry)&&(i.JSErrorMonitor=dl(dl({},i.JSErrorMonitor||{}),o.plugins.sentry)),o.errorRelease&&(i.JSErrorMonitor.release=o.errorRelease),o.ignoreErrors&&bl(o.ignoreErrors)&&(i.JSErrorMonitor.ignoreErrors=o.ignoreErrors),o.errorBlacklistUrls&&bl(o.errorBlacklistUrls)&&(i.JSErrorMonitor.blacklistUrls=o.errorBlacklistUrls),o.errorWhitelistUrls&&bl(o.errorWhitelistUrls)&&(i.JSErrorMonitor.whitelistUrls=o.errorWhitelistUrls),o.fmpIgnoreTags&&bl(o.fmpIgnoreTags)&&(i.FMPMonitor.ignoreTags=o.fmpIgnoreTags),yl(o,"sampleRate")&&(i.BaseMonitor.sampleHit=Uu(o.sampleRate));var a=o.plugins;if(a&&_l(a)){if(yl(a,"spa")){var s=a.spa;s&&yl(s,"enable")&&(i.BaseMonitor.appTypeSetting.type=Number(s.enable)),s&&yl(s,"type")&&(i.BaseMonitor.appTypeSetting.SPA=s.type)}if(a.render){var c=null===(n=o.plugins)||void 0===n?void 0:n.render;if(c&&_l(c)&&yl(c,"enable")){var l=[{pids:[],value:c.enable,isDefault:!0}];i.BaseMonitor.appTypeSetting.renderType=td({renderRules:l,pid:r.pid})}}}return i}({setting:e,info:this.getNormoalizeInfo()})},e.prototype.getClientPluginsSetting=function(e){return function(e){var t;return void 0===e&&(e={}),wl({sentry:{},behavior:{},spa:{},render:{}},null!==(t=e.plugins)&&void 0!==t?t:{})}(e)},e.prototype.getNormoalizeInfo=function(){return{web_id:this.finalConfig.commonParams.slardar_web_id,pid:this.finalConfig.commonParams.pid}},e.prototype.saveInstance=function(){window.__SLARDAR__||(window.__SLARDAR__={}),window.__SLARDAR__&&!bl(window.__SLARDAR__.instances)&&(window.__SLARDAR__.instances=[]),window.__SLARDAR__&&bl(window.__SLARDAR__.instances)&&window.__SLARDAR__.instances.push({version:this.version})},e.prototype.refreshPrecollectedContext=function(){var e,t=this;kl(null!==(e=this.shared.collect)&&void 0!==e?e:{},(function(e){var n;null===(n=t.shared.collect)||void 0===n||n[e].forEach((function(e){return e.params={}}))}))},e}(),od=Pl;if(Ll()){var rd=new nd;(od=rd.instance).version=rd.version,od.shared=rd.shared,od.SlardarBrowser=nd,od._baseParams=rd.baseParams}const id={initStart:{domain:"js.open_platform.blockit.sdk",code:1e4,level:2,message:"init_start"},initLoadEngineResult:{domain:"js.open_platform.blockit.sdk",code:10001,level:2,message:"init_load_engine_result"},initStorageStart:{domain:"js.open_platform.blockit.sdk",code:10002,level:2,message:"init_storage_start"},initStorageResult:{domain:"js.open_platform.blockit.sdk",code:10003,level:2,message:"init_storage_result"},diagnoseEngineResult:{domain:"js.open_platform.blockit.sdk",code:10004,level:2,message:"diagnose_engine_result"},apiError:{domain:"js.open_platform.blockit.sdk",code:10005,level:4,message:"api_error"},mountCreatorStart:{domain:"js.open_platform.blockit.sdk",code:2e4,level:2,message:"mount_creator_start"},mountCreatorCheckEngineResult:{domain:"js.open_platform.blockit.sdk",code:20001,level:2,message:"mount_creator_check_engine_result"},mountCreatorGetBlockStart:{domain:"js.open_platform.blockit.sdk",code:20002,level:2,message:"mount_creator_get_block_start"},mountCreatorGetBlockResult:{domain:"js.open_platform.blockit.sdk",code:20003,level:2,message:"mount_creator_get_block_result"},mountCreatorGenerateBlockStart:{domain:"js.open_platform.blockit.sdk",code:20004,level:2,message:"mount_creator_generate_block_start"},mountCreatorGenerateBlockResult:{domain:"js.open_platform.blockit.sdk",code:20005,level:2,message:"mount_creator_generate_block_result"},mountCreatorDestroy:{domain:"js.open_platform.blockit.sdk",code:20006,level:2,message:"mount_creator_destroy"},mountSettingStart:{domain:"js.open_platform.blockit.sdk",code:3e4,level:2,message:"mount_setting_start"},mountBlockStart:{domain:"js.open_platform.blockit.sdk",code:4e4,level:2,message:"mount_block_start"},mountBlockCheckEngineResult:{domain:"js.open_platform.blockit.sdk",code:40001,level:2,message:"mount_block_check_engine_result"},mountBlockTimeout:{domain:"js.open_platform.blockit.sdk",code:40002,level:2,message:"mount_block_timeout"},mountBlockByIdStart:{domain:"js.open_platform.blockit.sdk",code:5e4,level:2,message:"mount_block_by_id_start"},mountBlockByIdGetEntityStart:{domain:"js.open_platform.blockit.sdk",code:50001,level:2,message:"mount_block_by_id_get_entity_start"},mountBlockByIdGetEntityResult:{domain:"js.open_platform.blockit.sdk",code:50002,level:2,message:"mount_block_by_id_get_entity_result"},lifecycleCreatorOnconfigloaded:{domain:"js.open_platform.blockit.sdk",code:60001,level:2,message:"lifecycle_creator_onconfigloaded"},lifecycleCreatorOnloaded:{domain:"js.open_platform.blockit.sdk",code:60002,level:2,message:"lifecycle_creator_onloaded"},lifecycleCreatorOncontentloaded:{domain:"js.open_platform.blockit.sdk",code:60003,level:2,message:"lifecycle_creator_oncontentloaded"},lifecycleCreatorOnloadfail:{domain:"js.open_platform.blockit.sdk",code:60004,level:4,message:"lifecycle_creator_onloadfail"},lifecycleCreatorOnreload:{domain:"js.open_platform.blockit.sdk",code:60005,level:2,message:"lifecycle_creator_onreload"},lifecycleCreatorOnsubmit:{domain:"js.open_platform.blockit.sdk",code:60006,level:2,message:"lifecycle_creator_onsubmit"},lifecycleCreatorOncancel:{domain:"js.open_platform.blockit.sdk",code:60007,level:2,message:"lifecycle_creator_oncancel"},lifecycleBlockOnconfigloaded:{domain:"js.open_platform.blockit.sdk",code:60008,level:2,message:"lifecycle_block_onconfigloaded"},lifecycleBlockOnloaded:{domain:"js.open_platform.blockit.sdk",code:60009,level:2,message:"lifecycle_block_onloaded"},lifecycleBlockOncontentloaded:{domain:"js.open_platform.blockit.sdk",code:60010,level:2,message:"lifecycle_block_oncontentloaded"},lifecycleBlockOnloadfail:{domain:"js.open_platform.blockit.sdk",code:60011,level:4,message:"lifecycle_block_onloadfail"},lifecycleBlockOnreload:{domain:"js.open_platform.blockit.sdk",code:60012,level:2,message:"lifecycle_block_onreload"},lifecycleBlockOnopensetting:{domain:"js.open_platform.blockit.sdk",code:60013,level:2,message:"lifecycle_block_onopensetting"},lifecycleBlockOnupdateready:{domain:"js.open_platform.blockit.sdk",code:60014,level:2,message:"lifecycle_block_onupdateready"},configSetDebugPortStart:{domain:"js.open_platform.blockit.sdk",code:7e4,level:2,message:"config_set_debug_port_start"},configSetDebugPortResult:{domain:"js.open_platform.blockit.sdk",code:70001,level:2,message:"config_set_debug_port_result"},configSetEnvStart:{domain:"js.open_platform.blockit.sdk",code:8e4,level:2,message:"config_set_env_start"},configSetEnvResult:{domain:"js.open_platform.blockit.sdk",code:80001,level:2,message:"config_set_env_result"},unmountStart:{domain:"js.open_platform.blockit.sdk",code:9e4,level:2,message:"unmount_start"},unmountBlockId:{domain:"js.open_platform.blockit.sdk",code:90001,level:2,message:"unmount_block_id"},unmountBlockInstance:{domain:"js.open_platform.blockit.sdk",code:90002,level:2,message:"unmount_block_instance"},unmountEnd:{domain:"js.open_platform.blockit.sdk",code:90003,level:2,message:"unmount_end"},updateThemeStart:{domain:"js.open_platform.blockit.sdk",code:1e5,level:2,message:"update_theme_start"},updateThemeEnd:{domain:"js.open_platform.blockit.sdk",code:100001,level:2,message:"update_theme_end"},getBlockListStart:{domain:"js.open_platform.blockit.sdk",code:11e4,level:2,message:"get_block_list_start"},getBlockListRequestResult:{domain:"js.open_platform.blockit.sdk",code:110001,level:2,message:"get_block_list_request_result"},getBlockListResult:{domain:"js.open_platform.blockit.sdk",code:110002,level:2,message:"get_block_list_result"},collaborationSubscribeStart:{domain:"js.open_platform.blockit.sdk",code:12e4,level:2,message:"collaboration_subscribe_start"},collaborationSubscribeResult:{domain:"js.open_platform.blockit.sdk",code:120001,level:2,message:"collaboration_subscribe_result"},collaborationUnsubscribeStart:{domain:"js.open_platform.blockit.sdk",code:120002,level:2,message:"collaboration_unsubscribe_start"},collaborationUnsubscribeResult:{domain:"js.open_platform.blockit.sdk",code:120003,level:2,message:"collaboration_unsubscribe_result"},collaborationSocketReconnect:{domain:"js.open_platform.blockit.sdk",code:120004,level:2,message:"collaboration_socket_reconnect"},collaborationSocketConnectStart:{domain:"js.open_platform.blockit.sdk",code:120005,level:2,message:"collaboration_socket_connect_start"},collaborationSocketConnectResult:{domain:"js.open_platform.blockit.sdk",code:120006,level:2,message:"collaboration_socket_connect_result"},collaborationAuthorityStart:{domain:"js.open_platform.blockit.sdk",code:120007,level:2,message:"collaboration_authority_start"},collaborationAuthorityResult:{domain:"js.open_platform.blockit.sdk",code:120008,level:2,message:"collaboration_authority_result"},collaborationUpdateTime:{domain:"js.open_platform.blockit.sdk",code:120009,level:2,message:"collaboration_update_time"},collaborationFetchInitVersion:{domain:"js.open_platform.blockit.sdk",code:120010,level:2,message:"collaboration_fetch_init_version"},collaborationFetchInitVersionResult:{domain:"js.open_platform.blockit.sdk",code:120011,level:2,message:"collaboration_fetch_init_version_result"},collaborationReceiveSubscribeMessage:{domain:"js.open_platform.blockit.sdk",code:120012,level:2,message:"collaboration_receive_subscribe_message"},collaborationWebsocketConnect:{domain:"js.open_platform.blockit.sdk",code:120013,level:2,message:"collaboration_websocket_connect"},collaborationUpdateView:{domain:"js.open_platform.blockit.sdk",code:120014,level:2,message:"collaboration_update_view"},collaborationUpdateMsg:{domain:"js.open_platform.blockit.sdk",code:120015,level:2,message:"collaboration_update_msg"},collaborationFallBackFetch:{domain:"js.open_platform.blockit.sdk",code:120016,level:2,message:"collaboration_fall_back_fetch"},copyBlockStart:{domain:"js.open_platform.blockit.sdk",code:13e4,level:2,message:"copy_block_start"},copyBlockResult:{domain:"js.open_platform.blockit.sdk",code:130001,level:2,message:"copy_block_result"},bulkPasteBlockStart:{domain:"js.open_platform.blockit.sdk",code:14e4,level:2,message:"bulk_paste_block_start"},bulkPasteBlockParams:{domain:"js.open_platform.blockit.sdk",code:140001,level:2,message:"bulk_paste_block_params"},bulkPasteBlockResult:{domain:"js.open_platform.blockit.sdk",code:140002,level:2,message:"bulk_paste_block_result"},loadBlockStart:{domain:"js.open_platform.blockit.sdk",code:1000001,level:2,message:"load_block_start"},loadBlockResult:{domain:"js.open_platform.blockit.sdk",code:1000002,level:2,message:"load_block_result"},loadCreatorStart:{domain:"js.open_platform.blockit.sdk",code:1000003,level:2,message:"load_creator_start"},loadCreatorResult:{domain:"js.open_platform.blockit.sdk",code:1000004,level:2,message:"load_creator_result"},loadEngineStart:{domain:"js.open_platform.blockit.sdk",code:1000005,level:2,message:"load_engine_start"},loadEngineResult:{domain:"js.open_platform.blockit.sdk",code:1000006,level:2,message:"load_engine_result"},requestServiceStart:{domain:"js.open_platform.blockit.sdk",code:1000007,level:2,message:"request_service_start"},requestServiceResult:{domain:"js.open_platform.blockit.sdk",code:1000008,level:2,message:"request_service_result"},timelineInit:{domain:"js.open_platform.blockit.sdk",code:11e5,level:2,message:"timeline_init"},timelineInitGetLarkDomain:{domain:"js.open_platform.blockit.sdk",code:1100001,level:2,message:"timeline_init_get_lark_domain"},timelineInitGetConfigUrl:{domain:"js.open_platform.blockit.sdk",code:1100002,level:2,message:"timeline_init_get_config_url"},timelineInitLoadMain:{domain:"js.open_platform.blockit.sdk",code:1100003,level:2,message:"timeline_init_load_main"},timelineInitLoadEngine:{domain:"js.open_platform.blockit.sdk",code:1100004,level:2,message:"timeline_init_load_engine"},initLoadEngineScriptStart:{domain:"js.open_platform.blockit.sdk",code:1100005,level:2,message:"init_load_engine_script_start"},initLoadEngineScriptResult:{domain:"js.open_platform.blockit.sdk",code:1100006,level:2,message:"init_load_engine_script_result"}};var ad=function(){return(ad=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function sd(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}function cd(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(sd(arguments[t]));return e}var ld,ud=(function(e,t){var n;n=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var o in n)t[o]=n[o]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(o){function r(){}function i(t,n,i){if("undefined"!=typeof document){"number"==typeof(i=e({path:"/"},r.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(e){}n=o.write?o.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in i)i[c]&&(s+="; "+c,!0!==i[c]&&(s+="="+i[c].split(";")[0]));return document.cookie=t+"="+n+s}}function a(e,n){if("undefined"!=typeof document){for(var r={},i=document.cookie?document.cookie.split("; "):[],a=0;a<i.length;a++){var s=i[a].split("="),c=s.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=t(s[0]);if(c=(o.read||o)(c,l)||t(c),n)try{c=JSON.parse(c)}catch(e){}if(r[l]=c,e===l)break}catch(e){}}return e?r[e]:r}}return r.set=i,r.get=function(e){return a(e,!1)},r.getJSON=function(e){return a(e,!0)},r.remove=function(t,n){i(t,"",e(n,{expires:-1}))},r.defaults={},r.withConverter=n,r}((function(){}))},e.exports=n()}(ld={exports:{}}),ld.exports),dd=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e}(),hd={getItem:function(e){try{var t=localStorage.getItem(e),n=t;try{t&&"string"==typeof t&&(n=JSON.parse(t))}catch(e){}return n||void 0}catch(e){}},setItem:function(e,t){try{var n="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,n)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){try{return ud.get(e,{domain:t||document.domain})}catch(e){return""}},setCookie:function(e,t,n,o){try{var r=o||document.domain,i=+new Date+n;ud.set(e,t,{expires:new Date(i),path:"/",domain:r})}catch(e){}},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},fd={getItem:function(e){try{var t=sessionStorage.getItem(e),n=t;try{t&&"string"==typeof t&&(n=JSON.parse(t))}catch(e){}return n||void 0}catch(e){}},setItem:function(e,t){try{var n="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,n)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(e){return!1}}()},pd=function(){function e(e,t){this._storage=t&&"session"===t?fd:!e&&hd.isSupportLS?hd:new dd}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,n,o){this._storage.setCookie(e,t,n,o)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),gd={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},_d="/v1/user/webid",md="/v1/list",vd="4.1.54",bd=4001,yd=4e3,kd=4002,wd=4003,Ed=500,Sd=5005,Td=function(e,t){return t?"__tea_cache_tokens_"+e:"__tea_cache_events_"+e},Id={cn:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},Od="__rangers_ab_style__";function Cd(e,t,n,o,r,i,a){try{var s=new XMLHttpRequest,c=a||"POST";s.open(c,""+e,!0),s.setRequestHeader("Content-Type","application/json; charset=utf-8"),r&&s.setRequestHeader("X-MCS-AppKey",""+r),s.onload=function(){if(n){var e=null;if(s.responseText){try{e=JSON.parse(s.responseText)}catch(t){e={}}n(e,t)}}};try{i&&(s.timeout=i),i&&(s.ontimeout=function(){o&&o(t,Sd)}),s.onerror=function(){s.abort(),o&&o(t,Ed)},s.send(JSON.stringify(t))}catch(e){}}catch(e){}}var Ld=function(e,t,n,o){try{var r,i=e.match(/\/v\d\//);r=i?i[0]:-1!==e.indexOf("/v1/")?"/v1/":"/v2/";var a=e.split(r)[0];if(!a)return void o(e,t,bd);t.forEach((function(r){var i=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&void 0!==e[n]&&(t+="&"+n+"="+encodeURIComponent(JSON.stringify(e[n])));return"&"===t[0]?t.slice(1):t}(r),s=new Image(1,1);s.onload=function(){s=null,n&&n()},s.onerror=function(){s=null,o&&o(e,t,yd)},s.src=a+"/v1/gif?"+i}))}catch(n){o&&o(e,t,kd,n.message)}},Rd=function(e,t,n,o,r,i,a,s,c){var l=window.navigator.userAgent,u=-1!==window.navigator.appName.indexOf("Microsoft Internet Explorer")&&(-1!==l.indexOf("MSIE 8.0")||-1!==l.indexOf("MSIE 9.0")),d=!!o;if(!d&&u)Ld(e,n,r,i);else if(!d&&s)return window.navigator&&window.navigator.sendBeacon?(c&&c(),void(window.navigator.sendBeacon(e,JSON.stringify(n))?r():i(e,n,wd))):void Ld(e,n,r,i);a&&delete n.app_key,Cd(e,n,r,i,o,t)};function Nd(e){return e?(e^16*Math.random()>>e/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,Nd)}var Ad=function(){return Nd().replace(/-/g,"").slice(0,19)},xd=function(e){return function(e,t,n){if("string"==typeof e&&"number"==typeof n){var o,r=[];n=n<=25?n:n%25;var i=String.fromCharCode(n+97);o=e.split(i);for(var a=0;a<o.length;a++){var s=parseInt(o[a],n);s=1*s^64;var c=String.fromCharCode(s);r.push(c)}return r.join("")}}(e,0,25)},Dd=function(){function e(e,t,n,o){this.config=e,this.cfg=t,this.storage=new pd(!1),this.appInfo=e.app_key||e.app_id,this.isNoWebid=e.disable_webid,this.isNoSsid=e.disable_webid||e.disable_ssid,this.domain=e.channel_domain||xd(gd[e.channel]),this.tokenReady=!1,this.checkExp=e.checkExp||!1,this.enableCookie=e.cross_subdomain||!1,this.expiresTime=this.enableCookie?94608e6:0,this.fetchUrl=""+this.domain+_d,this.uuidQueue=[],this.sendQueue=[],this.hook=n,this.cookieDomain=e.cookie_domain||"",this.session=o}return e.prototype._getToken=function(){this.tokensKey=Td(this.appInfo,!0),this.cookieKey="__tea_cookie_tokens_"+this.appInfo;try{var e=this.storage.getItem(this.tokensKey);if(this.enableCookie){var t=this.storage.getCookie(this.cookieKey,this.cookieDomain);if(t){t=decodeURIComponent(t);var n=(t=JSON.parse(t)).user_unique_id,o=t.web_id,r=t.timestamp,i=t.ssid;this._setToken(o,n,i,r)}else{if(!e)return void this._requestWebId();this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(e)),this.expiresTime,this.cookieDomain),this._checkLocal(e)}}else{if(!e)return void this._requestWebId();this._checkLocal(e)}}catch(e){}},e.prototype._checkLocal=function(e){if(!e.web_id){var t=this.storage.getCookie("tt_webid"),n=this.storage.getCookie("__tea_sdk__ssid"),o=this.storage.getCookie("__tea_sdk__user_unique_id");if(t&&n&&o){var r={web_id:t,ssid:n,user_unique_id:o,timestamp:Date.now()};this.storage.setItem(this.tokensKey,r)}}var i=this.storage.getItem(this.tokensKey),a=(o=i.user_unique_id,t=i.web_id,i.timestamp);n=i.ssid,t&&o?this._setToken(t,o,n,a):this._requestWebId()},e.prototype._setToken=function(e,t,n,o){if(this.uuid=t,this.web_id=e,this.ssid=n,this.checkExp){var r=Date.now()-parseFloat(o);if(r>7344e6)return void this._requestWebId();if(r>432e7)return void this._updateWebId(e)}this._complete(e,t,n)},e.prototype._complete=function(e,t,n){this.cfg.envInfo.user.ssid=n,this.cfg.envInfo.user.web_id=e,this.cfg.envInfo.user.user_unique_id=t,this.tokenReady=!0},e.prototype._requestWebId=function(){this.isNoWebid?this._setTokenId(Ad(),"","",!0):this._fetchWebId(this.fetchUrl,!1)},e.prototype._updateWebId=function(e){var t=""+this.domain+_d+"/"+e+"/update";this._fetchWebId(t,!0)},e.prototype._fetchWebId=function(e,t){var n=this;this.isGetWebId=!0,Rd(e,5e3,{app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""},this.config.app_key,(function(e){n.isGetWebId=!1,e&&0===e.e?(n.web_id=e.web_id,n.uuidQueue.length?n._requestSsId(n.uuidQueue[0]):n._setTokenId(e.web_id,"",t?n.ssid:e.ssid,!0)):(n.hook.emit("token-error"),console.warn("[]appid: "+n.config.app_id+", get webid error, init error~"))}),(function(){n.isGetWebId=!1,n.hook.emit("token-error"),console.warn("[]appid: "+n.config.app_id+", get webid error, init error~")}),!0)},e.prototype._setTokenId=function(e,t,n,o){var r=this.cfg.envInfo.user.web_id||e,i={web_id:r,ssid:n,user_unique_id:t||r,timestamp:Date.now()};this.enableCookie&&this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(i)),this.expiresTime,this.cookieDomain),this.storage.setItem(this.tokensKey,i),this.cfg.envInfo.user.ssid=n,this.cfg.envInfo.user.web_id=r,this.cfg.envInfo.user.user_unique_id=t||r,this.uuid=t||r,this.web_id=r,this.ssid=n,o&&(this.tokenReady=!0,this.hook.emit("token-ready"))},e.prototype._getSsid=function(e){e&&-1===["0","Null","None","","undefined"].indexOf(e)&&this.uuid!==e&&(this.uuidQueue.push(e),this.uuid=e,this.cfg.envInfo.user.user_unique_id=e,-1===this.uuidQueue.indexOf(e)&&this.uuidQueue.push(e),this.isNoSsid||this.isGetWebId||(this.tokenReady=!1,this._requestSsId(e),this.sendQueue.push(e)),this.session._resetSessionId())},e.prototype._requestSsId=function(e){var t=this;if(!this.sendQueue.length){var n=this.domain+"/v1/user/ssid";Rd(n,5e3,{app_key:this.config.app_key,app_id:this.config.app_id,web_id:this.web_id,user_unique_id:e},this.config.app_key,(function(n){t.sendQueue=[],t.uuidQueue.length&&t.uuidQueue.splice(t.uuidQueue.indexOf(e),1),n&&0===n.e?(t._setTokenId(t.web_id,e,n.ssid,0===t.uuidQueue.length),t.uuidQueue.length&&t._requestSsId(t.uuidQueue[0])):(t.tokenReady=!0,t.hook.emit("token-ready"),console.warn("[]appid: "+t.config.app_id+", get ssid error"))}),(function(){t.tokenReady=!0,t.hook.emit("token-ready")}),!0)}},e.prototype.isTokenReady=function(){return this.tokenReady},e}(),Bd=function(e){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)},Pd=function(e,t,n){void 0===e&&(e=[]),void 0===t&&(t=function(e){return e}),void 0===n&&(n=20);var o,r=[],i=0;return e.forEach((function(e){var a=t(e);void 0===o?o=a:(a!==o||r[i].length>=n)&&(i+=1,o=a),r[i]=r[i]||[],r[i].push(e)})),r},zd=function(){function e(e,t,n,o,r,i,a){this.collect=e,this.cfg=n,this.config=t,this._token=o,this.appInfo=t.app_id||t.app_key,this.debugMode=!!t.log,this.evtDataKey=Td(this.appInfo,!1);var s=t.channel_domain||xd(gd[t.channel]);if(this.reportUrl=t.report_url?t.report_url:""+s+md,this.storage=new pd(!0),this.EventStorage=new pd(!1),this.maxStorage=t.max_storage_num||-1,this.maxReport=t.max_report||10,this.reportTime=t.reportTime||30,this.timeout=t.timeout||1e5,this.closeStorage=!0,this.plugin=r,this.session=i,this.filter=a,this.plugin){var c=t.enable_storage,l=t.disable_storage;(c||!1===l)&&(this.closeStorage=!1)}this.addListener()}return e.prototype.addListener=function(){var e=this;window.addEventListener("unload",(function(){e.report(!0)}),!1),Bd((function(){e.report(!0)})),document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e.report(!0)}),!1)},e.prototype.setReady=function(){this.isReady=!0,this.closeStorage||this.checkStorageEvent(),this.report()},e.prototype.event=function(e){var t=this;void 0===e&&(e=[]);try{var n=cd(e,this.storage.getItem(this.evtDataKey)||[]);this.storage.setItem(this.evtDataKey,n),this.reportTimer&&clearTimeout(this.reportTimer),n.length>=this.maxReport?this.report(!1):this.reportTimer=setTimeout((function(){t.report(!1),t.reportTimer=null}),this.reportTime)}catch(e){}},e.prototype.beconEvent=function(e){void 0===e&&(e=[]);var t=this._mergeEvents(e);this._dealData(t,!0)},e.prototype.report=function(e){if(void 0===e&&(e=!1),!this.collect.destroyInstance&&this._token.isTokenReady()&&this.isReady){var t=this.storage.getItem(this.evtDataKey)||[],n=this._mergeEvents(t);this.storage.removeItem(this.evtDataKey),this._dealData(n,e)}},e.prototype._mergeEvents=function(e){var t=this;if(!e.length)return e;var n=this.cfg.get();return n.header.custom=JSON.stringify(n.header.custom),Pd(e,(function(e){return!t.closeStorage&&!!e.params.__disable_storage__}),this.maxReport).map((function(e){return ad({events:e.map((function(e){try{if(e.event&&"applog_trace"!==e.event){var n=ad({},t.cfg.get("evtParams"),e.params);delete n.__disable_storage__;var o=[];return t.plugin&&t.plugin.ab&&t.plugin.ab.versions&&t.plugin.ab.extVersions&&(o=[],o=t.config.enable_multilink||-1!==window.location.href.indexOf("multilink=true")?t.plugin.ab.mulilinkVersions.concat(t.plugin.ab.extVersions):t.plugin.ab.versions.concat(t.plugin.ab.extVersions)),ad({},e,{params:JSON.stringify(n),ab_sdk_version:o.join(","),session_id:t.session._getSessionId()})}return ad({},e,{params:JSON.stringify(e.params)})}catch(t){return ad({},e,{params:JSON.stringify(e.params)})}})),user:n.user,header:n.header},t.closeStorage?{}:{__disable_storage__:e[0].params.__disable_storage__},{verbose:t.debugMode?1:void 0,local_time:parseInt(""+(new Date).getTime()/1e3)})}))},e.prototype._dealData=function(e,t){var n=this;if(!e.length)return e;var o=[];o=Pd(e,(function(e){return!!e.__disable_storage__}),this.maxReport),!this.closeStorage&&this.plugin.maxStorage&&this.plugin.maxStorage(o,this.maxStorage,this.evtDataKey,this.storage);var r={};o.forEach((function(e){var o=Ad(),i=e;try{n.filter&&(i=n.filter(e))}catch(e){}if(!n.closeStorage&&!e[0].__disable_storage__){var a=JSON.parse(JSON.stringify(e));a&&a[0]&&(a[0].header.__storage_index__=Date.now()),r[o]=a,n.EventStorage.setItem(n.evtDataKey,r)}n._send(o,i,t)}))},e.prototype._send=function(e,t,n){var o=this;this.isSending=!0;var r=function(){o.isSending=!1};if(!this.closeStorage)try{t&&t[0]&&t[0].header.__storage_index__&&delete(t=JSON.parse(JSON.stringify(t)))[0].header.__storage_index__}catch(e){}this.plugin&&this.plugin.et_test&&this.plugin.et_test.send(t),Rd(this.reportUrl,this.timeout,t,this.config.app_key,(function(t,n){if(r(),o.plugin&&!o.closeStorage){var i=o.EventStorage.getItem(o.evtDataKey)||{};Object.keys(i).length?(delete i[e],o.EventStorage.setItem(o.evtDataKey,i)):o.EventStorage.removeItem(o.evtDataKey)}t&&0!==t.e&&o.collect&&o.collect.tracer&&1!==o.cfg.staging&&o.collect.tracer.addErrorCount(n,"f_data",t.e,t)}),(function(e,t){r(),o.cfg.get("reportErrorCallback")(e,t),o.collect&&o.collect.tracer&&1!==o.cfg.staging&&o.collect.tracer.addErrorCount(e,"f_net",t),o.plugin&&o.plugin.monitor&&o.plugin.monitor.sdkError(o.config.app_key,o.reportUrl,e,t)}),!1,n,r),this.plugin&&this.plugin.monitor&&this.plugin.monitor.sdkOnload(this.config.app_key,this.reportUrl,t)},e.prototype.checkStorageEvent=function(){var e=this;try{var t=this.EventStorage.getItem(this.evtDataKey)||{},n=Object.keys(t);n.length>0&&setTimeout((function o(){for(var r=[],i=0;i<e.maxReport;i++)n.length>0&&r.push(n.shift());r.length>0&&r.forEach((function(n){e._send(n,t[n],!1)})),setTimeout(o,5)}),5)}catch(e){}},e}(),Md=void 0,jd=(new Date).getTimezoneOffset(),Ud=parseInt(""+-jd/60,10),Vd=60*jd,Hd=function(){function e(e,t,n){this.cookieDomain=t.cookie_domain||"",this.initConfig=t;var o=function(e,t){var n,o,r=function(e){var t=document.createElement("a");return t.href=e,t},i=window.screen.width,a=window.screen.height,s=window.navigator.appVersion,c=window.navigator.userAgent,l=window.navigator.language,u=document.referrer,d=u?r(u).hostname:"",h=function(e){var t=r(e).search;t=t.slice(1);var n={};return t.split("&").forEach((function(e){var t,o,r=e.split("=");r.length&&(t=r[0],o=r[1]);try{n[t]=decodeURIComponent(void 0===o?"":o)}catch(e){n[t]=o}})),n}(window.location.href),f="",p="",g="",_=""+parseFloat(s);-1!==(n=c.indexOf("Opera"))&&(g="Opera",_=c.substring(n+6),-1!==(n=c.indexOf("Version"))&&(_=c.substring(n+8))),-1!==(n=c.indexOf("Edge"))?(g="Microsoft Edge",_=c.substring(n+5)):-1!==(n=c.indexOf("MSIE"))?(g="Microsoft Internet Explorer",_=c.substring(n+5)):-1!==(n=c.indexOf("Lark"))?(g="Lark",_=c.substring(n+5,n+11)):-1!==c.indexOf("Chrome")?-1!==(n=c.indexOf("MicroMessenger"))?(g="weixin",_=c.substring(n+15,n+20)):-1!==(n=c.indexOf("MQQBrowser"))?(g="qqbrowser",_=c.substring(n+11,n+15)):-1!==(n=c.indexOf("360"))?(g="360browser",_=c.substring(c.indexOf("Chrome")+7)):-1!==c.indexOf("baidubrowser")||-1!==c.indexOf("BIDUBrowser")?(-1!==c.indexOf("baidubrowser")?(n=c.indexOf("baidubrowser"),_=c.substring(n+13,n+16)):-1!==c.indexOf("BIDUBrowser")&&(n=c.indexOf("BIDUBrowser"),_=c.substring(n+12,n+15)),g="baidubrowser"):-1!==(n=c.indexOf("xiaomi"))?-1!==c.indexOf("openlanguagexiaomi")?(g="openlanguage xiaomi",_=c.substring(n+7,n+13)):(g="xiaomi",_=c.substring(n-7,n-1)):-1!==(n=c.indexOf("TTWebView"))?(g="TTWebView",_=c.substring(n+10,n+23)):-1!==(n=c.indexOf("Chrome"))&&(g="Chrome",_=c.substring(n+7)):-1!==c.indexOf("Safari")?-1!==(n=c.indexOf("QQ"))?(g="qqbrowser",_=c.substring(n+10,n+16)):-1!==(n=c.indexOf("Safari"))&&(g="Safari",_=c.substring(n+7),-1!==(n=c.indexOf("Version"))&&(_=c.substring(n+8))):-1!==(n=c.indexOf("Firefox"))?(g="Firefox",_=c.substring(n+8)):-1!==(n=c.indexOf("MicroMessenger"))?(g="weixin",_=c.substring(n+15,n+20)):-1!==(n=c.indexOf("QQ"))&&(g="qqbrowser",_=c.substring(n+3,n+8)),-1!==(o=_.indexOf(";"))&&(_=_.substring(0,o)),-1!==(o=_.indexOf(" "))&&(_=_.substring(0,o)),-1!==(o=_.indexOf(")"))&&(_=_.substring(0,o));for(var m,v,b=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(s)?"wap":"web",y=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],k=0;k<y.length;k++){var w=y[k];if(w.r.test(c)){f=w.s;break}}function E(e,t){var n=e.exec(t);return n&&n[1]?n[1]:""}switch(/Windows/.test(f)&&(p=E(/Windows (.*)/,f),f="windows"),f){case"Mac OS X":m=c,p=(v=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?)","i").exec(m))?v.slice(1)[0]:"",f="mac";break;case"Android":p=function(e){var t=E(/Android ([\.\_\d]+)/,e);return t||(t=E(/Android\/([\.\_\d]+)/,e)),t}(c),f="android";break;case"iOS":p=(p=/OS (\d+)_(\d+)_?(\d+)?/.exec(s))?p[1]+"."+p[2]+"."+(0|p[3]):"",f="ios"}var S=function(e,t,n){var o=new pd(!1),r=new pd(!1,"session"),i=e?"_tea_utm_cache_"+e:"_tea_utm_cache",a=e?"_$utm_from_url_"+e:"_$utm_from_url",s={},c=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],l={utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4};try{var u=!1;for(var d in l)l[d]&&(-1!==c.indexOf(d)?(s.hasOwnProperty("tracer_data")||(s.tracer_data={}),s.tracer_data[d]=l[d]):s[d]=l[d],u=!0);if(u)r.setItem(a,"1"),o.setCookie(i,JSON.stringify(s),7776e6,n);else{var h=o.getCookie(i,n);h&&(s=JSON.parse(h))}r.getItem(a)&&(s.hasOwnProperty("tracer_data")||(s.tracer_data={}),s.tracer_data.$utm_from_url=1)}catch(e){return l}return s}(e,h,t);return{browser:g,browser_version:_,platform:b,os_name:f,os_version:p,userAgent:c,screen_width:i,screen_height:a,device_model:function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach((function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))}));else if("ios"===e||"mac"===e||"windows"===e){var n=navigator.userAgent.replace("Mozilla/5.0 (",""),o=n.indexOf(";");t=n.slice(0,o)}}catch(e){}return t.trim()}(f),language:l,referrer:u,referrer_host:d,utm_source:S.utm_source,utm_medium:S.utm_medium,utm_campaign:S.utm_campaign,utm_term:S.utm_term,utm_content:S.utm_content,tracer_data:S.tracer_data}}(e,this.cookieDomain);this.configKey=function(e){return"__tea_cache_config_"+e}(""+e),this.sessionStorage=new pd(!1,"session"),this.localStorage=new pd(!1,"local"),n&&(this.storage=1===n?this.sessionStorage:this.localStorage),this.envInfo={user:{user_unique_id:Md,user_type:Md,user_id:Md,user_is_auth:Md,user_is_login:Md,device_id:Md,web_id:Md,ip_addr_id:Md,ssid:Md},header:{app_id:Md,app_name:Md,app_install_id:Md,install_id:Md,app_package:Md,app_channel:Md,app_version:Md,os_name:o.os_name,os_version:o.os_version,device_model:o.device_model,ab_client:Md,ab_version:Md,ab_sdk_version:Md,traffic_type:Md,client_ip:Md,device_brand:Md,os_api:Md,access:Md,language:o.language,region:Md,app_language:Md,app_region:Md,creative_id:Md,ad_id:Md,campaign_id:Md,log_type:Md,rnd:Md,platform:o.platform,sdk_version:vd,sdk_lib:"js",province:Md,city:Md,timezone:Ud,tz_offset:Vd,tz_name:Md,sim_region:Md,carrier:Md,resolution:o.screen_width+"x"+o.screen_height,browser:o.browser,browser_version:o.browser_version,referrer:o.referrer,referrer_host:o.referrer_host,width:o.screen_width,height:o.screen_height,screen_width:o.screen_width,screen_height:o.screen_height,utm_term:o.utm_term,utm_content:o.utm_content,utm_source:o.utm_source,utm_medium:o.utm_medium,utm_campaign:o.utm_campaign,tracer_data:JSON.stringify(o.tracer_data),custom:{}}},this.evtParams={},this.reportErrorCallback=function(){}}return e.prototype.set=function(e,t){var n=this;if(null==t&&(this.delete(e),t=void 0),"evtParams"===e||"_staging_flag"===e){var o;o="evtParams"===e?t:{_staging_flag:Number(t)};var r=ad({},o);Object.keys(r).forEach((function(e){n.evtParams[e]=r[e]}))}else if("reportErrorCallback"===e&&"function"==typeof t)this.reportErrorCallback=t;else{var i="";if(e.indexOf(".")>-1){var a=e.split(".");i=a[0],e=a[1]}if("user_unique_id"===e){if(!t)return;if(-1!==["0","Null","None","","undefined"].indexOf(t))return}if("os_version"===e&&(e=""+t),"web_id"===e){if(!t)return;(!this.envInfo.user.user_unique_id||this.envInfo.user.user_unique_id&&this.envInfo.user.user_unique_id===this.envInfo.user.web_id)&&(this.envInfo.user.user_unique_id=t)}i?"user"===i||"header"===i?this.envInfo[i][e]=t:this.envInfo.header.custom[e]=t:this.envInfo.user.hasOwnProperty(e)?["user_type","ip_addr_id"].indexOf(e)>-1?this.envInfo.user[e]=t?Number(t):t:["user_id","web_id","user_unique_id","ssid"].indexOf(e)>-1?this.envInfo.user[e]=t?String(t):t:["user_is_auth","user_is_login"].indexOf(e)>-1?this.envInfo.user[e]=Boolean(t):"device_id"===e&&(this.envInfo.user[e]=t):this.envInfo.header.hasOwnProperty(e)?this.envInfo.header[e]=t:this.envInfo.header.custom[e]=t}},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){console.log("get config stringify error ")}},e.prototype.setStore=function(e){try{var t=this.storage.getItem(this.configKey);if(Object.keys(e).length){var n=Object.assign(e,t);this.storage.setItem(this.configKey,n)}}catch(e){}},e.prototype.getStore=function(){try{var e=this.storage.getItem(this.configKey);return Object.keys(e).length?e:null}catch(e){return null}},e.prototype.delete=function(e){try{var t=this.storage.getItem(this.configKey);t&&t.hasOwnProperty(e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){}},e}(),Fd=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}var t=e.prototype;return t.info=function(e){this.isLog&&console.log("["+this.name+"] "+e)},t.warn=function(e){this.isLog&&console.warn("["+this.name+"] "+e)},t.error=function(e){this.isLog&&console.error("["+this.name+"] "+e)},t.throw=function(e){throw this.error(this.name),new Error(e)},e}(),Kd=function(){function e(){this._hooks={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var n=this;e&&t&&"function"==typeof t&&this.on(e,(function o(r){t(r),n.off(e,o)}))},e.prototype.off=function(e,t){if(e&&this._hooks[e]&&this._hooks[e].length)if(t){var n=this._hooks[e].indexOf(t);-1!==n&&this._hooks[e].splice(n,1)}else this._hooks[e]=[]},e.prototype.emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&cd(this._hooks[e]).forEach((function(e){try{e(t)}catch(e){}}))},e}(),Gd=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},Jd=function(){function e(e,t){this.storage=new pd(!1,"session"),this.sessionKey=function(e){return"__tea_session_id_"+e}(e),this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSession||this._setSessionId()}return e.prototype._updateSessionId=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=e.timestamp;Date.now()-t>this.expireTime?e={sessionId:Gd(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this._resetExpTime()}},e.prototype._setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:Gd(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.sessionExp=setInterval((function(){e._checkEXp()}),this.expireTime)},e.prototype._getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return this.disableSession?"":e&&e.sessionId?e.sessionId:""},e.prototype._resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval((function(){e._checkEXp()}),this.expireTime))},e.prototype._resetSessionId=function(){var e={sessionId:Gd(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,e)},e.prototype._checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:Gd(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))},e}(),qd={pv:["predefine_pageview"],sdk:["_be_active","predefine_page_alive","predefine_page_close","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append"],autotrack:["bav2b_click","bav2b_page","bav2b_beat","bav2b_page_statistics","__bav_click","__bav_page","__bav_beat","__bav_page_statistics"]},Wd=function(){function e(e,t,n,o){this.count={pv:0,sdk:0,autotrack:0,log:0},this.limit={pv:1,sdk:10,autotrack:10,log:3},this.errorCode={f_net:0,f_data:0},this.errorInfo={pv:{f_net:0,f_data:0},sdk:{f_net:0,f_data:0},autotrack:{f_net:0,f_data:0},log:{f_net:0,f_data:0}},this.collect=e,this.disable_tracer=t.disable_tracer||t.channel_domain,this.ready=!(!t.app_id||this.disable_tracer),this.appid=t.app_id,this.process=n,this.event=o;var r=t.channel_domain||xd(gd[t.channel]);this.reportUrl=t.report_url?t.report_url:""+r+md,this.listener()}return e.prototype.addCount=function(e){try{if(!this.ready)return;if(this.count[e]++,this.count[e]>=this.limit[e]){var t=[];for(var n in t=cd(t,this.processTracer(this.count[e],e,"net")),this.errorInfo[e])this.errorInfo[n]&&(t=cd(t,this.processTracer(this.errorInfo[e][n],e,n)));t.length&&this.sendTracer(t,!0,e,!1)}}catch(e){}},e.prototype.addErrorCount=function(e,t,n,o){var r=this;try{if(!this.ready)return;if(e&&e.length){var i=e[0].events;i&&i.length&&("f_data"===t?(o&&o.hasOwnProperty("sc")?this.errorInfo.log.f_data=i.length-o.sc:this.errorInfo.log.f_data=i.length,this.errorCode.f_data=n):i.forEach((function(e){var t="log";for(var o in qd)if(-1!==qd[o].indexOf(e.event)){t=o;break}r.errorInfo[t].f_net++,r.errorCode.f_net=n})))}}catch(e){}},e.prototype.clearCount=function(e){try{e?(this.count[e]=0,this.errorInfo[e]={f_net:0,f_data:0}):(this.count={pv:0,sdk:0,autotrack:0,log:0},this.errorInfo={pv:{f_net:0,f_data:0},sdk:{f_net:0,f_data:0},autotrack:{f_net:0,f_data:0},log:{f_net:0,f_data:0}})}catch(e){}},e.prototype.sendTracer=function(e,t,n,o){try{if(!this.ready)return;if(this.collect.staging)return;var r=this.event._mergeEvents(e);o&&window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify(r)):Rd(this.reportUrl,3e5,r,""),t?this.clearCount(n):this.clearCount()}catch(e){}},e.prototype.processTracer=function(e,t,n){try{var o={count:e,state:n,key:t,params_for_special:"applog_trace",aid:this.appid,platform:"web",_staging_flag:1,sdk_version:vd};"f_net"!==n&&"f_data"!==n||(o.errorCode=this.errorCode[n]);var r=[];if(r.push(this.process("applog_trace",o,!0)),r&&r.length)return delete r[0].is_bav,r}catch(e){}},e.prototype.listener=function(){var e=this;this.ready&&(document.addEventListener("visibilitychange",(function(){e.leavePage()})),Bd((function(){e.leavePage()})))},e.prototype.leavePage=function(){if(this.ready)try{var e=[];for(var t in this.count)if(this.count[t]){var n=this.errorInfo[t];for(var o in e=cd(e,this.processTracer(this.count[t],t,"net")),n)n[o]&&(e=cd(e,this.processTracer(n[o],t,o)))}e&&e.length&&this.sendTracer(e,!1,"",!0)}catch(e){}},e}(),$d=function(){function e(e){this.logger=e}var t=e.prototype;return t.bridgeInject=function(){try{return AppLogBridge?(this.logger.info("AppLogBridge is injected"),!0):(this.logger.info("AppLogBridge is not inject"),!1)}catch(e){return this.logger.info("AppLogBridge is not inject"),!1}},t.hasStarted=function(e){var t=this;try{this.bridgeInject()?AppLogBridge.hasStarted((function(n){t.logger.info("AppLogBridge is started? : "+n),e(n)})):e(0)}catch(t){this.logger.info("AppLogBridge, error:"+JSON.stringify(t.stack)),e(0)}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(e){this.logger.error("setUserUniqueId error")}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(e){this.logger.error("addHeaderInfo error")}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(e){this.logger.error("setHeaderInfo error")}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(e){this.logger.error("removeHeaderInfo error")}},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t)}catch(e){this.logger.error("onEventV3 error")}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(e){this.logger.error("profileSet error")}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(e){this.logger.error("profileSetOnce error")}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(e){this.logger.error("profileIncrement error")}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(e){this.logger.error("profileUnset error")}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(e){this.logger.error("profileAppend error")}},e}(),Yd=function(){function e(e,t,n){this.processEvent=e,this._event=t,this.cache={},this.duration=6e4,this.profileReady=!1,this.reportUrl=(n.channel_domain||xd(gd[n.channel]))+"/profile/list"}return e.prototype.start=function(){this.profileReady=!0},e.prototype.report=function(e,t){void 0===t&&(t={});try{var n=[];n.push(this.processEvent(e,t));var o=this._event._mergeEvents(n);Rd(this.reportUrl,3e5,o)}catch(e){}},e.prototype.setProfile=function(e){var t=this._formatParams(e);t&&Object.keys(t).length&&(this._pushCache(t),this.report("__profile_set",ad({},t,{profile:!0})))},e.prototype.setOnceProfile=function(e){var t=this._formatParams(e,!0);t&&Object.keys(t).length&&(this._pushCache(t),this.report("__profile_set_once",ad({},t,{profile:!0})))},e.prototype.incrementProfile=function(e){e?this.report("__profile_increment",ad({},e,{profile:!0})):console.warn("please check the params, must be object!!!")},e.prototype.unsetProfile=function(e){if(e){var t={};t[e]="1",this.report("__profile_unset",ad({},t,{profile:!0}))}else console.warn("please check the key, must be string!!!")},e.prototype.appendProfile=function(e){if(e){var t={};for(var n in e)"string"==typeof e[n]||"Array"===Object.prototype.toString.call(e[n]).slice(8,-1)?t[n]=e[n]:console.warn("please check the value of param: "+n+", must be string or array !!!");Object.keys(t).length&&this.report("__profile_append",ad({},t,{profile:!0}))}else console.warn("please check the params, must be object!!!")},e.prototype._pushCache=function(e){var t=this;Object.keys(e).forEach((function(n){t.cache[n]={val:t._clone(e[n]),timestamp:Date.now()}}))},e.prototype._formatParams=function(e,t){var n=this;void 0===t&&(t=!1);try{if(!e||"[object Object]"!==Object.prototype.toString.call(e))return void console.warn("please check the params type, must be object !!!");var o={};for(var r in e)"string"==typeof e[r]||"number"==typeof e[r]||"Array"===Object.prototype.toString.call(e[r]).slice(8,-1)?o[r]=e[r]:console.warn("please check the value of params:"+r+", must be string,number,Array !!!");var i=Object.keys(o);if(!i.length)return;var a=Date.now();return i.filter((function(o){var r=n.cache[o];return t?!r:!(r&&n._compare(r.val,e[o])&&a-r.timestamp<n.duration)})).reduce((function(e,t){return e[t]=o[t],e}),{})}catch(e){}},e.prototype._compare=function(e,t){try{return JSON.stringify(e)===JSON.stringify(t)}catch(e){return!1}},e.prototype._clone=function(e){try{return JSON.parse(JSON.stringify(e))}catch(t){return e}},e.prototype._unReady=function(){console.warn("sdk is not ready, please use this api after start")},e}();function Qd(e,t,n){return{title:t||document.title||location.pathname,url:n||location.href,url_path:e||location.pathname}}function Xd(){return Date.now()}function Zd(){var e=function(){if("undefined"!=typeof window)return window.TeaAnalyticsObject}();return window[e]?window[e].l:Xd()}function eh(){var e=!1;return["hidden","msHidden","webkitHidden"].forEach((function(t){void 0!==document[t]&&(e=!0)})),e}var th=function(){function e(e,t){var n=this;this._sendEvent=function(e){void 0===e&&(e=!1);var t=e?n.options.aliveDTime:Xd()-n.sessionStartTime;t<0||Xd()-n.pageStartTime>n.options.maxDuration||(n.event("predefine_page_alive",ad({},Qd(n.url_path,n.title,n.url),{duration:t,is_support_visibility_change:n.options.sup_vis_change?1:0,startTime:n.sessionStartTime}),"sdk"),n.sessionStartTime=Xd())},this._setUpTimer=function(){return n.timerHandler&&clearInterval(n.timerHandler),setInterval((function(){Xd()-n.sessionStartTime>n.options.aliveDTime&&n._sendEvent(!0)}),1e3)},this._visibilitychange=function(){"hidden"===document.visibilityState?n.timerHandler&&(clearInterval(n.timerHandler),n._sendEvent()):"visible"===document.visibilityState&&(n.sessionStartTime=Xd(),n.timerHandler=n._setUpTimer())},this._beforeunload=function(){document.hidden||n._sendEvent()},this._wtest=function(){document.getElementById("wtest").innerHTML="visibilitychange"},this._dtest=function(){document.getElementById("dtest").innerHTML="dvisibilitychange"},this.event=e,this.config=t,this.isSupVisChange=eh(),this.options={maxDuration:432e5,aliveDTime:6e4,sup_vis_change:eh()},this.pageStartTime=Zd(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,this.disableCallback=function(){}}return e.prototype.enable=function(e,t,n){this.url_path=e,this.url=n,this.title=t,this.disableCallback=this._enablePageAlive()},e.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now()},e.prototype._enablePageAlive=function(){var e=this;return this.timerHandler=this._setUpTimer(),document.addEventListener("visibilitychange",this._visibilitychange),Bd(this._beforeunload),function(){e._beforeunload(),document.removeEventListener("visibilitychange",e._visibilitychange),window.removeEventListener("beforeunload",e._beforeunload),window.removeEventListener("pagehide",e._beforeunload)}},e}(),nh=function(){function e(e,t){var n=this;this._visibilitychange=function(){"hidden"===document.visibilityState?n.activeEndTime=Xd():"visible"===document.visibilityState&&(n.activeEndTime&&(n.totalTime+=n.activeEndTime-n.activeStartTime,n.activeTimes+=1),n.activeEndTime=void 0,n.activeStartTime=Xd())},this._beforeunload=function(){if(n.totalTime+=(n.activeEndTime||Xd())-n.activeStartTime,n.config.autotrack)try{window.sessionStorage.setItem("_tea_cache_duration",JSON.stringify({duration:n.totalTime,page_title:document.title||location.pathname}))}catch(e){}n._sendEventPageClose()},this.event=e,this.config=t,this.isSupVisChange=eh(),this.options={sup_vis_change:this.isSupVisChange},this.maxDuration=t.maxDuration||864e5,this.disableCallback=function(){},this.pageStartTime=Zd(),this._resetData()}return e.prototype.enable=function(e,t,n){this.url_path=e,this.url=n,this.title=t,this.disableCallback=this._enablePageClose()},e.prototype.disable=function(){this.disableCallback()},e.prototype._resetData=function(){this.activeStartTime=void 0===this.activeStartTime?Zd():Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0},e.prototype._sendEventPageClose=function(){var e=Xd()-this.pageStartTime;this.totalTime<0||e<0||this.totalTime>=this.maxDuration||(this.event("predefine_page_close",ad({},Qd(this.url_path,this.title,this.url),{active_times:this.activeTimes,duration:this.totalTime,total_duration:e,is_support_visibility_change:this.options.sup_vis_change?1:0}),"sdk"),this.pageStartTime=Date.now(),this._resetData())},e.prototype._enablePageClose=function(){var e=this;return document.addEventListener("visibilitychange",this._visibilitychange),Bd(this._beforeunload),function(){e._beforeunload(),document.removeEventListener("visibilitychange",e._visibilitychange),window.removeEventListener("beforeunload",e._beforeunload),window.removeEventListener("pagehide",e._beforeunload)}},e}(),oh=function(){function e(e,t){this.pageAlive=new th(e,t),this.pageClose=new nh(e,t),this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this._enable(this.url_path,this.title,this.url)}return e.prototype._enable=function(e,t,n){this.pageAlive.enable(e,t,n),this.pageClose.enable(e,t,n)},e.prototype._disable=function(){this.pageAlive.disable(),this.pageClose.disable()},e.prototype.reset=function(e,t,n){this._disable(),this._enable(e,t,n)},e}(),rh=function(){function e(e){var t=this;this._setInterval=function(){t._clearIntervalFunc=function(e,t){void 0===e&&(e=function(){}),void 0===t&&(t=1e3);var n,o=Date.now()+t;return n=window.setTimeout((function r(){var i=Date.now()-o;e(),o+=t,n=window.setTimeout(r,Math.max(0,t-i))}),t),function(){window.clearTimeout(n)}}((function(){t._isSessionhasEvent&&t._endCurrentSession()}),t.sessionInterval)},this._clearInterval=function(){t._clearIntervalFunc&&t._clearIntervalFunc()},this.sessionInterval=6e4,this._eventSenderFunc=e,this._startTime=0,this._lastTime=0,this._setInterval()}return e.prototype._endCurrentSession=function(){this._eventSenderFunc("_be_active",{start_time:this._startTime,end_time:this._lastTime,url:window.location.href,referrer:window.document.referrer},"sdk"),this._isSessionhasEvent=!1,this._startTime=0},e.prototype.process=function(){this._isSessionhasEvent||(this._isSessionhasEvent=!0,this._startTime=+new Date);var e=this._lastTime||+new Date;this._lastTime=+new Date,this._lastTime-e>this.sessionInterval&&(this._clearInterval(),this._endCurrentSession(),this._setInterval())},e}(),ih=function(){function e(){}return e.prototype.sdkOnload=function(e,t,n){if(!this.sdkReady){this.sdkReady=!0;try{if(0===n.length)return;var o=n[0],r=o.header,i=o.user,a=r.app_id,s=r.app_name,c=r.sdk_version,l=i.web_id,u={events:[{event:"onload",params:JSON.stringify({app_key:e,app_id:a,app_name:s||"",sdk_version:c}),local_time_ms:Date.now()}],user:{user_unique_id:l},header:{}};setTimeout((function(){Rd(t,3e4,[u],"566f58151b0ed37e")}),16)}catch(e){}}},e.prototype.sdkError=function(e,t,n,o){try{var r=n[0],i=r.user,a=r.header,s=[];n.forEach((function(e){e.events.forEach((function(e){s.push(e)}))}));var c={events:s.map((function(t){return{event:"on_error",params:JSON.stringify({error_code:o,app_key:e,app_id:a.app_id,app_name:a.app_name||"",error_event:t.event,sdk_version:a.sdk_version,local_time_ms:t.local_time_ms,tea_event_index:Date.now(),params:t.params,header:JSON.stringify(a),user:JSON.stringify(i)}),local_time_ms:Date.now()}})),user:{user_unique_id:i.user_unique_id},header:{}};setTimeout((function(){Rd(t,3e4,[c],"566f58151b0ed37e")}),16)}catch(e){}},e}(),ah=new pd(!1),sh=function(e){return"__tea_sdk_ab_version_"+e},ch=function(e){var t={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date};try{t=ah.getItem(sh(e))||t}catch(e){}return t},lh=function(e,t){try{var n=ch(e);ah.setItem(sh(e),ad({},n,t))}catch(e){}},uh=function(e,t,n){void 0===n&&(n=!1);var o=n?{ab_ext_version:t,timestamp:Date.now()}:{ab_version:t,timestamp:Date.now()};lh(e,o)},dh={},hh=[],fh=function(e){e.length&&e.forEach((function(e){hh.push(e)}))};function ph(e,t,n,o){var r=e&&e.source||window.opener||window.parent,i=e&&e.origin||o||"*",a={type:t,payload:n};r.postMessage(JSON.stringify(a),i)}function gh(e,t){dh[e]=dh[e]||[],dh[e].push(t)}function _h(e){if(hh.some((function(e){return"*"===e}))||hh.some((function(t){return e.origin.indexOf(t)>-1}))){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){t=void 0}if(!t)return;var n=t.type,o=t.payload;dh[n]&&dh[n].forEach((function(t){"function"==typeof t&&t(e,o)}))}}function mh(e,t){(window.opener||window.parent).postMessage("[tea-sdk]ready","*"),(window.opener||window.parent).postMessage({type:"tea:sdk:info",config:e,version:t},"*"),window.addEventListener("message",_h,!1)}function vh(e,t,n){var o=document.createElement("script");o.src=e,o.onerror=function(){n(e)},o.onload=function(){t()},document.getElementsByTagName("head")[0].appendChild(o)}window.TEAVisualEditor=window.TEAVisualEditor||{};var bh="",yh=!1;function kh(e){var t=e.event,n=e.editorUrl;e.collectInstance,e.fromSession,yh||(yh=!0,vh(n,(function(){ph(t,"abEditorScriptloadSuccess")}),(function(){t&&ph(t,"abEditorScriptloadError"),yh=!1})))}var wh,Eh,Sh=xd("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1jz1mz18z1bz1cz20z4az1hz21")+"?query="+Date.now();!function(e){e[e.No=0]="No",e[e.Ing=1]="Ing",e[e.Complete=2]="Complete"}(wh||(wh={})),function(e){e[e.Var=0]="Var",e[e.All=1]="All"}(Eh||(Eh={}));var Th=function(){function e(e,t,n){this.appId=0,this.user={},this.header={},this.domain="",this.protocal=location.protocol,this.fetchStatus=wh.No,this.callbacks=[],this.data=null,this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.collector=e;var o=this.collector._initConfig,r=o.app_id,i=o.channel,a=o.enable_multilink,s=o.multilink_timeout_ms,c=o.ab_channel_domain,l=o.channel_domain,u=o.enable_ab_visual,d=o.ab_timeout;if(this.appId=r,this.timeout=d||3e3,this.domain=c||xd(Id[i||"cn"]),this.domain){this.needOverlay=a||u||!1,this.enable_ab_visual=u,this.enable_multilink=a,this.closeTime=s||500,this.Hook=t;var h=l||xd(gd[i]);if(this.reportUrl=""+h+md,u){!function(e,t,n,o){fh(["*"]);var r,i="";mh(o,vd);var a="";try{var s=window.performance.getEntriesByType("resource");if(s&&s.length&&(s.forEach((function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(a=e.name)})),a||document.currentScript&&(a=document.currentScript.src),a&&(r=a.split("/"))&&r.length)){i="https:/";for(var c=2;c<r.length&&c!==r.length-1;c++)i=i+"/"+r[c];i+="/visual-ab-core"}}catch(e){}gh("tea:openVisualABEditor",(function(o){var r=o.data;if("string"==typeof o.data)try{r=JSON.parse(o.data)}catch(e){r=void 0}if(r){var a=r.lang;if(r.appId!==t)return ph(o,"appIdError"),void console.error("abtest appid is not belong the page appid please check");var s=r.version;bh=s&&i?i+(s?"."+s:".1.0.1")+".js?query="+Date.now():xd("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1az1mz20z1cz4az1hz21")+"?query="+Date.now(),window.TEAVisualEditor.lang=a,n&&(window.TEAVisualEditor.__ab_domin=n),kh({event:o,editorUrl:bh,collectInstance:e})}}))}(e,this.appId,c||"",n);var f=function(){try{var e=JSON.parse(atob(window.name));return e&&e.href?e.href:""}catch(e){return""}}();if(f&&(-1!==f.indexOf("datatester")||-1!==f.indexOf("visual-editor")))return console.log("edit mode"),void this.collector.destroy()}a&&function(e,t,n,o){window.TEAVisualEditor.appId=t,gh("tea:openTesterEventInspector",(function(t){var n=t.data;if("string"==typeof t.data)try{n=JSON.parse(t.data)}catch(e){n=void 0}if(n){var o=n.referrer,r=n.lang,i=n.appId;window.TEAVisualEditor.__editor_ajax_domain=o||"",window.TEAVisualEditor.__ab_appId=i||"",window.TEAVisualEditor.lang=r||"",kh({event:t,editorUrl:xd("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz22z1cz21z22z1cz20z4bz21z1bz1iz4bz22z1cz21z22z1cz20z49z1cz24z1cz1lz22z49z1gz1lz21z1nz1cz1az22z1mz20z4az1hz21")+"?query="+Date.now(),collectInstance:e})}}))}(e,this.appId),this._check(),this.wait()}else console.warn("sorry you env is not support abtest yet~")}return e.prototype.init=function(e,t){if(!this.collector.destroyInstance)if(this.domain){this.config=e;var n=e.user,o=e.header,r=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&(n[o[r]]=e[o[r]])}return n}(o,[]);this.user=ad({},n),this.header=ad({},o),this._fetch(ad({},r),{success:t,fail:t})}else console.warn("sorry you env is not support abtest yet~")},e.prototype._check=function(){var e=this,t=function(e){var t=ch(e),n=t.timestamp;if(Date.now()-n>=2592e6){try{ah.removeItem("__tea_sdk_ab_version")}catch(e){}return null}return t}(this.appId);if(t){var n=t.ab_version,o=t.data,r=t.ab_ext_version,i=t.ab_version_multilink;this.mulilinkVersions=i||[],this.extVersions=r,n&&n.length&&(this.versions=n,this.data=o,setTimeout((function(){e._configVersions()})))}},e.prototype.wait=function(){var e=this;this.needOverlay&&(this.isWait||(this.openOverlayer(),this.isWait=!0),setTimeout((function(){e.closeOverlayer()}),this.closeTime))},e.prototype.getAllVars=function(e){if("function"!=typeof e)throw new Error("callback must be a function");var t={callback:e,type:Eh.All};this.fetchStatus===wh.Complete?this._getAllVars(t):this.callbacks.push(t)},e.prototype._getAllVars=function(e){(0,e.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{})},e.prototype.getVids=function(){try{var e=ch(this.appId).ab_version,t="";return e&&e.length&&(t=e.join(",")),t}catch(e){return""}},e.prototype.getAbSdkVersion=function(e){e(this.getVids())},e.prototype.getVar=function(e,t,n){if(!e)throw new Error("variable must not be empty");if(void 0===t)throw new Error("variable no default value");if("function"!=typeof n)throw new Error("callback must be a function");var o={name:e,defaultValue:t,callback:n,type:Eh.Var};if(this.fetchStatus===wh.Complete){this._getVar(o,e);try{this.Hook.emit("onAbSdkVersionChange",this.getVids())}catch(e){}}else this.callbacks.push(o)},e.prototype._getVar=function(e,t){var n=e.name,o=e.defaultValue,r=e.callback,i=this.data;if(i){if("object"==typeof i[n]&&void 0!==i[n].val){var a=i[n].vid;return"$ab_url"===t?(-1===this.mulilinkVersions.indexOf(a)&&this.mulilinkVersions.push(a),this._updateMultilinkVersions()):(-1===this.versions.indexOf(a)&&this.versions.push(a),this._updateVersions()),this._abEvent(a,t,o),void r(i[n].val)}r(o)}else r(o)},e.prototype._abEvent=function(e,t,n){var o=this;try{if(e){var r={event:"abtest_exposure",ab_sdk_version:""+e,params:JSON.stringify({app_id:this.appId,ab_url:"$ab_url"===t?n:window.location.href}),local_time_ms:Date.now()},i=this.collector._config.get(),a=i.header,s=i.user;a.ab_sdk_version=""+e,a.custom=JSON.stringify(a.custom);var c={events:[r],user:s,header:a};"$ab_url"===t?window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify([c])):Rd(this.reportUrl,2e4,[c],""):setTimeout((function(){Rd(o.reportUrl,2e4,[c],"")}),16)}}catch(e){}},e.prototype.openOverlayer=function(){!function(){if(!document.getElementById(Od)){var e="body { opacity: 0 !important; }",t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.id=Od,n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n)}}()},e.prototype.closeOverlayer=function(){var e;(e=document.getElementById(Od))&&e.parentElement.removeChild(e)},e.prototype._setAbVersion=function(e){this.extVersions=[e],uh(this.appId,this.extVersions,!0)},e.prototype._updateVersions=function(){uh(this.appId,this.versions),this._configVersions()},e.prototype._updateMultilinkVersions=function(){var e,t;e=this.appId,t={ab_version_multilink:this.mulilinkVersions,timestamp:Date.now()},lh(e,t)},e.prototype._configVersions=function(){var e=this.versions.join(",");e&&this.collector.config({ab_sdk_version:e})},e.prototype._getABconfig=function(e,t){var n=Object.keys(e);n&&n.length&&this.collector.config(e),this.init(this.collector._config.get(),t)},e.prototype._fetchComplete=function(e){var t=this;if(e){!function(e,t){lh(e,{data:t})}(this.appId,e),this.data=e;var n=[];Object.keys(e).forEach((function(t){var o=e[t].vid;o&&n.push(o)})),-1!==window.location.href.indexOf("multilink=true")||(this.versions=this.versions.filter((function(e){return-1!==n.indexOf(e)})));var o=e.$ab_url,r=e.$ab_modification;if(r&&r.val&&this.enable_ab_visual){if(this.collector.destroyInstance)return;this.getVar("$ab_modification",window.location.href,(function(){var e;e=r.val,window.TEAVisualEditor.__ab_config=e,vh(Sh,(function(){console.log("load visual render success")}),(function(){console.log("load visual render fail")}))}))}else if(o&&this.enable_multilink){var i=o.val,a=o.vid;i&&a&&this.getVar("$ab_url",i,(function(){var e=window.location.href;-1!==e.indexOf("multilink=true")&&(e=t.filterUrl(e)),i!==e?setTimeout((function(){if(!t.collector.destroyInstance){var e=""+i;-1!==(e=-1===e.indexOf("http")?"https://"+e:e).indexOf("?")?e+="&multilink=true":e+="?multilink=true",window.location.href=e}}),50):t.closeOverlayer()}))}else this.closeOverlayer()}this.callbacks.forEach((function(e){t[e.type===Eh.Var?"_getVar":"_getAllVars"](e,"")})),this.callbacks=[],this._updateVersions();try{this.Hook.emit("onAbSdkVersionChange",this.getVids())}catch(e){}this.isWait||this.closeOverlayer()},e.prototype._fetch=function(e,t){var n=this,o=void 0===t?{}:t,r=o.success,i=void 0===r?function(){}:r,a=o.fail,s=void 0===a?function(){}:a;this.fetchStatus=wh.Ing;var c=this.domain+"/service/2/abtest_config/",l=window.location.href,u=!1;-1!==l.indexOf("multilink=true")&&(l=this.filterUrl(l),u=!0);var d=u?this.mulilinkVersions:this.versions;Cd(c,{header:ad({aid:this.appId},this.user||{},e||{},{ab_sdk_version:d.join(","),ab_url:l})},(function(e){n.fetchStatus=wh.Complete;var t=e.data;"success"===e.message?(n._fetchComplete(t),i(t)):(n._fetchComplete(null),s())}),(function(){n.fetchStatus=wh.Complete,s(),n._fetchComplete(null)}),"",this.timeout)},e.prototype.filterUrl=function(e){try{var t="";-1!==e.indexOf("&multilink=true")?t="&multilink=true":-1!==e.indexOf("?multilink=true")&&(t="\\?multilink=true");var n=new RegExp(t,"g");e=e.replace(n,"")}catch(e){}return e},e}(),Ih=function(e,t,n,o){if(t){var r=e.filter((function(e){return!e[0].__disable_storage__})).length;if(r>0)try{var i=o.getItem(n);if(i){var a=Object.keys(i),s=a.length+r-t;if(s>0){for(var c=a.map((function(e){var t=i[e];return{id:e,index:t&&t[0]?t[0].header.__storage_index__:+new Date}})).sort((function(e,t){return e.index-t.index})),l=0;l<s;l++){var u=c.shift();u&&u.id&&i[u.id]&&delete i[u.id]}o.setItem(n,i)}}}catch(e){}}},Oh=function(){function e(e){"string"==typeof e.event_verify_url?this.url=e.event_verify_url+"/v1/list_test":console.log("please use correct et_test url")}return e.prototype.send=function(e){this.url&&Rd(this.url,3e4,e)},e}(),Ch=function(e,t,n,o,r){t&&(t.enable_stay_duration&&(this.stay=new oh(o,t)),t.disable_session||(this.session=new rh(n)),t.channel_domain||t.disable_sdk_monitor||(this.monitor=new ih),t.event_verify_url&&(this.et_test=new Oh(t)),t.enable_ab_test&&(this.ab=new Th(e,r,t)),t.max_storage_num&&(this.maxStorage=Ih))};function Lh(e,t){if(void 0===t&&(t="list"),!e)return!1;if(t&&"list"===t){if(["LI","TR","DL"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaIdx"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-idx"))return!0}else{if(["A","BUTTON"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaContainer"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-container"))return!0}return!1}function Rh(e){for(var t=e;t&&!Lh(t,"container");){if("HTML"===t.nodeName||"BODY"===t.nodeName)return e;t=t.parentElement}return t||e}function Nh(e){var t="";return 3===e.nodeType?t=e.textContent.trim():e.dataset&&e.dataset.hasOwnProperty("teaTitle")||e.hasAttribute("ata-tea-title")?t=e.getAttribute("data-tea-title"):e.hasAttribute("title")?t=e.getAttribute("title"):"INPUT"===e.nodeName&&["button","submit"].includes(e.getAttribute("type"))?t=e.getAttribute("value"):"IMG"===e.nodeName&&e.getAttribute("alt")&&(t=e.getAttribute("alt")),t.slice(0,200)}var Ah,xh;function Dh(e,t,n){void 0===t&&(t=""),void 0===n&&(n={});var o=e;"/"===(o=o.split("#")[0].split("?")[0])[e.length-1]&&(o=o.substr(0,e.length-1)),o="/"===t[0]?o.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?)(\/[.\w-]+)*\/?$/,"$1"+t):o.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?(\/[.\w-]+)*?)(\/[.\w-]+)?\/?$/,"$1/"+t);var r=Object.keys(n).map((function(e){return e+"="+n[e]})).join("&");return r.length>0?o+"?"+r:o}function Bh(){var e="";try{e=document.referrer?document.referrer:xh.getItem("__tea_cache_refer_key")===location.href?"":xh.getItem("__tea_cache_refer_key")}catch(e){}return{is_html:1,page_key:location.href,refer_page_key:e,page_manual_key:"",refer_page_manual_key:""}}function Ph(e,t){var n=Bh();return n.is_back=0,n}function zh(e,t){void 0===t&&(t=!1),function(e){var t,n;t=window.history,n=t.pushState,t.pushState=function(o){"function"==typeof t.onpushstate&&t.onpushstate({state:o}),e("pushState",o,c);for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];var s=n.call.apply(n,[t,o].concat(i)),c=Ph();return Ah=Dh(location.href,i[1]),e("popstate",o,c),s},function(t){var n=t.replaceState;t.replaceState=function(o){"function"==typeof t.onreplacestate&&t.onreplacestate({state:o});for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];var s=n.call.apply(n,[t,o].concat(i)),c=Ph();return Ah=Dh(location.href,i[1]),e("replaceState",o,c),s}}(window.history)}(e),(xh=new pd(!0)).setItem("__tea_cache_refer_key",location.href);var n=null;window.addEventListener("hashchange",(function(o){if(Ah!==window.location.href&&(clearTimeout(n),t)){Ah=window.location.href;var r=Bh();e("hashchange",o,r)}})),window.addEventListener("popstate",(function(t){Ah!==window.location.href&&(n=setTimeout((function(){Ah=window.location.href;var n=Ph();e("popstate",t,n)}),10))}));var o=Ph();e("popstate",null,o)}"undefined"!=typeof window&&(Ah=window.location.href);var Mh=function(){function e(e,t){var n=this;this.clickEvent=function(e){(function(e){if(1!==e.nodeType)return!1;if(function(e){for(var t=e.parentElement,n=!1;t;)"svg"===t.tagName.toLowerCase()?(t=null,n=!0):t=t.parentElement;return n}(e))return!1;if(["HTML","BODY"].includes(e.tagName.toUpperCase()))return!1;var t=e;return!("none"===t.style.display||!Lh(t,"container")&&!function(e){if(e.children.length){var t=e.children;return![].slice.call(t).some((function(e){return e.children.length>0}))}return!0}(t))})(e.target)&&n.eventHandel({eventType:"dom",eventName:"click"},e)},this.changeEvent=function(e){n.eventHandel({eventType:"dom",eventName:"change"},e)},this.submitEvent=function(e){n.eventHandel({eventType:"dom",eventName:"submit"},e)},this.getPageViewEvent=function(e,t,o){"pushState"===e?n.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:0}):n.eventHandel({eventType:"dom",eventName:"page_view"},o)},this.getPageLoadEvent=function(e){n.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:e})},this.config=t.getConfig().eventConfig,this.options=e,this.beatTime=e.beat,this.statistics=!1}return e.prototype.init=function(e){this.eventHandel=e;var t=this.config.mode;this.addListener(t)},e.prototype.addListener=function(e){var t=this;if("proxy-capturing"===e&&(this.config.click&&window.document.addEventListener("click",this.clickEvent,!0),this.config.change&&window.document.addEventListener("change",this.changeEvent,!0),this.config.submit&&window.document.addEventListener("submit",this.submitEvent,!0),this.config.pv&&("complete"===document.readyState?zh(this.getPageViewEvent,this.options.hashTag||this.config.hashTag):window.addEventListener("DOMContentLoaded",(function(){zh(t.getPageViewEvent,t.options.hashTag||t.config.hashTag)}))),this.config.beat)){try{"complete"===document.readyState?this.beatEvent(this.beatTime):window.addEventListener("load",(function(){t.beatEvent(t.beatTime)}));var n=0,o=null;window.addEventListener("scroll",(function(){clearTimeout(o),o=setTimeout(r,500),n=document.documentElement.scrollTop||document.body.scrollTop}));var r=function(){(document.documentElement.scrollTop||document.body.scrollTop)==n&&t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(e){}try{var i=window.performance&&window.performance.getEntriesByType("paint");i&&i.length?(new PerformanceObserver((function(e){var n=e.getEntries(),o=n[n.length-1],r=o.renderTime||o.loadTime;t.statistics||(t.getPageLoadEvent(r),t.statistics=!0)})).observe({entryTypes:["largest-contentful-paint"]}),setTimeout((function(){t.statistics||(t.getPageLoadEvent(i[0].startTime||0),t.statistics=!0)}),2e3)):this.getPageLoadEvent(0)}catch(e){this.getPageLoadEvent(0)}}},e.prototype.removeListener=function(){window.document.removeEventListener("click",this.clickEvent,!0),window.document.removeEventListener("change",this.changeEvent,!0),window.document.removeEventListener("submit",this.submitEvent,!0)},e.prototype.beatEvent=function(e){var t=this;try{var n;this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3}),this.beatTime&&(n=setInterval((function(){t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})}),e)),Bd((function(){t.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),t.beatTime&&clearInterval(n)}))}catch(e){}},e}(),jh={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},Uh=function(){function e(e){this.config=e}return e.prototype.getConfig=function(){return this.config},e.prototype.setConfig=function(e){return this.config=e},e}();function Vh(e,t){var n={element_path:"",positions:[],texts:[]},o=function(e){if(e){var t=e.getBoundingClientRect(),n=t.width,o=t.height;return{left:t.left,top:t.top,element_width:n,element_height:o}}}(t),r=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=e.clientX,o=e.clientY,r=t.left,i=t.top;return{touch_x:Math.floor(n-r),touch_y:Math.floor(o-i)}}(e,o),i=o.element_width,a=o.element_height,s=r.touch_x,c=r.touch_y,l=function(e){for(var t=[];null!==e.parentElement;)t.push(e),e=e.parentElement;var n=[],o=[];return t.forEach((function(e){var t=function(e){if(null===e)return{str:"",index:0};var t=0,n=e.parentElement;if(n)for(var o=n.children,r=0;r<o.length&&o[r]!==e;r++)o[r].nodeName===e.nodeName&&t++;return{str:[e.nodeName.toLowerCase(),Lh(e,"list")?"[]":""].join(""),index:t}}(e),r=t.str,i=t.index;n.unshift(r),o.unshift(i)})),{element_path:"/"+n.join("/"),positions:o}}(t),u=l.element_path,d=l.positions,h=function(e){var t=Rh(e),n=[];return function e(t){var o=Nh(t);if(o&&-1===n.indexOf(o)&&n.push(o),t.childNodes.length>0)for(var r=t.childNodes,i=0;i<r.length;i++)8!==r[i].nodeType&&e(r[i])}(t),n}(t),f=window.performance.timing.navigationStart,p=Date.now()-f;n.element_path=u,n.positions=d.map((function(e){return""+e})),n.texts=h,n.element_width=Math.floor(i),n.element_height=Math.floor(a),n.touch_x=s,n.touch_y=c,n.page_manual_key="",n.elememt_manual_key="",n.since_page_start_ms=p,n.page_start_ms=f,n.element_title=function(e){var t=Rh(e),n="";return function e(t){var o=Nh(t);if(o&&(n+=o),t.childNodes.length>0)for(var r=t.childNodes,i=0;i<r.length;i++)3===r[i].nodeType&&e(r[i])}(t),n}(t);var g=Rh(t);return"A"===g.tagName&&(n.href=g.getAttribute("href")),"IMG"===t.tagName&&(n.src=t.getAttribute("src")),n}function Hh(e,t,n){return ad({event:e},Vh(t,n),{is_html:1,page_key:window.location.href,page_title:document.title})}var Fh=function(){function e(e){this.eventName=e&&"tea"===e.custom?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat",static:"__bav_page_statistics"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat",static:"bav2b_page_statistics"}}return e.prototype.handleEvent=function(e,t){try{if(function(e){for(var t=e;t&&t.parentNode;){if(t.hasAttribute("data-tea-ignore"))return!0;if("HTML"===t.nodeName||"body"===t.nodeName)return!1;t=t.parentNode}return!1}(e.target))return null;var n="bav2b_click";switch(t){case"click":return Hh(n=this.eventName.click,e,e.target);case"change":return ad({},Hh(n="bav2b_change",e,e.target),function(e,t){try{if("bav2b_change"===e)return t.hasAttribute("data-tea-track")?{value:t.value}:{}}catch(e){return{}}}(n,e.target));case"submit":return Hh(n="bav2b_submit",e,e.target)}}catch(e){return console.error(e),null}},e.prototype.handleViewEvent=function(e){e.event=this.eventName.page,e.page_title=document.title,e.page_total_width=window.innerWidth,e.page_total_height=window.innerHeight;try{var t=window.sessionStorage.getItem("_tea_cache_duration");if(t){var n=JSON.parse(t);e.refer_page_duration_ms=n?n.duration:"",e.refer_page_title=n?n.page_title:""}else e.refer_page_duration_ms="",e.refer_page_title="";e.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,e.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,e.page_start_ms=window.performance.timing.navigationStart}catch(e){console.log("page event error "+JSON.stringify(e))}return e},e.prototype.handleStatisticsEvent=function(e){var t={};t.event=this.eventName.static,t.is_html=1,t.page_key=location.href,t.refer_page_key=document.referrer||"",t.page_title=document.title,t.page_manual_key="",t.refer_page_manual_key="";try{var n=e.lcp,o=window.performance.timing,r=o.loadEventEnd-o.navigationStart;t.page_init_cost_ms=parseInt(n||(r>0?r:0)),t.page_start_ms=o.navigationStart}catch(e){console.log("page_statistics event error "+JSON.stringify(e))}return t},e.prototype.handleBeadtEvent=function(e){e.event=this.eventName.beat,e.page_key=window.location.href,e.is_html=1,e.page_title=document.title,e.page_manual_key="";try{e.page_total_width=document.documentElement.scrollWidth,e.page_total_height=document.documentElement.scrollHeight,e.scroll_width=document.documentElement.scrollLeft+window.innerWidth,e.scroll_height=document.documentElement.scrollTop+window.innerHeight,e.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,e.page_start_ms=window.performance.timing.navigationStart}catch(e){console.log("beat event error "+JSON.stringify(e))}return e},e}(),Kh=function(){function e(e,t){this.logFunc=e,this.logFuncBecon=t,this.eventNameList=["report_click_event","report_change_event","report_submit_event","report_exposure_event","report_page_view_event","report_page_statistics_event","report_beat_event"]}return e.prototype.send=function(e,t){e.eventName;var n=e.eventSend,o=t.event;delete t.event,n&&"becon"===n?this.logFuncBecon(o,t,"autotrack"):this.logFunc(o,t,"autotrack")},e.prototype.get=function(e,t){var n=Object.assign({headers:{"content-type":"application/json"},method:"GET"},t);fetch(e,n)},e.prototype.post=function(e,t){var n=Object.assign({headers:{"content-type":"application/json"},method:"POST"},t);fetch(e,n)},e}(),Gh="_TEA_VE_OPEN",Jh="_TEA_VE_APIHOST",qh="lang",Wh="_VISUAL_EDITOR_V",$h="_VISUAL_EDITOR_U";function Yh(){try{var e=window.TEAVisualEditor.lang=window.TEAVisualEditor.lang||ud.get(qh),t=window.TEAVisualEditor.__editor_ajax_domain=window.TEAVisualEditor.__editor_ajax_domain||ud.get(Jh),n=window.TEAVisualEditor.__editor_verison=window.TEAVisualEditor.__editor_verison||ud.get(Wh),o=window.TEAVisualEditor.__editor_url=window.TEAVisualEditor.__editor_url||ud.get($h),r=+new Date,i=new Date(r+18e5);ud.set(Gh,"1",{expires:i}),ud.set(Jh,t,{expires:i}),ud.set($h,o,{expires:i}),ud.set(qh,e,{expires:i}),ud.set(Wh,n||"",{expires:i})}catch(e){console.log("set cookie err")}}window.TEAVisualEditor=window.TEAVisualEditor||{};var Qh="",Xh=window.TEAVisualEditor.__editor_url||xd("1fz22z22z1nz21z4mz4bz4bz21z4fz4az1nz21z22z18z22z1nz4az1az1mz1kz4bz1nz1ez1az4bz22z1cz1az1fz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z1cz1bz1gz22z1mz20z4az1hz21");Xh=Xh+"?query="+Date.now();var Zh=xd("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z1cz1bz1gz22z1mz20z49z20z18z1lz1ez1cz20z21z4az1hz21")+"?query="+Date.now(),ef=!1;function tf(e){var t=e.event,n=e.editorUrl,o=e.autoTrackInstance;e.fromSession,ef||(ef=!0,vh(n,(function(){ph(t,"editorScriptloadSuccess"),o.destroy()}),(function(){t&&ph(t,"editorScriptloadError"),ef=!1})))}var nf,of={hashTag:!1,impr:!1},rf=function(){function e(){this.autoTrackStart=!1}return e.prototype.start=function(e,t,n){t=Object.assign(of,t),this.destroyed=!1,this.options=t,this.logFunc=e,this.logFuncBecon=n,this.Config=new Uh(jh),this.Listener=new Mh(t,this.Config),this.EventHandle=new Fh(t),this.Request=new Kh(this.logFunc,this.logFuncBecon),this.autoTrackStart=!0,this.init()},e.prototype.init=function(){this.Listener.init(this.handle.bind(this))},e.prototype.handle=function(e,t){"dom"===e.eventType&&this.handleDom(e,t)},e.prototype.handleDom=function(e,t){try{var n=e.eventName;if("click"===n||"change"===n||"submit"===n){var o=this.EventHandle.handleEvent(t,n);null!==o&&this.Request.send({eventType:"custom",eventName:"report_"+n+"_event",extra:{methods:"GET"}},o)}else if("page_view"===n||"page_statistics"===n){var r;r="page_view"===n?this.EventHandle.handleViewEvent(t):this.EventHandle.handleStatisticsEvent(t),this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"}},r)}else if("beat"===n){var i=this.EventHandle.handleBeadtEvent(t),a=e.eventSend;this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"},eventSend:a},i)}}catch(e){console.log("handel dom event error "+JSON.stringify(e))}},e.prototype.destroy=function(){if(!this.autoTrackStart)return console.warn("engine is undefined, make sure you have called autoTrack.start()");this.autoTrackStart=!1,this.Listener.removeListener()},e}(),af=cd(["init","config","send","start","predefinePageView","beconEvent","on","resetStayDuration","autoInitializationRangers"],["profileSet","profileSetOnce","profileIncrement","profileUnset","profileAppend","getVar","getAbSdkVersion","onAbSdkVersionChange","offAbSdkVersionChange","getABconfig","openOverlayer","closeOverlayer","getAllVars","setExternalAbVersion","getToken","destroy"]),sf=(nf=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return nf+=1}),cf=function(){function e(e){var t=this;this.is_first_time=!1,this.Native=!1,this.staging=!1,this.sdkload=!1,this._getToken=!1,this.predefinePageView=function(e){if(void 0===e&&(e={}),t.sdkload){var n={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+t.is_first_time},o=ad({},n,e);t.event("predefine_pageview",o,"pv")}else t.logger.warn("sdk init error, api can not call")},this.getToken=function(e,n){if(!t.sdkload)return t.logger.warn("sdk init error, api can not call, getToken will return {}"),void e({});var o=!1,r=function(){if(!o){o=!0;var n=t._config.get().user;return e(ad({},n))}};n&&setTimeout((function(){r()}),n),t._token.isTokenReady()?r():(t.hook.on("get-token",(function(){r()})),t._getToken=!0)},this.name=e,this._isSend=!1,this.hook=new Kd,this.storage=new pd(!1)}return e.prototype.autoInitializationRangers=function(e){},e.prototype.init=function(e){var t=this;if(!this._inited){if(this._inited=!0,!e||"object"!=typeof e)throw new Error("init params is error,please check");this.logger=new Fd(this.name,e.log);var n=e.app_id,o=e.app_key;o||n?n&&"number"!=typeof n?this.logger.throw("app_id param is error, must be number, please check !!!"):o&&"string"!=typeof o?this.logger.warn("app_key is empty, please check!"):e.channel_domain||-1!==["cn","sg","va"].indexOf(e.channel)?(this.Native=e.Native,this.appBridge=new $d(this.logger),this.storage.getItem("__tea_cache_first_"+n)?this.is_first_time=!1:(this.is_first_time=!0,this.storage.setItem("__tea_cache_first_"+n,"1")),this.sdkload=!0,e.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted((function(n){n||t._init(e)})):this._init(e)):this.logger.throw("channel must be `cn`, `sg`,`va` !!!"):this.logger.throw("no app_key or app_id please check !!!")}},e.prototype._init=function(e){var t=this;this.autoPV=!0,this.sdkload=!0,this._initConfig=e,this._config=new Hd(e.app_id,e,e.configPersist||0),this.configPersist=e.configPersist||0,this._config.set("app_id",e.app_id),this.hook.on("token-ready",(function(){t.callbackSend?t._isSend?t._event&&t._event.report():t.start():t._event&&t._event.report()})),this._session=new Jd(e.app_key||e.app_id,e),this._token=new Dd(e,this._config,this.hook,this._session),this.plugin=new Ch(this,e,this.event.bind(this),this.beconEvent.bind(this),this.hook),this._event=new zd(this,e,this._config,this._token,this.plugin,this._session,e.filter),this.tracer=new Wd(this,e,this._processEvent.bind(this),this._event),this._token._getToken();try{e.autotrack&&function(e,t,n){var o=new rf,r=e.autotrack;if(r){var i={};"object"==typeof r&&(i=r),o.start(t,i,n),function(e,t){window.TEAVisualEditor.appId=t.app_id;var n=t.channel_domain,o="";if(fh(["*"]),n){var r,i="";try{var a=window.performance.getEntriesByType("resource");if(a&&a.length&&(a.forEach((function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(i=e.name)})),i||document.currentScript&&(i=document.currentScript.src),i&&(r=i.split("/"))&&r.length)){o="https:/";for(var s=2;s<r.length&&s!==r.length-1;s++)o=o+"/"+r[s];o+="/visual-editor-rangers"}}catch(e){}}if(mh(t,vd),"1"===ud.get(Gh)){var c=function(){var e=ud.get(Jh);try{e=JSON.parse(e)}catch(e){}return e}();c?(window.TEAVisualEditor.__editor_ajax_domain=c,tf({event:null,editorUrl:ud.get($h)||Zh,autoTrackInstance:e,fromSession:!1})):tf({event:null,editorUrl:Xh,autoTrackInstance:e,fromSession:!1}),Yh()}else try{gh("tea:openVisualEditor",(function(t){var r=t.data;if("string"==typeof t.data)try{r=JSON.parse(t.data)}catch(e){r=void 0}if(r){var i=r.referrer,a=r.lang;if(i?(window.TEAVisualEditor.__editor_ajax_domain=i,Qh=Zh):Qh=Xh,n){var s=r.version;Qh=o?o+(s?"-v"+s:"-v1.0.0")+".js":Zh,window.TEAVisualEditor.__editor_verison=s}window.TEAVisualEditor.__editor_url=Qh,window.TEAVisualEditor.lang=a,tf({event:t,editorUrl:Qh,autoTrackInstance:e}),Yh()}})),window.TEAVisualEditor.openAutotrackEditor=function(){tf({event:null,editorUrl:window.TEAVisualEditor.__editor_url,autoTrackInstance:e})}}catch(e){console.log("receive message error")}try{gh("tea:openHeatMapCore",(function(t){tf({event:t,editorUrl:xd("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1fz1cz18z22z1kz18z1nz49z1az1mz20z1cz4az1hz21")+"?query="+Date.now(),autoTrackInstance:e})}))}catch(e){console.log("openHeatMapCore error")}}(o,e)}else o.autoTrackStart&&o.destroy()}(e,this.event.bind(this),this.beconEvent.bind(this))}catch(e){}},e.prototype.config=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted((function(n){if(n)for(var o in e)"user_unique_id"===o?t.appBridge.setUserUniqueId(e[o]):e[o]?t.appBridge.addHeaderInfo(o,e[o]):t.appBridge.removeHeaderInfo(o);else t._setConfig(e)})):this._setConfig(e):this.logger.warn("sdk init error, api can not call")},e.prototype._setConfig=function(e){if(this._inited)if(e&&"object"==typeof e){e.disable_auto_pv&&(this.autoPV=!1,delete e.disable_auto_pv),e._staging_flag&&1===e._staging_flag&&(this.staging=!0);var t=ad({},e);if(this.configPersist){var n=this._config.getStore();n&&(t=Object.assign(n,e)),this._config.setStore(e)}for(var o in t){if(t.user_unique_id){"string"!=typeof t.user_unique_id&&this.logger.warn("user_unique_id must be string!!! please check");try{var r=String(t.user_unique_id);this._token._getSsid(r)}catch(e){}}this._config.set(o,t[o])}}else this.logger.warn("config params is error, please check");else this.logger.warn("config must be use after function init")},e.prototype.on=function(e,t){try{e&&"string"==typeof e&&"function"==typeof t&&this.hook.on(e,t)}catch(e){}},e.prototype.send=function(){this.start()},e.prototype.start=function(){var e=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted((function(t){t?(e.logger.info("jsbrigeå¼å¯ï¼äºä»¶å°ç±åç sdkè¿è¡ä¸æ¥"),e.predefinePageView()):e._start()})):this._start():this.logger.warn("sdk init error, api can not call")},e.prototype._start=function(){if(this._token.isTokenReady()){if(this._isSend)return void this.logger.warn("method start can not be use over one time , please check !!");this._isSend=!0,this.logger.info("userInfo:"+JSON.stringify(this._config.get("user"))),this.logger.info("sdk is ready,version is 4.1.54. you can report now !!!"),this._event.setReady(),this.autoPV&&this.predefinePageView(),this._getToken&&this.hook.emit("get-token"),this.profile=new Yd(this._processEvent.bind(this),this._event,this._initConfig),this.plugin&&this.plugin.ab&&this.plugin.ab.init(this._config.get())}else this.callbackSend=!0},e.prototype.beconEvent=function(e,t,n){var o=this;void 0===t&&(t={});var r=n||"log",i=[];i.push([e,t]),i=i.map((function(e){return o._processEvent(e[0],e[1])})),this._dealEvent(!0,i,r),this._addTracerCount(r)},e.prototype.event=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(this.sdkload){var o=sd(t,1)[0],r=[];"Array"!==Object.prototype.toString.call(o).slice(8,-1)?r[0]=t:r=t,r=r.map((function(t){return e._processEvent(t[0],t[1])})),this._dealEvent(!1,r,"log"),this._addTracerCount("log")}else this.logger.warn("sdk init error, api can not call")},e.prototype._dealEvent=function(e,t,n){var o=this;if(this.sdkload)if(this.Native&&this.appBridge.bridgeInject()){if("autotrack"===n||"sdk"===n)return;this.appBridge.hasStarted((function(n){n?t&&t.length&&t.forEach((function(e){var t=e.event,n=e.params;o.appBridge.onEventV3(t,JSON.stringify(n))})):o._commonEvent(e,t)}))}else this._commonEvent(e,t);else this.logger.warn("sdk init error, api can not call")},e.prototype._commonEvent=function(e,t){e?this._event.beconEvent(t):this._event.event(t),this._session._updateSessionId(),this.plugin&&this.plugin.session&&this.plugin.session.process()},e.prototype._addTracerCount=function(e){this.sdkload?this.Native||this.staging||this.tracer.addCount(e):this.logger.warn("sdk init error, api can not call")},e.prototype._processEvent=function(e,t){try{var n=e;/^event\./.test(e)&&(n=e.slice(6));var o,r=t;return"object"!=typeof r&&(r={}),r.profile?delete r.profile:r.event_index=sf(),r.local_ms?(o=r.local_ms,delete r.local_ms):o=+new Date,{event:n,params:r,local_time_ms:o,is_bav:this._initConfig.autotrack?1:0}}catch(n){return{_event:e,params:t}}},e.prototype.resetStayDuration=function(e,t,n){this.sdkload?this.plugin.stay?this.plugin.stay&&this.plugin.stay.reset(e,t,n):this.logger.info("stayDuration is not init"):this.logger.warn("sdk init error, api can not call")},e.prototype.profileSet=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted((function(n){n?t.appBridge.profileSet(JSON.stringify(e)):t.profile&&t.profile.setProfile(e)})):this.profile&&this.profile.setProfile(e):this.logger.warn("sdk init error, api can not call")},e.prototype.profileSetOnce=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted((function(n){n?t.appBridge.profileSetOnce(JSON.stringify(e)):t.profile&&t.profile.setOnceProfile(e)})):this.profile&&this.profile.setOnceProfile(e):this.logger.warn("sdk init error, api can not call")},e.prototype.profileIncrement=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted((function(n){n?t.appBridge.profileIncrement(JSON.stringify(e)):t.profile&&t.profile.incrementProfile(e)})):this.profile&&this.profile.incrementProfile(e):this.logger.warn("sdk init error, api can not call")},e.prototype.profileUnset=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted((function(n){n?t.appBridge.profileUnset(e):t.profile&&t.profile.unsetProfile(e)})):this.profile&&this.profile.unsetProfile(e):this.logger.warn("sdk init error, api can not call")},e.prototype.profileAppend=function(e){var t=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted((function(n){n?t.appBridge.profileAppend(JSON.stringify(e)):t.profile&&t.profile.appendProfile(e)})):this.profile&&this.profile.appendProfile(e):this.logger.warn("sdk init error, api can not call")},e.prototype.setExternalAbVersion=function(e){this.sdkload?e&&this.plugin.ab&&this.plugin.ab._setAbVersion(e):this.logger.warn("sdk init error, api can not call")},e.prototype.getVar=function(e,t,n){var o=this;if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getVar return default value"),void n(t);this.hook.on("token-error",(function(){o.logger.warn("sdk init error, getVar return default value"),n(t)})),this.plugin.ab&&this.plugin.ab.getVar(e,t,n)},e.prototype.getABconfig=function(e,t){if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getABconfig return null"),void t(null);this.plugin.ab&&this.plugin.ab._getABconfig(e,t)},e.prototype.getAbSdkVersion=function(e){if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getAbSdkVersion return null"),void e(null);this.plugin.ab&&this.plugin.ab.getAbSdkVersion(e)},e.prototype.onAbSdkVersionChange=function(e){this.sdkload?this.hook.on("onAbSdkVersionChange",e):this.logger.warn("sdk init error, api can not call")},e.prototype.offAbSdkVersionChange=function(e){this.sdkload?e?this.hook.off("onAbSdkVersionChange",e):this.hook.off("onAbSdkVersionChange"):this.logger.warn("sdk init error, api can not call")},e.prototype.openOverlayer=function(){this.sdkload?this.plugin.ab&&this.plugin.ab.openOverlayer():this.logger.warn("sdk init error, api can not call")},e.prototype.closeOverlayer=function(){this.sdkload?this.plugin.ab&&this.plugin.ab.closeOverlayer():this.logger.warn("sdk init error, api can not call")},e.prototype.getAllVars=function(e){var t=this;if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getAllVars return null"),void e(null);this.hook.on("token-error",(function(){t.logger.warn("sdk init error, getallVar return null"),e(null)})),this.plugin.ab&&this.plugin.ab.getAllVars(e)},e.prototype.destroy=function(){this.destroyInstance||(this.destroyInstance=!0,this.hook.off("token-ready"))},e}();function lf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var uf=function(e){var t=this;return lf(this,"_exportCollect",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];t._isProcess?t._executeCmd.apply(t,n):(t.cmdQueue.push(n),t._processCmd())})),lf(this,"_processCmd",(function(){var e,n,o;0!==t.cmdQueue.length&&(n=t.cmdQueue,o=-1,n.forEach((function(e,t){"init"===e[0]&&(o=t)})),-1!==(e=o)&&(t._isProcess=!0,t._executeCmd.apply(t,t.cmdQueue[e]),t.cmdQueue.forEach((function(n,o){o!==e&&t._executeCmd.apply(t,n)})),t.cmdQueue=[]))})),lf(this,"_executeCmd",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];var r,i,a=n[0];af.indexOf(a)>-1?(r=t.colloctor)[a].apply(r,n.slice(1)):(i=t.colloctor).event.apply(i,n)})),this.cmdQueue=[],this.name=e,this.colloctor=new cf(e),this._isProcess=!1,this._alias={},this._processCmd(),af.forEach((function(e){t._exportCollect[e]=t._exportCollect.bind(t,e)})),this._exportCollect},df={},hf={},ff=function(e){return hf[e]||(hf[e]=[]),hf[e]},pf=function(e){try{var t=sd(e),n=t[0],o=t.slice(1);if(!n)return void console.error("the eventName is: "+n+", error, stop report, please check");var r=n.split(".");if(1===r.length)ff("default").push(cd([n],o));else if(2===r.length)"event"===r[0]?ff("default").push(cd([n],o)):ff(r[0]).push(cd([r[1]],o));else{var i=r[0],a=[r[1],r[2]].join(".");ff(i).push(cd([a],o))}}catch(e){console.log(e)}},gf=function(){_f.q.forEach((function(e){var t=[].slice.call(e);"Array"===Object.prototype.toString.call(t[0]).slice(8,-1)?t.forEach((function(e){pf(e)})):pf(t)})),Object.keys(hf).forEach((function(e){hf[e].forEach((function(t){(function(e){return df[e]||(df[e]=new uf(e)),df[e]})(e).apply(void 0,cd(t))})),hf[e]=[]})),_f.q=[]},_f=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.q.push(t),gf()};_f.q=[],_f.l=Date.now(),_f._instanceMap=df,_f._instanceCmdMap=hf,af.forEach((function(e){_f[e]=_f.bind(null,e)})),gf();var mf,vf,bf,yf,kf,wf=uf,Ef=n((function(e,n){var o;e.exports=(o=o||function(e,n){var o;if("undefined"!=typeof window&&window.crypto&&(o=window.crypto),"undefined"!=typeof self&&self.crypto&&(o=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(o=globalThis.crypto),!o&&"undefined"!=typeof window&&window.msCrypto&&(o=window.msCrypto),!o&&void 0!==t&&t.crypto&&(o=t.crypto),!o)try{o=require("crypto")}catch(e){}var r=function(){if(o){if("function"==typeof o.getRandomValues)try{return o.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof o.randomBytes)try{return o.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),a={},s=a.lib={},c=s.Base={extend:function(e){var t=i(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},l=s.WordArray=c.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=t!=n?t:4*e.length},toString:function(e){return(e||d).stringify(this)},concat:function(e){var t=this.words,n=e.words,o=this.sigBytes,r=e.sigBytes;if(this.clamp(),o%4)for(var i=0;i<r;i++){var a=n[i>>>2]>>>24-i%4*8&255;t[o+i>>>2]|=a<<24-(o+i)%4*8}else for(var s=0;s<r;s+=4)t[o+s>>>2]=n[s>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(r());return new l.init(t,e)}}),u=a.enc={},d=u.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],r=0;r<n;r++){var i=t[r>>>2]>>>24-r%4*8&255;o.push((i>>>4).toString(16)),o.push((15&i).toString(16))}return o.join("")},parse:function(e){for(var t=e.length,n=[],o=0;o<t;o+=2)n[o>>>3]|=parseInt(e.substr(o,2),16)<<24-o%8*4;return new l.init(n,t/2)}},h=u.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],r=0;r<n;r++){var i=t[r>>>2]>>>24-r%4*8&255;o.push(String.fromCharCode(i))}return o.join("")},parse:function(e){for(var t=e.length,n=[],o=0;o<t;o++)n[o>>>2]|=(255&e.charCodeAt(o))<<24-o%4*8;return new l.init(n,t)}},f=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(h.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return h.parse(unescape(encodeURIComponent(e)))}},p=s.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,o=this._data,r=o.words,i=o.sigBytes,a=this.blockSize,s=i/(4*a),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*a,u=e.min(4*c,i);if(c){for(var d=0;d<c;d+=a)this._doProcessBlock(r,d);n=r.splice(0,c),o.sigBytes-=u}return new l.init(n,u)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});s.Hasher=p.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new g.HMAC.init(e,n).finalize(t)}}});var g=a.algo={};return a}(Math),o)})),Sf=n((function(e,t){var n;e.exports=(n=Ef,function(e){var t=n,o=t.lib,r=o.WordArray,i=o.Hasher,a=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=a.MD5=i.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var o=t+n,r=e[o];e[o]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var i=this._hash.words,a=e[t+0],c=e[t+1],f=e[t+2],p=e[t+3],g=e[t+4],_=e[t+5],m=e[t+6],v=e[t+7],b=e[t+8],y=e[t+9],k=e[t+10],w=e[t+11],E=e[t+12],S=e[t+13],T=e[t+14],I=e[t+15],O=i[0],C=i[1],L=i[2],R=i[3];O=l(O,C,L,R,a,7,s[0]),R=l(R,O,C,L,c,12,s[1]),L=l(L,R,O,C,f,17,s[2]),C=l(C,L,R,O,p,22,s[3]),O=l(O,C,L,R,g,7,s[4]),R=l(R,O,C,L,_,12,s[5]),L=l(L,R,O,C,m,17,s[6]),C=l(C,L,R,O,v,22,s[7]),O=l(O,C,L,R,b,7,s[8]),R=l(R,O,C,L,y,12,s[9]),L=l(L,R,O,C,k,17,s[10]),C=l(C,L,R,O,w,22,s[11]),O=l(O,C,L,R,E,7,s[12]),R=l(R,O,C,L,S,12,s[13]),L=l(L,R,O,C,T,17,s[14]),O=u(O,C=l(C,L,R,O,I,22,s[15]),L,R,c,5,s[16]),R=u(R,O,C,L,m,9,s[17]),L=u(L,R,O,C,w,14,s[18]),C=u(C,L,R,O,a,20,s[19]),O=u(O,C,L,R,_,5,s[20]),R=u(R,O,C,L,k,9,s[21]),L=u(L,R,O,C,I,14,s[22]),C=u(C,L,R,O,g,20,s[23]),O=u(O,C,L,R,y,5,s[24]),R=u(R,O,C,L,T,9,s[25]),L=u(L,R,O,C,p,14,s[26]),C=u(C,L,R,O,b,20,s[27]),O=u(O,C,L,R,S,5,s[28]),R=u(R,O,C,L,f,9,s[29]),L=u(L,R,O,C,v,14,s[30]),O=d(O,C=u(C,L,R,O,E,20,s[31]),L,R,_,4,s[32]),R=d(R,O,C,L,b,11,s[33]),L=d(L,R,O,C,w,16,s[34]),C=d(C,L,R,O,T,23,s[35]),O=d(O,C,L,R,c,4,s[36]),R=d(R,O,C,L,g,11,s[37]),L=d(L,R,O,C,v,16,s[38]),C=d(C,L,R,O,k,23,s[39]),O=d(O,C,L,R,S,4,s[40]),R=d(R,O,C,L,a,11,s[41]),L=d(L,R,O,C,p,16,s[42]),C=d(C,L,R,O,m,23,s[43]),O=d(O,C,L,R,y,4,s[44]),R=d(R,O,C,L,E,11,s[45]),L=d(L,R,O,C,I,16,s[46]),O=h(O,C=d(C,L,R,O,f,23,s[47]),L,R,a,6,s[48]),R=h(R,O,C,L,v,10,s[49]),L=h(L,R,O,C,T,15,s[50]),C=h(C,L,R,O,_,21,s[51]),O=h(O,C,L,R,E,6,s[52]),R=h(R,O,C,L,p,10,s[53]),L=h(L,R,O,C,k,15,s[54]),C=h(C,L,R,O,c,21,s[55]),O=h(O,C,L,R,b,6,s[56]),R=h(R,O,C,L,I,10,s[57]),L=h(L,R,O,C,m,15,s[58]),C=h(C,L,R,O,S,21,s[59]),O=h(O,C,L,R,g,6,s[60]),R=h(R,O,C,L,w,10,s[61]),L=h(L,R,O,C,f,15,s[62]),C=h(C,L,R,O,y,21,s[63]),i[0]=i[0]+O|0,i[1]=i[1]+C|0,i[2]=i[2]+L|0,i[3]=i[3]+R|0},_doFinalize:function(){var t=this._data,n=t.words,o=8*this._nDataBytes,r=8*t.sigBytes;n[r>>>5]|=128<<24-r%32;var i=e.floor(o/4294967296),a=o;n[15+(r+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(r+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,c=s.words,l=0;l<4;l++){var u=c[l];c[l]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}return s},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function l(e,t,n,o,r,i,a){var s=e+(t&n|~t&o)+r+a;return(s<<i|s>>>32-i)+t}function u(e,t,n,o,r,i,a){var s=e+(t&o|n&~o)+r+a;return(s<<i|s>>>32-i)+t}function d(e,t,n,o,r,i,a){var s=e+(t^n^o)+r+a;return(s<<i|s>>>32-i)+t}function h(e,t,n,o,r,i,a){var s=e+(n^(t|~o))+r+a;return(s<<i|s>>>32-i)+t}t.MD5=i._createHelper(c),t.HmacMD5=i._createHmacHelper(c)}(Math),n.MD5)})),Tf=n((function(e,t){var n;e.exports=(n=Ef,function(){var e=n,t=e.lib,o=t.WordArray,r=t.Hasher,i=e.algo,a=[],s=i.SHA1=r.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],r=n[1],i=n[2],s=n[3],c=n[4],l=0;l<80;l++){if(l<16)a[l]=0|e[t+l];else{var u=a[l-3]^a[l-8]^a[l-14]^a[l-16];a[l]=u<<1|u>>>31}var d=(o<<5|o>>>27)+c+a[l];d+=l<20?1518500249+(r&i|~r&s):l<40?1859775393+(r^i^s):l<60?(r&i|r&s|i&s)-1894007588:(r^i^s)-899497514,c=s,s=i,i=r<<30|r>>>2,r=o,o=d}n[0]=n[0]+o|0,n[1]=n[1]+r|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;return t[o>>>5]|=128<<24-o%32,t[14+(o+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(o+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=r._createHelper(s),e.HmacSHA1=r._createHmacHelper(s)}(),n.SHA1)}));!function(e){e[e.trace=1]="trace",e[e.normal=2]="normal",e[e.warn=3]="warn",e[e.error=4]="error",e[e.fatal=5]="fatal"}(mf||(mf={})),function(e){e.traceId="trace_id",e.errorCode="error_code",e.errorMsg="error_msg",e.time="time",e.duration="duration",e.monitorLevel="monitor_level",e.monitorDomain="monitor_domain",e.monitorCode="monitor_code",e.monitorID="monitor_id",e.monitorMessage="monitor_message",e.monitorTags="monitor_tags",e.monitorFile="monitor_file",e.monitorFunction="monitor_function",e.monitorLine="monitor_line",e.monitorColumn="monitor_column",e.monitorStack="monitor_stack",e.resultType="result_type"}(vf||(vf={})),function(e){e.BATCH="BATCH"}(bf||(bf={})),function(e){e.success="success",e.fail="fail",e.cancel="cancel",e.timeout="timeout"}(yf||(yf={})),function(e){e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.fatal=5]="fatal"}(kf||(kf={}));const If={tagSeperator:",",defaultReportName:"op_monitor_event",defaultLogTag:"op_monitor",eventName:"event_name"};var Of,Cf;!function(e){e.warn="warn",e.error="error"}(Of||(Of={})),function(e){e.sampleRate="sample_rate",e.traceSampleRate="trace_sample_rate",e.normalSampleRate="normal_sample_rate",e.warnSampleRate="warn_sample_rate",e.errorSampleRate="error_sample_rate",e.fatalSampleRate="fatal_sample_rate",e.rules="rules",e.priority="priority",e.filters="filters",e.key="key",e.values="values"}(Cf||(Cf={}));const Lf="Slardar",Rf=()=>{};function Nf(e){return void 0===e}const Af={string:function(e){return"string"==typeof e||"String"===function(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)},undefined:Nf,void:function(e){return Nf(e)||null===e},object:function(e){return null!==e&&"object"==typeof e},number:function(e){return"number"==typeof e&&!Number.isNaN(e)},function:function(e){return"function"==typeof e}};function xf(e,t){return Object.entries(e).filter((([e,n])=>!t(n,e))).reduce(((e,[t,n])=>Object.assign(e,{[t]:n})),{})}function Df(e,t,n){Object.defineProperty(e,t,{get:()=>n,set(){}})}let Bf;function Pf(){return Bf||(Bf=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}())}class zf{constructor({priority:e,sampleRate:t,filters:n}){this.priority=0,this.filters=[],this.priority=e,this.sampleRate=t,this.filters=n}match(e){return this.filters.every((t=>t.match(e)))}}class Mf{constructor({key:e,values:t}){this.key="",this.values=[],this.key=e,this.values=t}match(e){const t=`${e[this.key]}`;return this.values.includes(t)}}class jf{constructor(e){if(this._domainToNameRegistry=new Map,this._domainToParamInjectorRegistry=new Map,this._domainToNameCache=new Map,e instanceof jf)return e;const{defaultName:t=If.defaultReportName,log:n,report:o=Rf,commonMetrics:r={},commonCategories:i={},commonTags:a=[],defaultPlatform:s=Lf,domainToNameMap:c,domainToParamInjectorMap:l}=e||{};this.defaultName=String(t),this.defaultPlatform=s,this._log=n,this._report=o,this.commonMetrics=r,this.commonCategories=i,this.commonTags=new Set(a),c&&Object.entries(c).forEach((([e,t])=>{this.registerEvent(t,e)})),l&&Object.entries(l).forEach((([e,t])=>{this.registerParamInjector(e,t)}))}setRemoteConfig(e){this._remoteConfig=e}getRemoteConfig(){return this._remoteConfig?this._remoteConfig:this.constructor.globalRemoteConfig}log(e){Af.function(this._log)&&this._log(e)}report(e){const t=this.getRemoteConfig(),{name:n,metrics:o,categories:r}=e,i=Object.assign(Object.assign({[If.eventName]:n},o),r);t.getSampleRate(i)<1||this._report(e)}registerEvent(e,t){if(this._domainToNameRegistry.get(t)!==e){this._domainToNameRegistry.set(t,e);for(const e of this._domainToNameCache.keys())e.startsWith(t)&&this._domainToNameCache.delete(e)}}getNameByDomain(e){return this._findName(e)||this.defaultName}registerParamInjector(e,t){this._domainToParamInjectorRegistry.set(e,t)}applyParamInjectorByDomain(e,t){for(let n=e.split("."),o=n.length,r=1;r<=o;r++){const e=n.slice(0,r).join("."),o=this._domainToParamInjectorRegistry.get(e);Af.function(o)&&o(t)}}_findName(e){if(this._domainToNameCache.has(e))return this._domainToNameCache.get(e);let t;for(let n=e.split("."),o=n.length,r=0;r<o;r++){const e=n.slice(0,o-r).join(".");if(t=this._domainToNameRegistry.get(e),t)return this._domainToNameCache.set(e,t),t}return this.defaultName}}jf.globalRemoteConfig=new class{constructor(){this._defaultSampleRate=1,this._traceSampleRate=0,this._normalSampleRate=1,this._warnSampleRate=1,this._errorSampleRate=1,this._fatalSampleRate=1,this._orderedRules=[]}buildConfig(e={}){const{[Cf.sampleRate]:t,[Cf.traceSampleRate]:n,[Cf.normalSampleRate]:o,[Cf.warnSampleRate]:r,[Cf.errorSampleRate]:i,[Cf.fatalSampleRate]:a,[Cf.rules]:s}=e;Af.number(t)&&(this._defaultSampleRate=t),Af.number(n)&&(this._traceSampleRate=n),Af.number(o)&&(this._normalSampleRate=o),Af.number(r)&&(this._warnSampleRate=r),Af.number(i)&&(this._errorSampleRate=i),Af.number(a)&&(this._fatalSampleRate=a);const c=this._parseRules(s);this._orderedRules=c.sort(((e,t)=>t.priority-e.priority))}getSampleRate(e){const t=this._getMatchedRuleInOrderedRules(e);let n=this._defaultSampleRate;switch(e[vf.monitorLevel]){case mf.trace:n=this._traceSampleRate;break;case mf.normal:n=this._normalSampleRate;break;case mf.warn:n=this._warnSampleRate;break;case mf.error:n=this._errorSampleRate;break;case mf.fatal:n=this._fatalSampleRate}return t&&!Af.undefined(t.sampleRate)&&(n=t.sampleRate),n>=1?1:0}_getMatchedRuleInOrderedRules(e){return this._orderedRules.find((t=>t.match(e)))}_parseRules(e){return Array.isArray(e)?e=e.map((e=>{if(!Af.object(e))return;let{[Cf.priority]:t,[Cf.sampleRate]:n,[Cf.filters]:o}=e;return Af.number(t)||(t=0),Af.number(n)||(n=void 0),o=Array.isArray(o)?o.map((e=>{if(!Af.object(e))return;const{[Cf.key]:t,[Cf.values]:n}=e;return Af.string(t)&&Array.isArray(n)?e=new Mf({key:t,values:n}):void 0})).filter((e=>e)):[],new zf({priority:t,sampleRate:n,filters:o})})).filter((e=>e)):[]}};class Uf{constructor(e){if(this.cacheList=[],this.waitingForReport=!1,e instanceof Uf)return e;this._setConfig(e)}static setup(e){this.default._setConfig(e)}getConfig(){return this.config}log(e){if(!Af.function(this.config.log))return;let t=kf.info;switch(e.getLevel()){case mf.trace:case mf.normal:t=kf.info;break;case mf.warn:t=kf.warn;break;case mf.error:t=kf.error;break;case mf.fatal:t=kf.fatal;break;default:t=kf.info}const n=If.defaultLogTag,o=e.getValue(vf.monitorFile),r=e.getValue(vf.monitorFunction),i=e.getValue(vf.monitorLine),a=e.getData(),s=`monitor_event : ${e.getName()} ${JSON.stringify(a)}`;this.invokeLog(xf({level:t,tag:n,file:o,functionName:r,line:i,content:s},Nf))}reportTo(e){const t=e.getValue(vf.monitorDomain);t&&this.config.applyParamInjectorByDomain(String(t),e);const n=this._getName(e),o=e.getMetrics(),r=e.getCategories(),i=e.getInternalData(),a=this._getPlatform(e);Af.function(this.config.report)&&this.invokeReport(xf({name:n,metrics:o,categories:r,internalData:i,platform:a},Nf))}flush(e){const{logEnabled:t=!0,reportEnabled:n=!0}=e.getInternalData(),o=e.getValue(vf.monitorDomain);o&&this.config.applyParamInjectorByDomain(String(o),e);const r=this._getName(e),i=e.getMetrics(),a=e.getCategories(),s=e.getInternalData(),c=this._getPlatform(e);n&&Af.function(this.config.report)&&this.invokeReport(xf({name:r,metrics:i,categories:a,internalData:s,platform:c},Nf)),t&&this.log(e)}flushWithThrottle(e){const t=this.getConfig();if(!Af.function(this.config.report))return;const n=e.getValue(vf.monitorDomain);n&&this.config.applyParamInjectorByDomain(String(n),e);const o=this._getPlatform(e),r=this._getName(e);let i;const a=()=>{this.cacheList.forEach((e=>t.report(Object.assign(Object.assign({},e),{platform:o})))),this.cacheList.length=0,this.waitingForReport=!1,Pf().clearTimeout(i)};this.cacheList.push({name:r,metrics:e.getMetrics(),categories:e.getCategories(),internalData:e.getInternalData()});const s=e.getValue(vf.monitorLevel);this.cacheList.length>=20||s&&s>=mf.error?a():this.waitingForReport||(this.waitingForReport=!0,i=Pf().setTimeout((()=>{a()}),2e3))}invokeLog(e){Af.function(this.config.log)&&this.config.log(e)}invokeReport(e){Af.function(this.config.report)&&this.config.report(e)}_setConfig(e){this.config=new jf(e)}_getName(e){const t=e.getValue(vf.monitorDomain);return e.getName()||t&&this.config.getNameByDomain(String(t))||this.config.defaultName}_getPlatform(e){return e.platform||this.config.defaultPlatform}}Uf.default=new Uf;class Vf{constructor(e){if(e instanceof Vf)return e;const{domain:t,code:n,level:o,message:r}=e||{};Df(this,"version",1),Df(this,"domain",String(t)),Df(this,"code",Number(n)),Df(this,"ID",String(this.generateID())),Df(this,"level",o),Df(this,"message",String(r))}equals(e){return e instanceof Vf&&e.ID===this.ID}toJSON(){return{domain:this.domain,code:this.code,level:this.level,message:this.message}}generateID(){return`${this.version}-${this.domain}-${this.code}`}}class Hf{constructor(e){this.metrics={},this.categories={},this.internalData={},this.tags=new Set,this._time=0,this._startTime=0,this._endTime=0,this._flushed=!1;const{service:t,name:n=If.defaultReportName,code:o,platform:r,metrics:i,categories:a,internalData:s}=e||{};this.service=t?new Uf(t):Uf.default,this.name=n,this._platform=r,o&&(this.code=new Vf(o)),this.categories=Object.assign(Object.assign({},this.service.getConfig().commonCategories),a),this.metrics=Object.assign(Object.assign({},this.service.getConfig().commonMetrics),i),this.tags=new Set(this.service.getConfig().commonTags),this.internalData=Object.assign({},s)}get time(){return this._time}get platform(){return this._platform}addMetricValue(e,t){return Af.undefined(t)||(this.metrics[e]=t),this}addCategoryValue(e,t){return Af.undefined(t)||(this.categories[e]=t),this}addTag(e){return Af.undefined(e)||this.tags.add(e),this}addMap(e={}){return Object.entries(e).forEach((([e,t])=>{Af.undefined(t)||(Af.number(t)?this.metrics[e]=t:this.categories[e]=t)})),this}tracing(e){return Af.undefined(e)||this.addCategoryValue(vf.traceId,e),this}flush(e){if(this._flushed)return;this._flushed=!0;const{logEnabled:t=!0,reportEnabled:n=!0}=this.getInternalData(),o=this.code||(this.hasErrorInfo()?this.codeIfError:void 0);Af.undefined(this.level)&&o&&o.level&&this.setLevel(o.level),o&&(this.addCategoryValue(vf.monitorDomain,o.domain),this.addMetricValue(vf.monitorCode,o.code),this.addCategoryValue(vf.monitorMessage,o.message)),this.tags&&this.addCategoryValue(vf.monitorTags,this.tagsInline()),this.time<=0&&this.setTime(Date.now()),n&&(e||this.service).reportTo(this),t&&this.service.log(this)}flushWithThrottle(){this._flushed||(this._flushed=!0,this.service.flushWithThrottle(this))}setMonitorCode(e){return Af.undefined(e)||(this.code=new Vf(e)),this}setMonitorCodeIfError(e){return Af.undefined(e)||(this.codeIfError=new Vf(e)),this}setLevel(e){return Af.undefined(e)||(this.level=e,this.addMetricValue(vf.monitorLevel,e)),this}setErrorCode(e){return Af.undefined(e)||this.addCategoryValue(vf.errorCode,String(e)),this}setErrorMessage(e){return Af.undefined(e)||this.addCategoryValue(vf.errorMsg,String(e)),this}setError(e){if(Af.undefined(e))return this;const{message:t,fileName:n,lineNumber:o,columnNumber:r,stack:i,code:a,monitorCode:s}=e;return Af.string(t)&&this.addCategoryValue(vf.errorMsg,t),Af.string(n)&&this.addCategoryValue(vf.monitorFile,n),Af.string(i)&&this.addCategoryValue(vf.monitorStack,i),Af.number(a)&&this.addMetricValue(vf.errorCode,a),Af.number(o)&&this.addMetricValue(vf.monitorLine,o),Af.number(r)&&this.addMetricValue(vf.monitorColumn,r),s&&this.setMonitorCode(s),this}setTime(e){return Af.undefined(e)||(this._time=e,this.addMetricValue(vf.time,e)),this}setPlatform(e){return e&&(this._platform=e),this}timing(e){const t=Date.now();return this._startTime>0?(this._endTime=t,this.addMetricValue(e||vf.duration,this._endTime-this._startTime)):this._startTime=t,this}setDuration(e){return Af.undefined(e)||this.addMetricValue(vf.duration,e),this}getCode(){return this.code}getName(){return this.name}getMetrics(){return Object.assign({},this.metrics)}getCategories(){return Object.assign({},this.categories)}getInternalData(){return this.internalData}getData(){return Object.assign(Object.assign({},this.metrics),this.categories)}getValue(e){return this.metrics[e]||this.categories[e]}setResultType(e){return this.addCategoryValue(vf.resultType,e),this}setResultTypeSuccess(){return this.setResultType(yf.success),this}setResultTypeFail(){return this.setResultType(yf.fail),this}setResultTypeCancel(){return this.setResultType(yf.cancel),this}setResultTypeTimeout(){return this.setResultType(yf.timeout),this}getLevel(){return this.level}getMonitorId(){return this.code&&this.code.ID}getMonitorDomain(){return this.code&&this.code.domain}toJSON(){return{name:this.name,categories:this.getCategories(),metrics:this.getMetrics()}}addInternalData(e){return Object.assign(this.internalData,e),this}hasErrorInfo(){return!Af.undefined(this.getValue(vf.errorCode))||!Af.undefined(this.getValue(vf.errorMsg))}tagsInline(){return 0===this.tags.size?"":Array.from(this.tags).reduce(((e,t)=>`${e}${t?If.tagSeperator+t:""}`))}}const Ff={createMonitorBuilder(e){const{MonitorClass:t}=e,n=e;return function(e){const o=Object.assign({service:n},e);let r;return r=t?new t(o):new Hf(o),r}}};var Kf;!function(e){e.INIT_START="initStart",e.INIT_LOAD_ENGINE_RESULT="initLoadEngineResult",e.INIT_STORAGE_START="initStorageStart",e.INIT_STORAGE_RESULT="initStorageResult",e.TIMELINE_INIT="timelineInit",e.TIMELINE_INIT_GET_LARK_DOMAIN="timelineInitGetLarkDomain",e.TIMELINE_INIT_GET_CONFIG_URL="timelineInitGetConfigUrl",e.TIMELINE_INIT_LOAD_MAIN="timelineInitLoadMain",e.TIMELINE_INIT_LOAD_ENGINE="timelineInitLoadEngine",e.DIAGNOSE_ENGINE_RESULT="diagnoseEngineResult",e.API_ERROR="apiError",e.MOUNT_CREATOR_START="mountCreatorStart",e.MOUNT_CREATOR_CHECK_ENGINE_RESULT="mountCreatorCheckEngineResult",e.MOUNT_CREATOR_GET_BLOCK_START="mountCreatorGetBlockStart",e.MOUNT_CREATOR_GET_BLOCK_RESULT="mountCreatorGetBlockResult",e.MOUNT_CREATOR_GENERATE_BLOCK_START="mountCreatorGenerateBlockStart",e.MOUNT_CREATOR_GENERATE_BLOCK_RESULT="mountCreatorGenerateBlockResult",e.MOUNT_CREATOR_DESTROY="mountCreatorDestroy",e.MOUNT_SETTING_START="mountSettingStart",e.MOUNT_BLOCK_START="mountBlockStart",e.MOUNT_BLOCK_CHECK_ENGINE_RESULT="mountBlockCheckEngineResult",e.MOUNT_BLOCK_TIMEOUT="mountBlockTimeout",e.MOUNT_BLOCK_BY_ID_START="mountBlockByIdStart",e.MOUNT_BLOCK_BY_ID_GET_ENTITY_START="mountBlockByIdGetEntityStart",e.MOUNT_BLOCK_BY_ID_GET_ENTITY_RESULT="mountBlockByIdGetEntityResult",e.LIFECYCLE_CREATOR_ONCONFIGLOADED="lifecycleCreatorOnconfigloaded",e.LIFECYCLE_CREATOR_ONLOADED="lifecycleCreatorOnloaded",e.LIFECYCLE_CREATOR_ONCONTENTLOADED="lifecycleCreatorOncontentloaded",e.LIFECYCLE_CREATOR_ONLOADFAIL="lifecycleCreatorOnloadfail",e.LIFECYCLE_CREATOR_ONRELOAD="lifecycleCreatorOnreload",e.LIFECYCLE_CREATOR_ONSUBMIT="lifecycleCreatorOnsubmit",e.LIFECYCLE_CREATOR_ONCANCEL="lifecycleCreatorOncancel",e.LIFECYCLE_BLOCK_ONCONFIGLOADED="lifecycleBlockOnconfigloaded",e.LIFECYCLE_BLOCK_ONLOADED="lifecycleBlockOnloaded",e.LIFECYCLE_BLOCK_ONCONTENTLOADED="lifecycleBlockOncontentloaded",e.LIFECYCLE_BLOCK_ONLOADFAIL="lifecycleBlockOnloadfail",e.LIFECYCLE_BLOCK_ONRELOAD="lifecycleBlockOnreload",e.LIFECYCLE_BLOCK_ONOPENSETTING="lifecycleBlockOnopensetting",e.LIFECYCLE_BLOCK_ONUPDATEREADY="lifecycleBlockOnupdateready",e.CONFIG_SET_DEBUG_PORT_START="configSetDebugPortStart",e.CONFIG_SET_DEBUG_PORT_RESULT="configSetDebugPortResult",e.CONFIG_SET_ENV_START="configSetEnvStart",e.CONFIG_SET_ENV_RESULT="configSetEnvResult",e.UNMOUNT_START="unmountStart",e.UNMOUNT_BLOCK_ID="unmountBlockId",e.UNMOUNT_BLOCK_INSTANCE="unmountBlockInstance",e.UNMOUNT_END="unmountEnd",e.UPDATE_THEME_START="updateThemeStart",e.UPDATE_THEME_END="updateThemeEnd",e.GET_BLOCK_LIST_START="getBlockListStart",e.GET_BLOCK_LIST_REQUEST_RESULT="getBlockListRequestResult",e.GET_BLOCK_LIST_RESULT="getBlockListResult",e.COLLABORATION_SUBSCRIBE_START="collaborationSubscribeStart",e.COLLABORATION_SUBSCRIBE_RESULT="collaborationSubscribeResult",e.COLLABORATION_UNSUBSCRIBE_START="collaborationUnsubscribeStart",e.COLLABORATION_UNSUBSCRIBE_RESULT="collaborationUnsubscribeResult",e.COLLABORATION_SOCKET_RECONNECT="collaborationSocketReconnect",e.COLLABORATION_SOCKET_CONNECT_START="collaborationSocketConnectStart",e.COLLABORATION_SOCKET_CONNECT_RESULT="collaborationSocketConnectResult",e.COLLABORATION_AUTHORITY_START="collaborationAuthorityStart",e.COLLABORATION_AUTHORITY_RESULT="collaborationAuthorityResult",e.COLLABORATION_UPDATE_TIME="collaborationUpdateTime",e.COLLABORATION_FETCH_INIT_VERSION="collaborationFetchInitVersion",e.COLLABORATION_FETCH_INIT_VERSION_RESULT="collaborationFetchInitVersionResult",e.COLLABORATION_RECEIVE_SUBSCRIBE_MESSAGE="collaborationReceiveSubscribeMessage",e.COLLABORATION_UPDATE_VIEW="collaborationUpdateView",e.COLLABORATION_UPDATE_MSG="collaborationUpdateMsg",e.COLLABORATION_FALLBACK_FETCH="collaborationFallBackFetch",e.COLLABORATION_WEBSOCKET_CONNECT="collaborationWebsocketConnect",e.COPY_BLOCK_START="copyBlockStart",e.COPY_BLOCK_RESULT="copyBlockResult",e.BULK_PASTE_BLOCK_START="bulkPasteBlockStart",e.BULK_PASTE_BLOCK_PARAMS="bulkPasteBlockParams",e.BULK_PASTE_BLOCK_RESULT="bulkPasteBlockResult",e.LOAD_BLOCK_START="loadBlockStart",e.LOAD_BLOCK_RESULT="loadBlockResult",e.LOAD_CREATOR_START="loadCreatorStart",e.LOAD_CREATOR_RESULT="loadCreatorResult",e.LOAD_ENGINE_START="loadEngineStart",e.LOAD_ENGINE_RESULT="loadEngineResult",e.REQUEST_SERVICE_START="requestServiceStart",e.REQUEST_SERVICE_RESULT="requestServiceResult",e.INIT_LOAD_ENGINE_SCRIPT_START="initLoadEngineScriptStart",e.INIT_LOAD_ENGINE_SCRIPT_RESULT="initLoadEngineScriptResult"}(Kf||(Kf={}));var Gf,Jf=Kf;!function(e){e.blockitLoader="blockit_loader",e.staticResource="static_resource_config"}(Gf||(Gf={}));const qf={[Gf.blockitLoader]:{blockitVersion:"",blockEngineVersion:"",enableSlardar:!1,enableTea:!1,customEngines:[],disableAutoES6:!1,cdnDomain:""},[Gf.staticResource]:{usePrivateCDN:!1,privateCDNPath:""}};class Wf{constructor(t){e(this,"root",void 0),this.root=t||"blockit"}get(){try{const e=localStorage.getItem(this.root+"_data")||"",t=localStorage.getItem(this.root+"_meta")||"";return{meta:JSON.parse(t),data:JSON.parse(e)}}catch(e){return}}set(e){e.data&&localStorage.setItem(this.root+"_data",JSON.stringify(e.data)),e.meta&&localStorage.setItem(this.root+"_meta",JSON.stringify(e.meta))}}class $f{constructor(t){e(this,"config",void 0),e(this,"storage",void 0),this.config=t,this.storage=new Wf("blockit")}static getLocalSetting(){const e="blockit_loader",t=new Wf("blockit").get();return t?t.data[e]:qf[e]}getSetting(){const{blockitVersion:e,blockEngineVersion:t,env:n,userID:o,tenantID:r}=this.config,i=oi({env:n.env,region:n.region,domain:n.domain},"internal-api-lark-api"),a=this.storage.get(),s={platform:"web",blockit_version:e,blockit_host:n.host,app_engine_version:t,user_id:o,tenant_id:r,language:n.locale},c=a&&a.meta&&a.meta.blockit_version===e&&a.meta.user_id===o;if(a&&c){const{meta:{user_etag:e,data_etag:t,version_code:n}}=a;s.data_etag=t,s.version_code=n,s.user_etag=e}const l=function(e){const t=fetch(e).then((e=>e.json()));return Si(t,{timer:10,timeoutErrorMsg:"Fetch timeout, url: "+e})}(i+"/settings/v3/?"+new URLSearchParams(s)).then((t=>{const n={...t.meta,user_id:o,blockit_version:e};if(t.data.hasOwnProperty(Gf.blockitLoader)||t.data.hasOwnProperty(Gf.staticResource)){const e={meta:n,data:{}};if(t.data.hasOwnProperty(Gf.blockitLoader)?e.data[Gf.blockitLoader]=t.data[Gf.blockitLoader]:e.data[Gf.blockitLoader]=a?a.data[Gf.blockitLoader]:qf[Gf.blockitLoader],t.data.hasOwnProperty(Gf.staticResource)){const n=t.data[Gf.staticResource];e.data[Gf.staticResource]={usePrivateCDN:n.use_private_cdn,privateCDNPath:n.private_cdn_prefix}}else e.data[Gf.staticResource]=a?a.data[Gf.staticResource]:qf[Gf.staticResource];return this.storage.set(e),e.data}return Object.keys(t.data).length>0&&this.storage.set({meta:n}),qf}));if(a&&c){l.catch((()=>{})),l.useCache=!0;const e=Promise.resolve(a.data);return e.useCache=!0,e}return l.useCache=!1,l}}function Yf(e){return"string"!=typeof e?"encrypt fail":Tf("08a441"+Sf(e+"42b91e").toString()).toString()}const Qf=$f.getLocalSetting(),Xf=(new nd).instance,Zf=new wf("blockit"),ep=window.blockitInternal.options,{region:tp,env:np,is_ide:op=!1}=ep,rp={report(e){const{name:t,metrics:n,categories:o}=e;Xf("emit","custom",{event_name:t,metrics:n,tags:o})},log(e){const{content:t,level:n}=e;let o=t;const r=t.indexOf("{"),i={};if(r>-1){const e=JSON.parse(o.slice(r));o="["+e.monitor_code+"] "+e.monitor_message+"\n",i.trace_id=e.trace_id,i.log_id=e.log_id,i.host_log_id=e.host_log_id,delete e.monitor_domain,delete e.monitor_id,delete e.monitor_code,delete e.monitor_message,delete e.monitor_tags,delete e.log_id,delete e.host_log_id,o+=JSON.stringify(e)}Xf("emit","log",{value:o,tags:i,level:n===mf.normal?"info":"error"})}},ip=Ff.createMonitorBuilder(rp);Xf("config",{bid:"boe"===np?"feishu_blockit_sdk_debug":"feishu_blockit_sdk",pid:`${location.host}${Yf(location.pathname)}`,env:Qf.enableSlardar?"production":"development",domain:"feishu"===tp?"slardar-bd.feishu.cn":"slardar-bd.larksuite.com",performanceAuto:!1,hookPath:!1,hookXHR:!1,hookFetch:!1,enableFMP:!1,enableCatchJSError:!1,enableCatchJSErrorV2:!0,enableCatchGlobalJSError:!1,catchUnhandledRejection:!1,catchUnhandledRejectionV2:!1,enableFPSJankTimesMonitor:!1,enableCrash:!1,enablePerformance:!1,enableBreadcrumb:!1,hookConsole:!1,hookDom:!1,sampleRate:1,onlyUseLocalSetting:!0,context:{version:"1.13.7",blockit_log_id:vi(),app_type:"block",app_id:"",is_ide:!!op},maxBatchReportLength:20,batchReportWait:1e3,beforeSend:e=>({...e,url:Yf(e.url)})}),Zf.init({app_id:"feishu"===tp?1271:2192,channel:"feishu"===tp?"cn":"va",disable_sdk_monitor:!0,disable_session:!0,channel_domain:"feishu"===tp?"https://mcs-bd.feishu.cn":"https://mcs-bd.larksuite.com"}),Zf.config({disable_auto_pv:!0,_staging_flag:"online"!==np||op?1:0}),Qf.enableTea&&Zf.start();var ap={level:mf,events:Jf,setContext(e){const t={context:e},n={evtParams:{is_login:"true",platform:navigator.userAgent.includes("Lark/")?"lark":"web",blockit_version:"1.13.7"}},{userId:o,tenantId:r,larkVersion:i,hostExtension:a={}}=e;e.host&&(t.context.block_host=e.host,n.evtParams.container_type=e.host);const s=e.containerID||a.containerID;if(s){const o=Yf(s);n.evtParams.container_id=o,a.containerID=o,e.containerID&&delete t.context.containerID}let c,l;return o&&(c=Yf(o),t.slardar_web_id=c,t.context.user_id=c,n.user_unique_id=c,n.evtParams.is_login=Boolean("0"===o).toString(),n.evtParams.user_id=c,delete t.context.userId),r&&(l=Yf(r),t.context.tenant_id=l,n.evtParams.tenant_id=l,delete t.context.tenantId),i&&(t.context.lark_version=i,n.evtParams.app_version=i),Object.keys(a).forEach((e=>{t.context[`hostExtension-${e}`]=a[e]})),a.appFrom&&(n.evtParams.app_from=a.appFrom),delete t.context.hostExtension,Xf("config",t),Zf.config(n),{encryptUserId:c,encryptTenantId:l}},performance(e){const t=performance.now(),n=this,o="op_blockit_performance";return n.log({event:e.start,categories:e.categories,trace:e.trace},!1,o),{duration:0,success(r){const i=performance.now();this.duration=i-t,n.log({event:e.end,categories:{...e.categories,...null==r?void 0:r.categories},trace:e.trace},!0,o).setResultTypeSuccess().setDuration(this.duration).flush()},fail(t){const o=n.log({event:e.end,categories:{...e.categories,...null==t?void 0:t.categories},trace:e.trace},!0).setResultTypeFail().setLevel(mf.error);t.error&&o.setError(t.error),o.flush()}}},timer(e){const t=this;e.duration&&t.log({event:e.event,categories:e.categories,trace:e.trace},!0,"op_blockit_performance").setResultTypeSuccess().setDuration(e.duration).flush()},log(e,t,n){e.categories&&e.categories.blockTypeID&&(e.categories.identifier=e.categories.blockTypeID),e.categories&&e.categories.blockID&&(e.categories.block_id=e.categories.blockID);const o=id[e.event],r=ip({name:n||"op_blockit_log",code:{domain:o.domain,code:o.code,level:e.level||o.level||mf.normal,message:o.message},categories:{...e.categories,is_online:Boolean(navigator.onLine).toString()}});return e.trace&&r.tracing(e.trace.traceId),t||r.flush(),r},collect(e){Zf(e.name,{instance:"blockit",...e.categories})},reportJSError(e,t){this.log({event:this.events.API_ERROR,level:this.level.error,categories:{name:t||""}},!0).setResultTypeFail().setError(e).flush(),Xf("captureException",e)},utils:{serialize(e){if("string"==typeof e)return e;if("boolean"==typeof e||"number"==typeof e)return e.toString();try{return JSON.stringify(e)}catch(e){return"[Unknown]"}},sample(e){try{const t=wi(e);return"string"==typeof t?t:JSON.stringify(wi(e))}catch(e){return"[Unknown]"}}}};const sp=new yi;let cp;!function(e){e[e.ISV_LOADING_TIMEOUT=-1]="ISV_LOADING_TIMEOUT",e[e.ENGINE_LOADING_TIMEOUT=-4001]="ENGINE_LOADING_TIMEOUT",e[e.GET_APP_CODE_FAIL=-4025]="GET_APP_CODE_FAIL",e[e.APP_CHECK_FAIL=-4028]="APP_CHECK_FAIL",e[e.APP_META_INVALID=-50102]="APP_META_INVALID",e[e.BASIC_LIB_VERSION_LOW=-50002]="BASIC_LIB_VERSION_LOW",e[e.NETWORK_ERROR_META=-50107]="NETWORK_ERROR_META",e[e.NETWORK_ERROR_PACKAGE=-50203]="NETWORK_ERROR_PACKAGE",e[e.NETWORK_ERROR_SDK=-50305]="NETWORK_ERROR_SDK",e[e.NETWORK_ERROR_SETTINGS=-50310]="NETWORK_ERROR_SETTINGS",e[e.NETWORK_ERROR_APPCHECK=-50004]="NETWORK_ERROR_APPCHECK",e[e.NEED_UPGRADE_STATUS=0]="NEED_UPGRADE_STATUS",e[e.AVAILABLE=1]="AVAILABLE",e[e.UNABLE_DISPLAY=2]="UNABLE_DISPLAY",e[e.NOT_AUHT=3]="NOT_AUHT",e[e.PERSONAL_ACCOUNT=4]="PERSONAL_ACCOUNT",e[e.DEACTIVATE=100]="DEACTIVATE",e[e.UNINSTALL=101]="UNINSTALL",e[e.OFFLINE=102]="OFFLINE",e[e.DELETE=103]="DELETE",e[e.NO_PERMISSION=200]="NO_PERMISSION",e[e.DISABLE_INSTALL_UNPBULISH_APP=201]="DISABLE_INSTALL_UNPBULISH_APP",e[e.DISABLE_INSTALL_OFFILE_APP=202]="DISABLE_INSTALL_OFFILE_APP",e[e.DISABLE_INSTALL_OTHER_TENANT_APP=203]="DISABLE_INSTALL_OTHER_TENANT_APP",e[e.INSTALL_NOT_START=204]="INSTALL_NOT_START",e[e.INSTALL_IN_DEACTIVATE=205]="INSTALL_IN_DEACTIVATE",e[e.INSTALL_IN_INIT=206]="INSTALL_IN_INIT",e[e.INSTALL_UPDATE_NOT_START=207]="INSTALL_UPDATE_NOT_START",e[e.INSTALL_EXPIRE_STOP=208]="INSTALL_EXPIRE_STOP",e[e.INSTALL_LARK_EXPIRE_STOP=209]="INSTALL_LARK_EXPIRE_STOP",e[e.IN_BLOCK_VISIBLE=210]="IN_BLOCK_VISIBLE",e[e.DISABLE_APPLY_VISIBLE=211]="DISABLE_APPLY_VISIBLE",e[e.DISABLE_INSTALL_ISV_APP=212]="DISABLE_INSTALL_ISV_APP",e[e.NOT_SUPPORT_ABILITY=300]="NOT_SUPPORT_ABILITY",e[e.NOT_SUPPORT_HOST=301]="NOT_SUPPORT_HOST",e[e.APP_NOT_EXIST=302]="APP_NOT_EXIST",e[e.NEED_UPGRADE=303]="NEED_UPGRADE"}(cp||(cp={}));var lp=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/light/deactivate.35a2bb07c5356234.svg",up=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/dark/deactivate.5fb86eefa3920af4.svg",dp=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/light/default-error.5e5c37241b79dcd6.svg",hp=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/dark/default-error.78d201b7f1fd77ca.svg",fp=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/light/network-error.6c176ddd54f0c23a.svg",pp=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/dark/network-error.c06f7d4374b3e647.svg",gp=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/light/no-permission.3f87be7512db751a.svg",_p=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/dark/no-permission.da830db7150c0cdc.svg",mp=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/light/not-login.7668981b20f91daf.svg",vp=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/dark/not-login.9974b00c703cc3c1.svg",bp=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/light/not-support.35a2bb07c5356234.svg",yp=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/dark/not-support.5fb86eefa3920af4.svg",kp=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/light/unable-display.07a11bfd40dbed09.svg",wp=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/dark/unable-display.e63478be1a450c48.svg",Ep=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/light/uninstall.0bcec029a05bec40.svg",Sp=window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/dark/uninstall.fe2c733ffd271907.svg";const Tp={upgrade:{light:window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/light/upgrade.96e001e0a7347283.svg",dark:window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/dark/upgrade.e2bdee21f31536f4.svg"},display:{light:kp,dark:wp},notSupport:{light:bp,dark:yp},deactivate:{light:lp,dark:up},noPermission:{light:gp,dark:_p},uninstall:{light:Ep,dark:Sp},networkError:{light:fp,dark:pp},notLogin:{light:mp,dark:vp},defaultError:{light:dp,dark:hp},personalAccount:{light:window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/light/personal-account.1032d14b4cd6ef3e.svg",dark:window.blockitInternal.CDNDomain+"/goofy/lark/blockit/browser/dark/personal-account.5ce4c49a3e346848.svg"}},Ip={[cp.BASIC_LIB_VERSION_LOW]:Tp.upgrade,[cp.NEED_UPGRADE_STATUS]:Tp.upgrade,[cp.UNABLE_DISPLAY]:Tp.display,[cp.NOT_AUHT]:Tp.notLogin,[cp.PERSONAL_ACCOUNT]:Tp.personalAccount,[cp.DEACTIVATE]:Tp.deactivate,[cp.UNINSTALL]:Tp.uninstall,[cp.OFFLINE]:Tp.deactivate,[cp.DELETE]:Tp.deactivate,[cp.NO_PERMISSION]:Tp.noPermission,[cp.DISABLE_INSTALL_UNPBULISH_APP]:Tp.deactivate,[cp.DISABLE_INSTALL_OFFILE_APP]:Tp.deactivate,[cp.DISABLE_INSTALL_OTHER_TENANT_APP]:Tp.deactivate,[cp.INSTALL_NOT_START]:Tp.deactivate,[cp.INSTALL_IN_DEACTIVATE]:Tp.deactivate,[cp.INSTALL_IN_INIT]:Tp.deactivate,[cp.INSTALL_UPDATE_NOT_START]:Tp.deactivate,[cp.INSTALL_EXPIRE_STOP]:Tp.deactivate,[cp.INSTALL_LARK_EXPIRE_STOP]:Tp.deactivate,[cp.IN_BLOCK_VISIBLE]:Tp.noPermission,[cp.DISABLE_APPLY_VISIBLE]:Tp.noPermission,[cp.DISABLE_INSTALL_ISV_APP]:Tp.deactivate,[cp.NOT_SUPPORT_ABILITY]:Tp.notSupport,[cp.NOT_SUPPORT_HOST]:Tp.notSupport,[cp.APP_NOT_EXIST]:Tp.notSupport,[cp.NEED_UPGRADE]:Tp.upgrade,[cp.NETWORK_ERROR_META]:Tp.networkError,[cp.NETWORK_ERROR_PACKAGE]:Tp.networkError,[cp.NETWORK_ERROR_SDK]:Tp.networkError,[cp.NETWORK_ERROR_SETTINGS]:Tp.networkError,[cp.NETWORK_ERROR_APPCHECK]:Tp.networkError},Op={[mi.code.UnknownError]:Tp.defaultError,[mi.code.RequestError]:Tp.networkError,[mi.code.ImportError]:Tp.networkError,[mi.code.NetworkError]:Tp.networkError,[mi.code.DiagnoseError]:Tp.upgrade},Cp=(e,t,n)=>{const o="OPError"===n?Op:Ip;if(!o.hasOwnProperty(e))return(e=>Tp.defaultError[e])(t);return o[e][t]},Lp={dark:{container:{border:"1px solid rgba(240, 240, 240, 0.2)",backgroundColor:"#2E2E2E"},statusButton:{default:{backgroundColor:"transparent",border:"1px solid #4382FF",color:"#4382FF"},hover:{backgroundColor:"rgba(67, 130, 255, 0.2)",border:"1px solid #4382FF",color:"#4382FF"},active:{backgroundColor:"rgba(67, 130, 255, 0.3);",border:"1px solid #4382FF",color:"#4382FF"}},content:{color:"#646A73"},link:{color:"#4382FF"}},light:{container:{border:"1px solid #dee0e3",backgroundColor:"#ffffff"},statusButton:{default:{backgroundColor:"transparent",border:"1px solid #3370ff",color:"#3370ff"},hover:{backgroundColor:"#e1eaff",border:"1px solid #3370ff",color:"#3370ff"},active:{backgroundColor:"#bacefd",border:"1px solid #3370ff",color:"#3370ff"}},content:{color:"#646a73"},link:{color:"#3370ff"}}},Rp=e=>{const{border:t,backgroundColor:n}=e;return`\n    display: flex;\n    box-sizing: border-box;\n    justify-content: center;\n    align-items: center;\n    min-height: 160px;\n    max-width: 100%;\n    width: 100vw;\n    background-color: ${n};\n    border: ${t};\n    border-radius: 4px;\n    padding: 24px 0;\n    height: 100%;\n    overflow: hidden;\n  `};function Np(e,t){return e.appendChild(t),()=>{e.removeChild(t)}}function Ap(e,t){return`\n  .block-status__button__${e} {\n    white-space: nowrap;\n    display: inline-block;\n    height: 32px;\n    border: ${t.statusButton.default.border};\n    box-sizing: border-box;\n    border-radius: 4px;\n    color: ${t.statusButton.default.color};\n    cursor: pointer;\n    font-size: 14px;\n    line-height: 20px;\n    padding: 6px 16px;\n    transition: all .3s cubic-bezier(.645,.045,.355,1);\n    background-color: ${t.statusButton.default.backgroundColor};\n  }\n\n  .block-status__button__${e}:hover {\n    background-color: ${t.statusButton.hover.backgroundColor};\n  }\n\n  .block-status__button__${e}:active {\n    background-color: ${t.statusButton.active.backgroundColor};\n  }\n\n  .block-status__icon__${e} {\n    width: 80px;\n    height: 80px;\n    display: block;\n    margin: 0 auto 4px;\n  }\n\n  .block-status__content__${e} {\n    font-size: 14px;\n    line-height: 22px;\n    color: ${t.content.color};\n    white-space: pre-wrap;\n    cursor: default;\n    user-select: none;\n  }\n  .block-content__link__${e} {\n    color: ${t.link.color}; \n    cursor: pointer;\n  }\n    `}const xp=new class{constructor(){e(this,"listeners",[]),e(this,"namespace",void 0),e(this,"db",void 0),e(this,"task",null)}init(e){this.namespace=`__BLOCKIT_${e}`,this.db||this.task||(Ti||(Ti=function(e,t="blockit_sdk",n=Ei){const o=[];return function r(i){return new Promise(((a,s)=>{const c=indexedDB.open(t);c.onsuccess=()=>{const e=c.result;if(o.push(e),e.objectStoreNames.length&&!e.objectStoreNames.contains(i)){o.forEach((e=>e.close())),o.length=0;const e=indexedDB.deleteDatabase(t);e.onsuccess=()=>{r(i).then(a,s)},e.onerror=s}else a(e)},c.onerror=s,c.onupgradeneeded=()=>{const t=c.result;if(!t.objectStoreNames.contains(i)){const o=t.createObjectStore(i,{keyPath:e});n(o),o.transaction.oncomplete=()=>{a(t)},o.transaction.onerror=s}}}))}}("blockID")),this.task=Ti(this.namespace).then((e=>{this.db=e,this.task=null})))}handlerFactory(e,...t){return this.task?this.task.then((()=>e(...t)),(()=>{})):this.db?e(...t):Promise.resolve()}changeHandler(e){for(let t=0,n=this.listeners.length;t<n;t++)this.listeners[t](e)}get(e){return this.handlerFactory((()=>function(e,t,n){return new Promise(((o,r)=>{if(!e.objectStoreNames.contains(t))return o();const i=e.transaction(t).objectStore(t).get(n);i.onsuccess=()=>o(i.result||void 0),i.onerror=r}))}(this.db,this.namespace,e)))}add(e){return this.handlerFactory((()=>function(e,t,n){return new Promise(((o,r)=>{if(!e.objectStoreNames.contains(t))return o();const i=e.transaction(t,"readwrite").objectStore(t).add(n);i.onsuccess=()=>o(),i.onerror=r}))}(this.db,this.namespace,e)))}update(e){return this.handlerFactory((()=>function(e,t,n){return new Promise(((o,r)=>{if(!e.objectStoreNames.contains(t))return o();const i=e.transaction(t,"readwrite").objectStore(t).put(n);i.onsuccess=()=>o(),i.onerror=r}))}(this.db,this.namespace,e).then((()=>this.changeHandler(e)))))}delete(e){return this.handlerFactory((()=>function(e,t,n){return new Promise(((o,r)=>{if(!e.objectStoreNames.contains(t))return o();const i=e.transaction(t).objectStore(t).delete(n);i.onsuccess=()=>o(),i.onerror=r}))}(this.db,this.namespace,e).then((()=>this.changeHandler(e)))))}onChange(e){return this.listeners.push(e),bi.bind(null,this.listeners,e)}},Dp={fetch:(e,t,n)=>{const o=vi(),r=null==n?void 0:n.createTraceContext().performance({start:ap.events.REQUEST_SERVICE_START,end:ap.events.REQUEST_SERVICE_RESULT,categories:{url:e,request_id:o}});return new Promise(((n,i)=>{fetch(e,{credentials:"include",...t,headers:{"X-Request-Id":o,...null==t?void 0:t.headers}}).then((t=>t.ok?t.json().then((e=>(0===e.code?r&&r.success({categories:{error_code:t.status.toString(),error_msg:e.msg,code:e.code.toString(),tt_log_id:t.headers.get("x-tt-logid")}}):r&&r.fail({categories:{error_code:t.status.toString(),error_msg:e.msg,code:e.code.toString(),tt_log_id:t.headers.get("x-tt-logid")}}),n(e)))):(r&&r.fail({categories:{error_code:t.status.toString(),error_msg:t.statusText,tt_log_id:t.headers.get("x-tt-logid")}}),i(new mi({code:mi.code.RequestError,message:`[${t.status}] ${t.statusText}, URL: ${e}`}))))).catch((t=>{const n=`Failed to fetch, URL: ${e}, ${t.message}`;r&&r.fail({categories:{error_msg:n}}),i(new mi({code:mi.code.NetworkError,message:n}))}))}))},ui:{showLoading:function(e,t){const{getTheme:n}=t,o=n(),r=document.createElement("div"),i=r.attachShadow({mode:"closed"}),a=document.createElement("img"),{container:s}=Lp[o];a.src="data:image/svg+xml,%3Csvg%20width%3D%2236%22%20height%3D%2236%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M18.302%200C28.084%200%2036%208.066%2036%2018s-7.916%2018-17.698%2018c-2.052%200-4.059-.356-5.953-1.044a1.542%201.542%200%20111.057-2.9%2014.31%2014.31%200%20004.896.858c8.06%200%2014.607-6.67%2014.607-14.914S26.362%203.086%2018.302%203.086c-5.812%200-11.004%203.499-13.34%208.83a1.546%201.546%200%2001-2.036.794%201.542%201.542%200%2001-.796-2.032C4.951%204.241%2011.243%200%2018.302%200z%22%20fill%3D%22%23BBBFC4%22%2F%3E%3C%2Fsvg%3E",a.className="block-loading",r.setAttribute("status","loading"),r.setAttribute("style",Rp(s)),i.appendChild(function(e){const t=document.createElement("style"),n=document.createTextNode(e);return t.appendChild(n),t}("\n    @keyframes block-loading {\n      from {\n        transform: rotate(0);\n      }\n      to {\n        transform: rotate(360deg);\n      }\n    }\n\n    .block-loading {\n      width: 36px;\n      height: 36px;\n      animation: block-loading 1s linear infinite;\n    }\n  ")),i.appendChild(a);const c=e=>{const t=Lp[e];r.setAttribute("style",Rp(t.container))};sp.on("themeChange",c);const l=Np(e,r);return()=>{sp.off("themeChange",c),l()}},showError:function(e,t,n){const o=document.createElement("div"),{getTheme:r}=n,i=r(),a=Cp(e.status,i,e.errorType),s=Lp[i],c=e.tips.content.replace(/{(\w+)}/,"").replace("\\n","\n");o.setAttribute("status","error"),o.setAttribute("style",Rp(s.container));const l=vi(),u=`block-status__icon__${l}`,d=navigator.onLine,h=`\n    <style>\n      ${Ap(l,s)}\n    </style>\n    <div style="text-align: center">\n      ${d?`<img class="${u}" src="${a}" />`:"<div></div>"}\n      <div class="block-status__content__${l}">${c}</div>\n      <div style="margin-top: 16px; display: ${0===e.tips.buttons.length?"none":"block"}"></div>\n    </div>\n  `;o.innerHTML=h,Object.keys(e.tips.params).forEach((t=>{const n=document.createElement("a");n.setAttribute("class",`block-content__link__${l}`),n.onclick=e.tips.params[t].handler,n.innerText=e.tips.params[t].name,o.children[1].children[1].appendChild(n)})),e.tips.buttons.forEach((e=>{const t=document.createElement("div");t.innerText=e.name,t.onclick=e.handler,t.className=`block-status__button__${l}`,o.children[1].children[2].appendChild(t)}));const f=t=>{const n=Lp[t],r=o.querySelector("style");null!=r&&(r.innerHTML=Ap(l,n)),o.setAttribute("style",Rp(n.container));const i=o.querySelector(`.${u}`);null!=i&&i.setAttribute("src",Cp(e.status,t,e.errorType))};sp.on("themeChange",f);const p=Np(t,o);return()=>{sp.off("themeChange",f),p()}}},storage:{init:(...e)=>xp.init(...e),get:(...e)=>xp.get(...e),add:(...e)=>xp.add(...e),update:(...e)=>xp.update(...e),delete:(...e)=>xp.delete(...e),onChange:(...e)=>xp.onChange(...e)}};function Bp(e=qr,t,n=0){return(o,r)=>{const i=oi(e,o.subDomain)+o.path,a={method:o.method,body:JSON.stringify(r.data),...r,headers:{"Content-Type":"text/plain;charset=utf-8",...r.headers}},s=()=>Dp.fetch(i,a,t);let c=s();for(let e=0;e<n;e++)c=c.catch((()=>s()));return c=c.then((e=>{if(0===e.code)return e.data;throw new mi({code:mi.code.RequestError,message:`[${e.code}] ${e.msg}, URL: ${i}`})})),c}}var Pp,zp,Mp;!function(e){e[e.trace=1]="trace",e[e.normal=2]="normal",e[e.warn=3]="warn",e[e.error=4]="error",e[e.fatal=5]="fatal"}(Pp||(Pp={})),function(e){e.traceId="trace_id",e.errorCode="error_code",e.errorMsg="error_msg",e.time="time",e.duration="duration",e.monitorLevel="monitor_level",e.monitorDomain="monitor_domain",e.monitorCode="monitor_code",e.monitorID="monitor_id",e.monitorMessage="monitor_message",e.monitorTags="monitor_tags",e.monitorFile="monitor_file",e.monitorFunction="monitor_function",e.monitorLine="monitor_line",e.monitorColumn="monitor_column",e.monitorStack="monitor_stack",e.resultType="result_type"}(zp||(zp={})),function(e){e.BATCH="BATCH"}(Mp||(Mp={}));var jp,Up,Vp,Hp;!function(e){e.success="success",e.fail="fail",e.cancel="cancel",e.timeout="timeout"}(jp||(jp={})),function(e){e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.fatal=5]="fatal"}(Up||(Up={})),function(e){e.warn="warn",e.error="error"}(Vp||(Vp={})),function(e){e.sampleRate="sample_rate",e.traceSampleRate="trace_sample_rate",e.normalSampleRate="normal_sample_rate",e.warnSampleRate="warn_sample_rate",e.errorSampleRate="error_sample_rate",e.fatalSampleRate="fatal_sample_rate",e.rules="rules",e.priority="priority",e.filters="filters",e.key="key",e.values="values"}(Hp||(Hp={}));const Fp={logEnabled:!1,reportEnabled:!1,batchBlackListEnabled:!1,batchWhiteListEnabled:!1,batchBlackList:[],batchWhiteList:[],bizBlackList:[]};class Kp{constructor(e){this.hitBlackList=!1,this.hitWhiteList=!1,this._batchEnabled=!1,this._createTime=Date.now(),this.generateTraceId(e),this.batchReportEnabled=this.constructor.config.reportEnabled||!1,this.batchLogEnabled=this.constructor.config.logEnabled||!1}static setConfig(e){this.config=e}static resetConfig(){this.config=Object.assign({},Fp)}get blackListEnabled(){return this.constructor.config.batchBlackListEnabled||Fp.batchBlackListEnabled}get whiteListEnabled(){return this.constructor.config.batchWhiteListEnabled||Fp.batchWhiteListEnabled}get batchEnabled(){return this._batchEnabled}get traceId(){return this._traceId}set traceId(e){this._traceId=e}get createTime(){return this._createTime}generateSpan(){return new Kp(this)}reportTo(e){const{batchBlackListEnabled:t=Fp.batchBlackListEnabled,batchWhiteListEnabled:n=Fp.batchWhiteListEnabled,batchBlackList:o=Fp.batchBlackList,batchWhiteList:r=Fp.batchWhiteList}=this.constructor.config;return!this.hitBlackList&&t&&o.some((t=>this.matchRule(t,e)))&&(this.hitBlackList=!0),!this.hitBlackList&&!this.hitWhiteList&&this.batchReportEnabled&&n&&r.some((t=>this.matchRule(t,e)))&&(this.hitWhiteList=!0),this._monitorCache||(this._monitorCache=[]),!this.hitBlackList&&this._monitorCache.push(JSON.stringify(e)),this}finish(){const{batchLogEnabled:e,batchReportEnabled:t}=this;let n=t;return n&&(this.blackListEnabled&&this.hitBlackList||this.whiteListEnabled&&!this.hitWhiteList)&&(n=!1),{name:"monitor_batch_report",code:{domain:"monitor.base.batch",code:1e4,level:2,message:"monitor_batch_code"},categories:{batch:JSON.stringify(this._monitorCache),[zp.traceId]:this._traceId},internalData:{logEnabled:this.batchEnabled&&e,reportEnabled:this.batchEnabled&&n}}}parse(e){return"extensions"in e&&!("trace"in e)?(this._createTime=e.createTime,this._traceId=e.traceId):(this._createTime=e.trace.createTime,this._traceId=e.trace.traceId,this._batchEnabled=e.batchEnabled,e.monitorCache&&(this._monitorCache=[...e.monitorCache])),this}toJSON(){const e={trace:{createTime:this._createTime,traceId:this._traceId},batchEnabled:this._batchEnabled};return this._monitorCache&&(e.monitorCache=[...this._monitorCache]),e}serialize(){return JSON.stringify(this)}deserialize(e){const t=JSON.parse(e);return this.parse(t)}checkBatchEnabled(e){const t=this.constructor.config.bizBlackList;return!t||!t.includes(e)}subTrace(e){const t=new this.constructor(this);return e?this.checkBatchEnabled(e)?(t._batchEnabled=!0,t):(t._batchEnabled=this._batchEnabled,t):(t._batchEnabled=this.batchEnabled,t)}getTraceId(){return this._traceId}generateTraceId(e){let t;t=e?e.getTraceId():"1",this._traceId=function(e){return e?`${e}-${[...Array(8)].map((()=>Math.floor(36*Math.random()).toString(36))).join("")}`:""}(t)}matchRule(e,t){const n=t.getName(),o=t.getMonitorId(),r=t.getMonitorDomain(),{event_name:i=[],monitor_id:a=[],monitor_domain:s=[],monitor_domain_prefix:c=[]}=e;return!(!n||!i.some((e=>e===n)))||(!(!o||!a.some((e=>e===o)))||!(!r||!s.some((e=>e===r))&&!c.some((e=>r.startsWith(e)))))}}Kp.config=Fp;const Gp=function(e){const t={};let n=console;try{var o,r;(null===(o=window.blockitInternal.injectLibs)||void 0===o?void 0:o.nativeLogger)&&(n=null===(r=window.blockitInternal.injectLibs)||void 0===r?void 0:r.nativeLogger.logFactory.getLogger("frontend"))}catch(e){}return["trace","debug","info","warn","error"].forEach((o=>{t[o]=(t,...r)=>{const i=`${e}-${t}`;n[o]?n[o](i,...r):n.info(i,...r)}})),t}("Blockit");let Jp,qp,Wp;!function(e){e.TEMPLATE_CONFIG="templateConfig",e.CUSTOM_MESSAGE="customMessage"}(Jp||(Jp={})),function(e){e[e.Regular=0]="Regular",e[e.EmergencyBug=1]="EmergencyBug",e[e.CoreFeature=2]="CoreFeature"}(qp||(qp={})),function(e){e[e.Invoke=0]="Invoke",e[e.On=1]="On"}(Wp||(Wp={}));const $p=new Kp;class Yp{constructor(t){e(this,"hostLogID",void 0),e(this,"logID",void 0),e(this,"trace",void 0),this.logger=this.logger.bind(this),this.performance=this.performance.bind(this),this.logID=vi(),null!=t&&t.logID&&(this.hostLogID=t.logID),null!=t&&t.trace?this.trace=t.trace:this.trace=$p.generateSpan()}logger(e,t){const n={event:ap.events.INIT_START,level:ap.level.normal,trace:this.trace,categories:{log_id:this.logID}};return this.hostLogID&&(n.categories.host_log_id=this.hostLogID),"string"==typeof e?n.event=e:(n.event=e.name,e.categories&&Object.assign(n.categories,e.categories),e.level&&(n.level=e.level)),ap.log(n,t)}performance(e){const t={start:e.start,end:e.end,trace:this.trace,categories:{log_id:this.logID}};return this.hostLogID&&(t.categories.host_log_id=this.hostLogID),e.categories&&Object.assign(t.categories,e.categories),ap.performance(t)}timer(e){const t={event:e.name,duration:e.duration,trace:this.trace,categories:{log_id:this.logID}};return this.hostLogID&&(t.categories.host_log_id=this.hostLogID),e.categories&&Object.assign(t.categories,e.categories),ap.timer(t)}createTraceContext(){const e=new Yp({trace:this.createTraceSpan(),logID:this.hostLogID});return e.logID=this.logID,e}createTraceSpan(){return this.trace.generateSpan()}}function Qp(e){const t=new Yp(null==e?void 0:e.moreParams);return{...e,moreParams:t}}let Xp;const Zp={needWrap:!0,apiType:Wp.Invoke,handler:e=>{const{level:t="info"}=e,n=function(e){const{module:t="USER",message:n,level:o="info",tags:r={}}=e;let i="";try{i=JSON.stringify(n)}catch(e){i=""}const a={module:t,msg:i,level:o,tags:r};let s="";try{s=JSON.stringify(a)}catch(e){s=""}return s}(e);return function(){Xp||(Xp={},["trace","debug","info","warn","error"].forEach((e=>{Xp[e]=(t,...n)=>{qr.isFeishuNative?Gp[e](t,...n):console.log(t,...n)}})));return Xp}()[t](n),{errMsg:"saveLog:ok"}},params:{}};async function eg(e,t,n=qr){t||(t=new Yp);const o=(await Bp(n,t,1)(Xr[Qr.getBlockEntity],{data:{blockIDs:e}})).blocks;return e.map((e=>{const t=o[e];return t&&0===t.status?(t.entity.sourceMeta=JSON.parse(t.entity.sourceMeta||'""'),t.entity.sourceData=JSON.parse(t.entity.sourceData||'""'),{version:(t.versionStr||t.version||0).toString(),entity:t.entity}):null}))}async function tg(e,t,n=qr){return(await Bp(n,t)(Xr[Qr.fetchMessage],{data:{blockIDs:e}})).messages}const ng=new Map,og=new Map;function rg(e,t){if(void 0===t)return!0;const n=t.split(".").map((e=>Number(e))).filter((e=>"number"==typeof e&&!isNaN(e))),o=e.split(".").map((e=>Number(e))).filter((e=>"number"==typeof e&&!isNaN(e)));if(o.length!==n.length)return o.length>n.length;for(let e=0;e<o.length;e++)if(o[e]!==n[e])return o[e]>n[e];return!1}function ig(e,t){const n=Number.parseInt(e||"0")+t;return 10===n?"0":n.toString()}function ag(e,t){const n=e.split("");let o=n.length-1;n[o]=ig(n[o],1);let r="0"===n[o];for(;r;)o--,-1===o?(r=!1,n.unshift("1")):(n[o]=ig(n[o],1),r="0"===n[o]);return n.join("")===t}function sg(e,t,n){return("object"!=typeof t||null===t)&&("nil"===t?"number"==typeof n?e.splice(n,1):delete e[n]:e[n]=t,!0)}function cg(e,t){if(Array.isArray(t))return t;const n={...e},o=Object.keys(t);for(let e=0,r=o.length;e<r;e++){const r=o[e],i=t[r];if(!sg(n,i,r))if(i.unique){if(!Array.isArray(n[r]))throw new mi({code:mi.code.CollaborationError,message:`${r} is not array`});const e=i.unique,t=Object.keys(i.item),o=n[r].slice();n[r]=o;const a="self"===e?e=>o.findIndex((t=>t==e)):t=>o.findIndex((n=>n&&n[e]==t));for(let e=0,n=t.length;e<n;e++){const n=a(t[e]),r=i.item[t[e]];-1===n?o.push(r):sg(o,r,n)||(o[n]=cg(o[n],r))}}else n[r]=cg(n[r],i)}return n}function lg(e,t){return cg(e,t)}function ug(e="-2",t="-2"){return e!==t}function dg(e){return e.map((e=>e?{type:"entity",version:e.version,data:e.entity}:null))}function hg(e,t){return t.map((t=>{const n=e[t];return n?{type:"message",version:n.versionStr,data:n.content}:null}))}class fg{constructor(){e(this,"data",new Map),e(this,"cache",new Map),e(this,"timer",null),e(this,"updater",(()=>{})),e(this,"moreParams",void 0)}init(e,t){this.updater=e,this.moreParams=t}setCache(e,t){this.cache.set(e,t),og.set(e,{version:t.version,entity:t.entity,state:0,cache:[]}),setTimeout((()=>{this.cache.delete(e)}),fg.timeout)}getCache(e){return this.cache.get(e)}addTask(e){if(this.data.has(e))return;const t=this.cache.get(e);this.data.set(e,[{type:"entity",version:t?t.version:"-2"}]),this.run(!0)}updateTask(e,t){const n=this.data.get(e);if(!n)return;const o=n.findIndex((e=>e.type===t.type));-1===o?n.push({type:t.type,version:t.version}):n[o].version=t.version,this.cache.has(e)&&"entity"===t.type&&this.setCache(e,{version:t.version,entity:t.data})}removeTask(e){this.data.delete(e),0===this.data.size&&null!==this.timer&&clearTimeout(this.timer)}getVersion(e,t){const n=(this.data.get(e)||[]).find((e=>e.type===t));return n?n.version:"-2"}timerCB(e){this.check(e).finally((()=>{this.timer=null,this.data.size>0&&this.run()}))}run(e=!1){this.timer||(e?(this.timer=-1,this.timerCB(e)):this.timer=setTimeout((()=>{this.timerCB(e)}),fg.internal))}resolveTask(e,t,n=(e=>e)){return 0===e.length?Promise.resolve():t(e,this.moreParams).then((t=>{n(t,e).forEach(((t,n)=>{if(!t)return;const o=(this.data.get(e[n])||[]).find((e=>e.type===t.type));o?o&&ug(o.version,t.version)&&(o.version=t.version,this.updater(t,e[n])):this.updater(t,e[n])}))}))}update(e){this.moreParams.logger({name:ap.events.COLLABORATION_FALLBACK_FETCH,categories:{blockID:e.map((e=>`type:${e.type};id:${e.id}`)).join("")}});const{entities:t,msgs:n}=e.reduce(((e,t)=>("entity"===t.type?e.entities.push(t.id):e.msgs.push(t.id),e)),{entities:[],msgs:[]});return Promise.all([this.resolveTask(t,eg,dg),this.resolveTask(n,tg,hg)]).then((()=>{}))}check(e){const t=Array.from(this.data.keys());return this.moreParams.logger({name:ap.events.COLLABORATION_FETCH_INIT_VERSION,categories:{blockID:`pingpong;${t.join(",")}`}}),function(e,t){return Bp(qr,t)(Xr[Qr.checkVersion],{data:{blockIDs:e}}).then((e=>Object.keys(e.blockVersions).reduce(((t,n)=>(t[n]=e.blockVersions[n].map((e=>({type:e.type,version:e.versionStr}))),t)),{})))}(t,this.moreParams).then((n=>{const o=[];if(fg.internal=Object.keys(n).some((e=>n[e].some((e=>!["0","-1"].includes(e.version)))))?3e4:18e4,t.forEach((t=>{const r=this.data.get(t),i=[];(n[t]||[]).forEach((e=>{const n=r.findIndex((t=>t.type===e.type));if(-1===n)return i.push(e),void("-1"!==e.version&&r.push({version:e.version,type:e.type}));const a=r[n];"-1"===e.version?r.splice(n,1):"-2"===a.version&&"0"===e.version?a.version=e.version:ug(a.version,e.version)&&o.push({type:e.type,id:t})})),!e&&o.push(...i.map((e=>({type:e.type,id:t}))))})),o.length)return this.update(o)}))}}e(fg,"internal",3e4),e(fg,"timeout",500);var pg=new fg;Pt({target:"Set",proto:!0,real:!0,forced:Z},{addAll:function(){for(var e=Ne(this),t=Y(e.add),n=0,o=arguments.length;n<o;n++)h(t,e,arguments[n]);return e}}),Pt({target:"Set",proto:!0,real:!0,forced:Z},{deleteAll:zt}),Pt({target:"Set",proto:!0,real:!0,forced:Z},{difference:function(e){var t=Ne(this),n=new(mn(t,B("Set")))(t),o=Y(n.delete);return rn(e,(function(e){h(o,n,e)})),n}});var gg=function(e){return h(Set.prototype.values,e)};Pt({target:"Set",proto:!0,real:!0,forced:Z},{every:function(e){var t=Ne(this),n=gg(t),o=jt(e,arguments.length>1?arguments[1]:void 0);return!rn(n,(function(e,n){if(!o(e,e,t))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Pt({target:"Set",proto:!0,real:!0,forced:Z},{filter:function(e){var t=Ne(this),n=gg(t),o=jt(e,arguments.length>1?arguments[1]:void 0),r=new(mn(t,B("Set"))),i=Y(r.add);return rn(n,(function(e){o(e,e,t)&&h(i,r,e)}),{IS_ITERATOR:!0}),r}}),Pt({target:"Set",proto:!0,real:!0,forced:Z},{find:function(e){var t=Ne(this),n=gg(t),o=jt(e,arguments.length>1?arguments[1]:void 0);return rn(n,(function(e,n){if(o(e,e,t))return n(e)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Pt({target:"Set",proto:!0,real:!0,forced:Z},{intersection:function(e){var t=Ne(this),n=new(mn(t,B("Set"))),o=Y(t.has),r=Y(n.add);return rn(e,(function(e){h(o,t,e)&&h(r,n,e)})),n}}),Pt({target:"Set",proto:!0,real:!0,forced:Z},{isDisjointFrom:function(e){var t=Ne(this),n=Y(t.has);return!rn(e,(function(e,o){if(!0===h(n,t,e))return o()}),{INTERRUPTED:!0}).stopped}}),Pt({target:"Set",proto:!0,real:!0,forced:Z},{isSubsetOf:function(e){var t=Zt(this),n=Ne(e),o=n.has;return A(o)||(n=new(B("Set"))(e),o=Y(n.has)),!rn(t,(function(e,t){if(!1===h(o,n,e))return t()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Pt({target:"Set",proto:!0,real:!0,forced:Z},{isSupersetOf:function(e){var t=Ne(this),n=Y(t.has);return!rn(e,(function(e,o){if(!1===h(n,t,e))return o()}),{INTERRUPTED:!0}).stopped}});var _g=s.String,mg=w([].join),vg=[].push;Pt({target:"Set",proto:!0,real:!0,forced:Z},{join:function(e){var t=Ne(this),n=gg(t),o=void 0===e?",":function(e){if("Symbol"===$t(e))throw TypeError("Cannot convert a Symbol value to a string");return _g(e)}(e),r=[];return rn(n,vg,{that:r,IS_ITERATOR:!0}),mg(r,o)}}),Pt({target:"Set",proto:!0,real:!0,forced:Z},{map:function(e){var t=Ne(this),n=gg(t),o=jt(e,arguments.length>1?arguments[1]:void 0),r=new(mn(t,B("Set"))),i=Y(r.add);return rn(n,(function(e){h(i,r,o(e,e,t))}),{IS_ITERATOR:!0}),r}});var bg=s.TypeError;Pt({target:"Set",proto:!0,real:!0,forced:Z},{reduce:function(e){var t=Ne(this),n=gg(t),o=arguments.length<2,r=o?void 0:arguments[1];if(Y(e),rn(n,(function(n){o?(o=!1,r=n):r=e(r,n,n,t)}),{IS_ITERATOR:!0}),o)throw bg("Reduce of empty set with no initial value");return r}}),Pt({target:"Set",proto:!0,real:!0,forced:Z},{some:function(e){var t=Ne(this),n=gg(t),o=jt(e,arguments.length>1?arguments[1]:void 0);return rn(n,(function(e,n){if(o(e,e,t))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Pt({target:"Set",proto:!0,real:!0,forced:Z},{symmetricDifference:function(e){var t=Ne(this),n=new(mn(t,B("Set")))(t),o=Y(n.delete),r=Y(n.add);return rn(e,(function(e){h(o,n,e)||h(r,n,e)})),n}}),Pt({target:"Set",proto:!0,real:!0,forced:Z},{union:function(e){var t=Ne(this),n=new(mn(t,B("Set")))(t);return rn(e,Y(n.add),{that:n}),n}});const yg=new Set;function kg(e,t,n){const o=og.get(e);return o&&(o.state=1),!yg.has(e)&&n.logger({name:ap.events.COLLABORATION_FALLBACK_FETCH,categories:{blockID:e}}),function(e,t){return Bp(qr,t)(Xr[Qr.getBlockEntityV2],{data:{blockID:e}}).then((e=>({...e,entity:{...e.entity,sourceData:"string"==typeof e.entity.sourceData?JSON.parse(e.entity.sourceData||'""'):e.entity.sourceData,sourceMeta:"string"==typeof e.entity.sourceMeta?JSON.parse(e.entity.sourceMeta||'""'):e.entity.sourceMeta},version:e.versionStr||(e.version||0).toString()})))}(e,n).then((e=>{!function(e,t,n){const o=e.entity.blockID;let r=og.get(o),i=!1;const a=!yg.has(o);if(!a&&yg.delete(o),r){if(rg(r.version,e.version))return;if(1===r.state){r.version=e.version,r.entity=e.entity;const a=r.cache.filter((t=>rg(t.version,e.version)));a.sort(((e,t)=>rg(t.version,e.version)?-1:1));for(let e=0,i=a.length;e<i;e++){const i=a[e];if(!ag(r.version,i.version))return kg(o,t,n),void(r.cache=a.slice(e));r.version=a[e].version,r.entity=lg(r.entity,a[e].event)}r.cache.length=0,r.state=0,i=!0}else 0===r.state&&(r.version=e.version,r.entity=e.entity,i=!0)}else a||(r={version:e.version,entity:e.entity,state:0,cache:[]},og.set(o,{version:e.version,entity:e.entity,state:0,cache:[]}),i=!0);i&&(t({type:"entity",data:e.entity},e.entity.blockID),pg.updateTask(e.entity.blockID,{type:"entity",version:e.version,data:e.entity}))}(e,t,n)}))}const wg=new Map;function Eg(e,t,n,o){const{logger:r}=o;1===e.state?rg(t.version,e.version)&&(e.cache.push(t),r({name:ap.events.COLLABORATION_FETCH_INIT_VERSION,categories:{blockID:e.entity.blockID}})):0===e.state&&(ag(e.version,t.version)?(e.version=t.version,e.entity=lg(e.entity,t.event),n({type:"entity",data:e.entity},e.entity.blockID),function(e,t){const n=wg.get(e.block_id);if(n){const o=Date.now();wg.set(e.block_id,o),t.logger({name:ap.events.COLLABORATION_UPDATE_TIME,categories:{blockID:e.block_id,version:e.version}},!0).setDuration(o-n).flush()}}(t,o.createTraceContext()),pg.updateTask(e.entity.blockID,{type:"entity",version:t.version,data:e.entity})):rg(t.version,e.version)&&(e.version=t.version,e.entity=lg(e.entity,t.event),kg(e.entity.blockID,n,o.createTraceContext()),r({name:ap.events.COLLABORATION_FETCH_INIT_VERSION_RESULT,categories:{blockID:e.entity.blockID}})))}function Sg(e,t,n){const{logger:o}=n;if(e)if("pushBlockEvent"===e.command&&e.data&&e.data.header&&"update"===e.data.header.action){const{data:{header:n,event:r}}=e;r.sourceMeta="string"==typeof r.sourceMeta?JSON.parse(r.sourceMeta||'""'):r.sourceMeta,r.sourceData="string"==typeof r.sourceData?JSON.parse(r.sourceData||'""'):r.sourceData,og.has(r.blockID)&&og.delete(r.blockID);const i=ng.get(r.blockID),a=n.versionStr||(e.version||0).toString();rg(a,i)&&(ng.set(r.blockID,a),pg.updateTask(r.blockID,{type:"entity",version:a,data:r}),t({type:"entity",data:r},r.blockID)),o({name:ap.events.COLLABORATION_RECEIVE_SUBSCRIBE_MESSAGE,categories:{blockID:r.blockID,type:"full",version:n.version,deviceID:di()}})}else if("incr"===e.type)e.version=e.versionStr||(e.version||0).toString(),function(e,t,n){const o=e.block_id,r=og.get(o);r?Eg(r,e,t,n):(yg.add(o),kg(o,t,n))}(e,t,n.createTraceContext()),o({name:ap.events.COLLABORATION_RECEIVE_SUBSCRIBE_MESSAGE,categories:{blockID:e.block_id,type:e.type,version:e.version}});else if("pushOpenMessage"===e.command){const{data:{header:n,event:o}}=e,r=n.blockID,i=n.versionStr;rg(i,pg.getVersion(r,"message"))&&(pg.updateTask(r,{type:"message",version:i,data:o}),t({type:"message",data:o},r))}}class Tg{constructor(t,n){e(this,"filter",void 0),e(this,"instances",new Map),e(this,"moreParams",new Yp),this.filter=n;const o=(e,n)=>{if(e){const{logger:t}=this.moreParams;t({name:"entity"===e.type?ap.events.COLLABORATION_UPDATE_VIEW:ap.events.COLLABORATION_UPDATE_MSG,categories:{blockID:n,type:e.type,deviceID:di()}})}return t(e,n)};var r;pg.init(function(e){return(t,n)=>{"entity"===t.type&&(og.get(n)?og.set(n,{version:t.version,entity:t.data,state:0,cache:[]}):ng.has(n)&&ng.set(n,t.version)),e(t,n)}}(o),this.moreParams),r={handleTopicSyncMsg:(e,t)=>{const n=t&&t.message;if("string"==typeof n)try{const e=JSON.parse(n);Array.isArray(e.payload)&&"Common"===e.msg_type&&(r=new Blob([new Uint8Array(e.payload)]),new Promise(((e,t)=>{const n=new FileReader,o=()=>{n.onload=null,n.onerror=null};n.onload=function(){e(n.result),o()},n.onerror=function(){t(n.error),o(),n.abort()},n.readAsText(r)}))).then((e=>{Sg(JSON.parse(e),o,this.moreParams)}))}catch{}var r},handleSyncEvent:()=>{}},li=[ii,r]}addInstance({type:e,id:t,blockID:n,instance:o,engine:r}){if("creator"===e||"panel"===e)return;if(!this.filter(e,t))return;if(0===this.instances.size){let e;fi({before:()=>{e=this.moreParams.performance({start:ap.events.COLLABORATION_SOCKET_CONNECT_START,end:ap.events.COLLABORATION_SOCKET_CONNECT_RESULT})},success:()=>{e&&e.success(),ap.collect({name:"openplatform_website_blockit_collaboration_connect_dev",categories:{result_type:"success"}})},fail:t=>{e&&e.fail({error:t||new mi({code:mi.code.CollaborationError,message:"connect fail"})}),ap.collect({name:"openplatform_website_blockit_collaboration_connect_dev",categories:{result_type:"fail"}})}})}"block"===e&&pg.addTask(n);const i=this.instances.get(n),a=function(e,t,n){const o=e||{};return o[n.name]?o[n.name].push(t):o[n.name]=[t],o}(i,o,r);if(!i&&a){const e=pg.getCache(n);this.moreParams.logger({name:ap.events.COLLABORATION_SUBSCRIBE_START,categories:{blockIDs:n}}),gi(n,e?e.version:void 0).then((()=>{this.moreParams.logger({name:ap.events.COLLABORATION_SUBSCRIBE_RESULT})}),(()=>{this.moreParams.logger({name:ap.events.COLLABORATION_SUBSCRIBE_RESULT,level:ap.level.error,categories:{blockIDs:n}})})),this.instances.set(n,a)}}getInstanceMap(e){return this.instances.get(e)}updateInstance(e,t){const n=this.instances.get(e.blockID);if(!n)return!1;return(n[t]||[]).forEach((t=>{Object.assign(t.entity,e)})),!0}removeInstance(e,t,n){const o=this.instances.get(e);if(!o)return pg.removeTask(e),!1;const r=o[t];if(!r)return pg.removeTask(e),!1;if(bi(r,n),!r.length){const{[t]:n,...r}=o;0===Object.keys(r).length?this.instances.delete(e):this.instances.set(e,r)}return this.instances.has(e)||(this.moreParams.logger({name:ap.events.COLLABORATION_UNSUBSCRIBE_START,categories:{blockIDs:e}}),function(e){return(ci||fi()).then((t=>t.unsubscribe({appName:ii,token:ai},e)))}(e).then((()=>{this.moreParams.logger({name:ap.events.COLLABORATION_UNSUBSCRIBE_RESULT})}),(()=>{this.moreParams.logger({name:ap.events.COLLABORATION_UNSUBSCRIBE_RESULT,level:ap.level.error,categories:{blockIDs:e}})})),function(e){ng.has(e)?ng.delete(e):og.has(e)&&og.delete(e)}(e),pg.removeTask(e)),!0}}class Ig{constructor(t,n){this.root=t,this.env=n,e(this,"tag",void 0),e(this,"eventBus",new yi)}addListener(e,t){return this.eventBus.on(e,t)}unMount(){this.eventBus.clear(),this.removeTag()}}class Og extends Ig{}class Cg extends Og{constructor(e,t,n,o){super(t,n),this.entity=e,this.config=o,this.config.active&&this.appendTag()}onLoaded(e){return this.eventBus.on("onLoad",e)}onLoadFail(e){return this.eventBus.on("onError",e)}onConfigLoaded(e){return this.eventBus.on("onConfig",e)}onOpenSetting(e){return this.eventBus.on("onOpenSetting",e)}onUpdateReady(e){return this.eventBus.on("onUpdateReady",e)}onContentLoaded(e){return this.eventBus.on("onContentLoaded",e)}onReload(e){return this.eventBus.on("onReload",e)}onHideLoading(e){return this.eventBus.on("onHideLoading",e)}updateTheme(e){}updateTypedData(e){}getRuntimeConfigLayout(){return Promise.resolve({blockVersion:"test"})}removeContentSuccessListener(){}}class Lg extends Ig{constructor(t,n,o){super(t,n),this.config=o,e(this,"timer",null)}destroy(){return 0===this.config.delay?(this.unMount(),Promise.resolve()):new Promise((e=>{this.timer&&clearTimeout(this.timer),this.timer=setTimeout((()=>{this.unMount(),this.timer=null,e()}),this.config.delay)}))}submitHandler(e,t){const n=this.dataHandler(e,t);0===n.code?this.eventBus.emit("onSubmit",n.data):1===n.code&&this.eventBus.emit("onCancel",void 0)}cancelHandler(){this.eventBus.emit("onCancel",void 0),this.destroy()}onSubmit(e,t){const n=()=>{},o=this.addListener("onSubmit",e),r=t?this.addListener("onError",t):n,i=t?this.addListener("onCancel",t):n;return()=>{o(),r(),i()}}onCancel(e){this.eventBus.on("onCancel",e)}}class Rg extends Lg{constructor(e,t,n,o){super(t,n,o),this.blockTypeID=e,this.appendTag()}onLoaded(e){return this.eventBus.on("onLoad",e)}onLoadFail(e){return this.eventBus.on("onError",e)}onContentLoaded(e){return this.eventBus.on("onContentLoaded",e)}onConfigLoaded(e){return this.eventBus.on("onConfig",e)}onReload(e){return this.eventBus.on("onReload",e)}onHideLoading(e){return this.eventBus.on("onHideLoading",e)}removeContentSuccessListener(){}}class Ng extends Lg{constructor(e,t,n,o,r){super(t,n,o),this.entity=e,this.extra=r,this.appendTag()}}class Ag extends Og{constructor(e,t,n,o){super(t,n),this.entity=e,this.extra=o,this.appendTag()}onDataChange(e){return this.addListener("onDataChange",e)}}let xg;!function(e){e.ZH_CN="zh_CN",e.EN_US="en_US",e.JA_JP="ja_JP"}(xg||(xg={}));const Dg={code:0,message:""};class Bg{constructor(t){e(this,"_hasInit",!1),e(this,"loadTask",null),e(this,"name",void 0),this.registerUI(t)}get hasInit(){return this._hasInit}diagnose(){return Dg}updateTheme(e){}updateTypedData(e){}hasLoadTask(){return!!this.loadTask}loadEngine(e,t){return this._hasInit?Promise.resolve():(this.loadTask||(this.loadTask=this.load(e,t).then((()=>{this._hasInit=!0})).finally((()=>{this.loadTask=null}))),this.loadTask)}shouldCollaboration(e,t){return!1}shouldPreMount(e,t){return!1}getEngineVersion(){return""}getJSSDKVersion(){return""}}const Pg="BLOCK_CUSTOM_ENGINE",zg={props:"propsMap",panel:"panelMap",creator:"creatorMap",block:"blockMap"};var Mg=new class{constructor(){e(this,"propsMap",new Map),e(this,"panelMap",new Map),e(this,"creatorMap",new Map),e(this,"blockMap",new Map),e(this,"engineFilter",[]),e(this,"collaboration",void 0),e(this,"customEngines",[]),e(this,"caches",void 0),e(this,"engineMap",{}),this.registerUI=this.registerUI.bind(this),this.dataChange=this.dataChange.bind(this),this.collaboration=new Tg(this.dataChange,((e,t)=>{const n=this.engineMap[t]||this.getUIEngine(e,t);return n&&n.shouldCollaboration(e,t)||!1}))}dataChange(e,t){if(!e)return;const n=this.collaboration.getInstanceMap(t);if(n)if("entity"===e.type){const t=this.customEngines.map((e=>e.name));t.unshift(Wr),t.forEach((t=>{n[t]&&(this.engineMap[t].onDataChange(e.data),this.collaboration.updateInstance(e.data,t))}))}else"message"===e.type&&n.block&&this.engineMap.block.updateTypedData({type:Jp.CUSTOM_MESSAGE,data:e.data,blockID:t})}registerUI(e,t,n){if("string"==typeof e){this[zg[e]].set(t,n)}else"function"==typeof e&&this.engineFilter.push(((...n)=>!0===e(...n)?t:null))}registerEngine(e,t=!1,n=[]){let o;o=t?e({baseEngine:Bg,baseBlock:Cg,baseProp:Ag,baseCreator:Rg,basePanel:Ng}):e;const r=new o(this.registerUI,...n);return this.engineMap[r.name]=r,r}getUIEngine(e,t){const n="string"==typeof t?t:t.blockTypeID;for(let t=0,o=this.engineFilter.length;t<o;t++){const o=this.engineFilter[t](e,n);if(o)return o}const o=this[zg[e]];return o.get(n)||o.get(Yr)}mount(e,t,...n){const o=e.mountUI(t,...n);return"block"!==t&&"props"!==t||this.collaboration.addInstance({type:t,id:"block"===t?n[0].blockTypeID:n[0],blockID:("block"===t?n[0]:n[1]).blockID,instance:o,engine:e}),o}mountUISync(e,...t){const n=this.getUIEngine(e,t[0]);return this.mount(n,e,...t)}getInitOptionCaches(){if(!this.caches)throw new mi({code:mi.code.InitError,message:"Blockit.init needs to be called first"});return this.caches}async mountUI(e,...t){await this.loadEngineByEntity(t[0]);const n=this.getUIEngine(e,t[0]);if(n.hasInit)return Promise.resolve(this.mount(n,e,...t));const[o,r]=this.getInitOptionCaches();return this.loadEngineByEngine(n,o,r).then((()=>this.mount(n,e,...t)))}unmountUI(e,t,n,o){const r=this.getUIEngine(t,o||("block"===t?n.entity:e));this.collaboration.removeInstance(e,r.name,n)?r.removeUI(t,n):n.unMount()}loadEngineByEntity(e){const t="string"==typeof e?e:e.blockTypeID,n=this.customEngines.find((e=>e.blockTypeIDs.includes(t)));if(n){const e=this.engineMap[n.name];if(!e)return ki(n.url).then((()=>{window[Pg](this),delete window[Pg]}));if(!e.hasInit){const[t,n]=this.getInitOptionCaches();return this.loadEngineByEngine(e,t,n)}}return Promise.resolve()}loadEngine(e,t,n){const o=this.engineMap[t];return this.caches=[e,n],this.loadEngineByEngine(o,e,n)}loadEngineByEngine(e,t,n){if(e.hasInit)return Promise.resolve();if(e.hasLoadTask())return e.loadEngine(t,n);{const{logger:o}=n,r=o({name:ap.events.INIT_LOAD_ENGINE_RESULT,categories:{engineName:e.name}},!0);return e.loadEngine(t,n).then((()=>{r.setResultTypeSuccess().flush()})).catch((e=>{throw r.setResultTypeFail().setLevel(ap.level.error).setError(e).flush(),e}))}}isEngineLoaded(e,t){return this.getUIEngine(e,t).hasInit}engineLoaded(e){return this.engineMap[e].hasInit}engineDiagnosed(e,t){if(this.isEngineLoaded(e,t)){return this.getUIEngine(e,t).diagnose()}return Dg}updateTheme(e){try{this.caches[0].config.theme=e}catch(e){}Object.values(this.engineMap).forEach((t=>{t.updateTheme(e)}))}updateTypedData(e,t){this.engineMap[e].updateTypedData(t)}shouldPreMount(e,t){return this.getUIEngine(e,t).shouldPreMount(e,t)}};class jg extends Ng{createTag(){}reload(){return Promise.resolve()}appendTag(){if(this.onCancel=this.onCancel.bind(this),this.onConfirm=this.onConfirm.bind(this),!jg.APIS)throw new mi({code:mi.code.InitError,message:"Should init todo engine first"});jg.APIS.open({entity:this.entity,env:this.env,config:this.config,extra:this.extra,onClose:this.onCancel,onCancel:this.onCancel,onConfirm:this.onConfirm})}removeTag(){jg.APIS.close(),this.onCancel()}dataHandler(e,t){return{code:t?1:0,data:null}}onCancel(){this.submitHandler(null,!0)}onConfirm(){this.submitHandler(null)}}e(jg,"APIS",void 0);const Ug="todo";class Vg extends Bg{constructor(...t){super(...t),e(this,"name",Ug)}load(e){return jg.APIS=e.config.apis,Promise.resolve()}registerUI(e){e("panel",Ug,this)}mountUI(e,...t){if("panel"===e){const[,...e]=t;return new jg(...e)}}removeUI(e,t){t.unMount()}onDataChange(){}}const Hg=Object.freeze({});function Fg(e,t){return{blockID:e,blockTypeID:t,sourceData:Hg,sourceMeta:Hg}}function Kg(e){return"number"==typeof e?`http://localhost:${e}`:"string"==typeof e?e:""}function Gg(e,t,n){const o="string"==typeof e?"?withCredentials=1":"";return`${Kg(e)}/static/${n}/${t}.ttpkg.js${o}`}function Jg(e){const t=function(e){const t=document.createElement(e.tagName);var n;if(t.setAttribute("blockId",e.blockTypeId),e.type&&t.setAttribute("type",e.type),e.env&&(t.setAttribute("host",e.env.host),t.setAttribute("env",e.env.env),t.setAttribute("region",e.env.region),t.setAttribute("locale",e.env.locale)),e.debug&&e.type)if("boolean"==typeof e.debug&&null!==(n=e.env)&&void 0!==n&&n.debugPort)t.setAttribute("debugUrl",JSON.stringify({type:"local",pkgUrl:Gg(e.env.debugPort,e.blockTypeId,e.type),version:Date.now().toString()}));else{if("object"!=typeof e.debug)throw new mi({code:mi.code.ParameterError,message:"Parameter debug is invalid"});t.setAttribute("debugUrl",JSON.stringify(e.debug))}return t}({tagName:"op-block",...e});return e.trace&&t.setAttribute("app_tracing",e.trace.serialize()),t}function qg(e,t,n){return Object.entries(t).forEach((([t,o])=>{e.addEventListener(t,o,{once:!Array.isArray(n)||!n.includes(t)})})),()=>{Object.entries(t).forEach((([t,n])=>{e.removeEventListener(t,n)}))}}class Wg extends Cg{constructor(...t){super(...t),e(this,"removeEventListener",void 0),e(this,"isvLoadingTimer",null),this.loadContentSuccessHandler=this.loadContentSuccessHandler.bind(this),this.addEventListener()}clearIsvLoadingTimer(){this.isvLoadingTimer&&clearTimeout(this.isvLoadingTimer),this.isvLoadingTimer=null}loadSuccessHandler(e){const t=Boolean(this.config.useStartLoading);this.eventBus.emit("onLoad",{needLoading:t,packageSourceType:e.detail.packageSourceType}),t?this.isvLoadingTimer=setTimeout((()=>{this.eventBus.emit("onHideLoading",{showError:!0,error:{errCode:cp.ISV_LOADING_TIMEOUT,errMsg:"isv Block loading timeout"}}),this.removeContentSuccessListener()}),2e4):(this.eventBus.emit("onHideLoading",{showError:!1}),this.changeProp("display","block"))}loadFailHandler(e){this.eventBus.emit("onError",e),this.eventBus.emit("onHideLoading",{showError:!0,error:e.detail})}loadConfigHandler(e){const{pages:t,packageVersion:n}=e.detail,o=e.detail[t[0]].window,r={packageVersion:n||""};[{key:"useStartLoading",defaultValue:!1},{key:"showFrame",defaultValue:!0}].forEach((e=>{r[e.key]=o.hasOwnProperty(e.key)?o[e.key]:e.defaultValue})),o[this.env.host]&&Object.assign(r,o[this.env.host]),e.detail.hasOwnProperty("darkmode")&&(r.darkmode=e.detail.darkmode),this.config.useStartLoading=r.useStartLoading,this.eventBus.emit("onConfig",r)}openSettingHandler(e){this.eventBus.emit("onOpenSetting",e.detail)}updateReadyHandler(e){this.eventBus.emit("onUpdateReady",e.detail)}loadContentSuccessHandler(){this.config.useStartLoading&&(this.changeProp("display","block"),this.eventBus.emit("onContentLoaded",void 0),this.eventBus.emit("onHideLoading",{showError:!1}),this.clearIsvLoadingTimer())}createTag(e){const t=Jg({type:"block",blockTypeId:this.entity.blockTypeID,env:this.env,debug:this.config.debug,trace:this.config.trace});t.setAttribute("instanceId",this.entity.blockID),function(e){return e&&(null==e?void 0:e.sourceMeta)===Hg}(this.entity)||t.setAttribute("blockInfo",JSON.stringify({blockID:this.entity.blockID,sourceMeta:this.entity.sourceMeta,sourceData:this.entity.sourceData})),e&&t.setAttribute("launch_type","force_update");const{typedDataCollection:n={}}=this.config;return t.setAttribute("typed_data_collection",JSON.stringify(n)),t}appendTag(e){this.tag=this.createTag(e),this.changeProp("display","none"),this.root.appendChild(this.tag),this.tag.create()}removeTag(){this.removeEventListener(),"function"==typeof this.tag.destroy?this.tag.destroy():this.root.removeChild(this.tag)}addEventListener(){this.removeEventListener=qg(this.tag,{appConfigSuccess:this.loadConfigHandler.bind(this),blockLoadSuccess:this.loadSuccessHandler.bind(this),blockContentLoadSuccess:this.loadContentSuccessHandler,blockLoadFail:this.loadFailHandler.bind(this),blockOpenSetting:this.openSettingHandler.bind(this),updateReady:this.updateReadyHandler.bind(this)},["blockOpenSetting"])}removeContentSuccessListener(){this.tag.removeEventListener("blockContentLoadSuccess",this.loadContentSuccessHandler)}reload(e,t){return void 0!==e&&(this.config.debug=e),this.removeTag(),this.clearIsvLoadingTimer(),this.appendTag(t),this.eventBus.emit("onReload",void 0),this.addEventListener(),Promise.resolve()}changeProp(e,t){"display"===e?this.tag.style.display=t:"initEntity"===e&&this.tag.setBlockInfo(t)}changeVisibility(e){window.BlockEngine.updateAppVisibility(this.tag.appKey,e)}updateTheme(e){window.BlockEngine.updateTheme(e,this.tag.appKey)}updateTypedData(e){const t={identifier:this.tag.appKey,identifierType:"appKey"};window.BlockEngine.pushTypedMessage(t,e)}changeSettings(e,t){const n=new CustomEvent("blockSettingChanged",{detail:{blockInfo:e,isCancel:t}});this.tag.dispatchEvent(n)}async getRuntimeConfigLayout(){const e=await window.BlockEngine.getTypedConfig(this.entity.blockTypeID,"templateSchema"),{schemaUrl:t="",appVersion:n=""}=e||{};let o;return t&&(o=await fetch(t,{headers:{"Content-Type":"text/plain;charset=utf-8"}}).then((e=>{if(e.ok)return e.text();throw new mi({code:mi.code.RequestError,message:e.statusText})})).catch((e=>{throw new mi({code:mi.code.RequestError,message:e.message})}))),{blockVersion:n,layoutConfig:o}}}class $g extends Rg{constructor(...t){super(...t),e(this,"removeEventListener",void 0),e(this,"isvLoadingTimer",null),this.loadContentSuccessHandler=this.loadContentSuccessHandler.bind(this),this.addEventListener()}clearIsvLoadingTimer(){this.isvLoadingTimer&&clearTimeout(this.isvLoadingTimer),this.isvLoadingTimer=null}loadSuccessHandler(e){const t=void 0===this.config.needInterface||this.config.needInterface,n=Boolean(this.config.useStartLoading),o=!t||t&&n;this.eventBus.emit("onLoad",{needLoading:o,packageSourceType:e.detail.packageSourceType}),o?this.isvLoadingTimer=setTimeout((()=>{this.eventBus.emit("onHideLoading",{showError:!0,error:{errCode:cp.ISV_LOADING_TIMEOUT,errMsg:"isv Creator loading timeout"}}),this.removeContentSuccessListener()}),2e4):(this.eventBus.emit("onHideLoading",{showError:!1}),this.changeProp("display","block"))}loadConfigHandler(e){const{pages:t,packageVersion:n}=e.detail,o=e.detail[t[0]].window;"create"===this.config.mode&&(this.config.needInterface=o.needInterface),this.config.useStartLoading=o.useStartLoading,this.eventBus.emit("onConfig",{needInterface:!1!==this.config.needInterface,useStartLoading:this.config.useStartLoading||!1,packageVersion:n||""})}loadFailHandler(e){this.eventBus.emit("onError",e),this.eventBus.emit("onHideLoading",{showError:!0,error:e.detail})}loadContentSuccessHandler(){this.config.useStartLoading&&!1!==this.config.needInterface&&(this.changeProp("display","block"),this.eventBus.emit("onContentLoaded",void 0),this.eventBus.emit("onHideLoading",{showError:!1}),this.clearIsvLoadingTimer())}appendTag(){this.tag=this.createTag(),this.changeProp("display","none"),this.root&&(this.root.appendChild(this.tag),this.tag.create())}createTag(){const e=Jg({type:"creator",blockTypeId:this.blockTypeID,env:this.env,debug:this.config.debug,trace:this.config.trace});return this.config.mode?("clone"===this.config.mode&&e.setAttribute("mode",this.config.mode),e.setAttribute("blockInfo",JSON.stringify(this.config.preEntity?{mode:this.config.mode,settings:this.config.settings,blockID:this.config.preEntity.blockID,sourceMeta:this.config.preEntity.sourceMeta,sourceData:this.config.preEntity.sourceData}:{mode:this.config.mode}))):e.setAttribute("blockInfo",JSON.stringify({})),e}removeTag(){this.removeEventListener(),"function"==typeof this.tag.destroy?this.tag.destroy():this.root.removeChild(this.tag)}addEventListener(){this.removeEventListener=qg(this.tag,{creatorSubmit:this.submitHandler.bind(this),creatorCancel:this.cancelHandler.bind(this),appConfigSuccess:this.loadConfigHandler.bind(this),blockLoadSuccess:this.loadSuccessHandler.bind(this),blockContentLoadSuccess:this.loadContentSuccessHandler,blockLoadFail:this.loadFailHandler.bind(this)})}removeContentSuccessListener(){this.tag.removeEventListener("blockContentLoadSuccess",this.loadContentSuccessHandler)}dataHandler(e,t){return t?{code:1,data:null}:e.detail&&e.detail.blockInfo?{code:0,data:e.detail.blockInfo}:{code:-1,data:"fail"}}reload(e){return void 0!==e&&(this.config.debug=e),this.removeTag(),this.clearIsvLoadingTimer(),this.appendTag(),this.eventBus.emit("onReload",void 0),this.addEventListener(),Promise.resolve()}changeProp(e,t){"display"===e&&(this.tag.style.display=t)}}let Yg,Qg,Xg;function Zg(e,t){return t.hasOwnProperty(e)?t[e]:t.en_us||t.zh_cn||""}function e_(e){return e?{"zh-CN":Zg("zh_cn",e),"en-US":Zg("en_us",e),"ja-JP":Zg("ja_jp",e)}:{"zh-CN":"","en-US":"","ja-JP":""}}Yg=Qr.generateBlock,Qg=Qr.getBlockList,Xg=Qr.getBlockEntity;class t_{constructor(t,n,o){e(this,"request",void 0),e(this,"env",void 0),e(this,"containerID",void 0),this.env=t,this.request=Bp(t,o),this.containerID=n||""}getMultiGeoContext(){return{targetHost:this.env.host,targetHostID:this.containerID||this.env.containerID}}async[Yg](e){return(await this.request(Xr[Qr.generateBlock],{data:{context:this.getMultiGeoContext(),Entity:{...e,sourceMeta:JSON.stringify(e.sourceMeta),sourceData:JSON.stringify(e.sourceData)}}})).BlockId}async[Qg](e){const t=(await this.request(Xr[Qr.getBlockList],{data:{larkVersion:"",hostType:this.env.host,cursorInfo:e?{cursor:"",count:e}:void 0}})).availableItemList;return Array.isArray(t)?t.map((e=>({name:e_(e.name),appID:e.appId,description:e_(e.desc),thumbnail:e_(e.descImage),appName:e_(e.appName),icon:e.pcIcon||e.iconUrl,outlinedIcon:e.pcIcon,filledIcon:e.mobileIcon,blockTypeID:e.blockTypeId,isOnline:!0,hasLocalPack:!1,category:e.category}))):[]}async[Xg](e){const t=(await this.request(Xr[Qr.getBlockEntity],{data:{blockIDs:[e]}})).blocks[e];if(!t)throw new mi({code:mi.code.ParameterError,message:"Parameter blockID is invalid"});const n=t.entity;if(0!==t.status)throw new mi({code:mi.code.ParameterError,message:"Parameter blockID is invalid"});return n.sourceMeta=JSON.parse(n.sourceMeta||'""'),n.sourceData=JSON.parse(n.sourceData||'""'),n}async getDebugBlockList(e){const t=await Dp.fetch(function(e){return`${Kg(e)}/api/block`}(e),{method:"GET"}),n=t.data.blocks;return Array.isArray(n)?n.map((e=>(e.blockTypeID||(e.blockTypeID=e.blockTypeId),{name:e.name,appID:e.appID||"",appName:e.appName,description:{"zh-CN":"","en-US":"","ja-JP":""},icon:e.icon,blockTypeID:e.blockTypeID,isOnline:!1,hasLocalPack:!0}))):[]}cloneBlock(e){return this.request(Xr[Qr.cloneBlock],{data:{blockIDs:e.blockIDs,context:{...e.context,...this.getMultiGeoContext()}}}).then((e=>e.blocks))}async generateInnerBlock(e){const t=await this.request(Xr[Qr.generateInnerBlock],{data:{blockIDs:e}});return e.map((e=>{const n=t.blocks[e],o=n.entity;return 0!==n.status?500===n.status?n.errMessage:null:(o.sourceMeta=JSON.parse(o.sourceMeta||'""'),o.sourceData=JSON.parse(o.sourceData||'""'),o)}))}}var n_;!function(e){e.OpenSetting="openBlockSetting",e.HideLoading="hideBlockLoading",e.SaveLog="saveLog"}(n_||(n_={}));var o_={[n_.OpenSetting]:{apiType:Wp.Invoke,params:{settings:{type:"object",required:!1}},handler(e,{node:t}){const n=new CustomEvent("blockOpenSetting",{detail:e});return t.dispatchEvent(n),new Promise((e=>{t.addEventListener("blockSettingChanged",(t=>{const{blockInfo:n,isCancel:o}=t.detail;e(o?{errMsg:n_.OpenSetting+":ok cancel",confirm:!1,cancel:!0}:{errMsg:n_.OpenSetting+":ok",confirm:!0,cancel:!1,blockInfo:n})}),{once:!0})}))}},[n_.HideLoading]:{apiType:Wp.Invoke,params:{},handler:(e,{node:t})=>(setTimeout((()=>{const e=new CustomEvent("blockContentLoadSuccess");t.dispatchEvent(e)}),0),{errMsg:n_.HideLoading+":ok"})},[n_.SaveLog]:Zp};const r_={feishu:{staging:["blk_5f8f7ccba955000192cfca3e","blk_5f8f7ccba955c00192cf0cf3","blk_5f8f7ccba955c00192cf0e10"],online:["blk_5f9911cb7bd60001404cca03"]}};function i_([e,t]){if(0===t.length)return e;const n=new Set(t.map((e=>e.blockTypeID))),o=new Set,r=e.map((e=>{const t=n.has(e.blockTypeID);return t&&o.add(e.blockTypeID),{...e,hasLocalPack:t}})),i=t.filter((e=>!o.has(e.blockTypeID)));return r.concat(i)}class a_ extends Bg{constructor(...t){super(...t),e(this,"name",Wr),e(this,"blockListInfo",{cache:[],time:Date.now()}),e(this,"engine",void 0),e(this,"ignoreBlockIds",null),e(this,"engineVersion",""),e(this,"jssdkVersion","")}diagnose(){let e=Dg;try{e=this.engine.diagnose()}catch(e){}return e}updateTheme(e){this.engine.updateTheme(e)}updateTypedData(e){const{blockID:t,data:n,type:o}=e,r={type:o,data:n},i={identifier:t,identifierType:"blockID"};this.engine.pushTypedMessage(i,r)}async getBlockList(e){const{debugPort:t,moreParams:n}=e,{logger:o}=n,r=new t_(qr,"",n);o({name:ap.events.GET_BLOCK_LIST_START});const i=o({name:ap.events.GET_BLOCK_LIST_REQUEST_RESULT},!0),a=r.getBlockList(),s=t?r.getDebugBlockList(t):Promise.resolve([]),c=await Promise.all([a,s]).then((e=>(i.setResultTypeSuccess().addMap({data:ap.utils.sample(e)}).flush(),e)),(e=>{throw i.setResultTypeFail().setLevel(ap.level.error).setError(e).flush(),e})).then(i_);return o({name:ap.events.GET_BLOCK_LIST_RESULT,categories:{getblockListResult:ap.utils.sample(c)}}),this.blockListInfo.cache=c,this.blockListInfo.cache}hasBlock(e){return this.blockListInfo.cache.some((t=>t.blockTypeID===e))}async generateBlock(e,t,n){const o=new t_(qr,t,n),r=await o.generateBlock({...e,sourceData:e.sourceData||{}});return{...e,blockID:r,sourceLink:"",i18nSummary:{"zh-CN":"","en-US":"","ja-JP":""},mentionList:[]}}registerUI(e){e("block",Yr,this),e("creator",Yr,this)}async load(e,t){var n;if(!e)return Promise.reject(new mi({code:mi.code.ParameterError,message:"Parameter options is required"}));if(!e.config||!e.config.userId)return Promise.reject(new mi({code:mi.code.ParameterError,message:"Parameter options.config.userId is required"}));let o=a_.ENGINE_URL;e.blockEngineURL&&(o=e.blockEngineURL);const r=function(e){const t=new URL(e).pathname.split("/"),n=t[t.length-1].match(/^index-(.*?)\.js$/);return n&&n.length>1?n[1]:""}(o);this.engineVersion=r;const i=null==t?void 0:t.performance({start:ap.events.INIT_LOAD_ENGINE_SCRIPT_START,end:ap.events.INIT_LOAD_ENGINE_SCRIPT_RESULT,categories:{usePreloadTask:(!!window.loadBlockEngineTask).toString()}}),a=window.loadBlockEngineTask||ki(o).catch((e=>e)),s=await a;if(s)throw i&&i.fail({error:s}),s;i&&i.success(),this.engine=window.BlockEngine;const{code:c,message:l}=this.diagnose();if(0!==c)throw t&&t.logger({name:ap.events.DIAGNOSE_ENGINE_RESULT,categories:{code:c.toString(),message:l}}),new mi({code:mi.code.DiagnoseError,message:l});"function"==typeof(null===(n=e.engine)||void 0===n?void 0:n.beforeInit)&&await e.engine.beforeInit(),this.engine.engineEventHooks.onSDKLoaded((t=>{var n;"function"==typeof(null===(n=e.engine)||void 0===n?void 0:n.onJSSDKLoaded)&&e.engine.onJSSDKLoaded({jssdkVersion:t.sdkVersion}),this.jssdkVersion=t.sdkVersion}));const u=this.engine.initEngine({userId:e.config.userId,host:qr.host,locale:qr.locale.replace("-","_"),env:qr.env,region:qr.region,platform:qr.platform,domainConfig:qr.domain,platformVersion:e.config.larkVersion,theme:e.config.theme||"light",blockitVersion:"1.13.7"}),d=null==t?void 0:t.performance({start:ap.events.LOAD_ENGINE_START,end:ap.events.LOAD_ENGINE_RESULT,categories:{engineVersion:r}});await Si(u,{timer:10,timeoutErrorMsg:"Block engine init timeout"}).catch((e=>{throw d&&d.fail({error:e}),ap.collect({name:"openplatform_website_blockit_load_engine_dev",categories:{result_type:"fail",app_engine_version:r}}),e})),d&&(d.success(),ap.collect({name:"openplatform_website_blockit_load_engine_dev",categories:{result_type:"success",duration:d.duration,app_engine_version:r}}));const h={...o_,..."object"==typeof e.api?e.api:{}};Object.keys(h).forEach((e=>{this.engine.registerApi({name:e,...h[e]})}))}mountUI(e,...t){return"block"===e?new Wg(...t):new $g(...t)}removeUI(e,t){t.unMount()}onDataChange(e){this.engine&&this.engine.updateData(e.blockID,e.sourceData||{})}shouldCollaboration(e,t){return"block"===e&&(this.ignoreBlockIds||(this.ignoreBlockIds=function(e){const t=r_[e.region];return t&&t[e.env]||[]}(qr)),!this.ignoreBlockIds.includes(t))}prefetchBlocks(e,t){if(!this.engine)throw new mi({code:mi.code.InitError,message:"Blockit.init needs to be called first"});this.engine.preInstallApps(e.map((e=>({blockId:e,type:t||"block"}))))}getEngineVersion(){return this.engine?this.engine.engineVersion:this.engineVersion}getJSSDKVersion(){return this.jssdkVersion}shouldPreMount(e){return"block"===e}}e(a_,"ENGINE_URL","https://sf6-scmcdn-cn.feishucdn.com/goofy/pc/engine/block/browser/index-2.21.1.js");class s_ extends Bg{constructor(t,n){super(t),this.config=n,e(this,"name",void 0),this.name=n.name}load(e,t){var n,o;return ki(this.config.path&&null!==(n=window)&&void 0!==n&&null!==(o=n.blockitInternal)&&void 0!==o&&o.CDNDomain?window.blockitInternal.CDNDomain+this.config.path:this.config.url).then((()=>this.onLoad(e,t)))}registerUI(e){Promise.resolve().then((()=>{for(const t of this.UIMap.keys())this.config.blockTypeIDs.forEach((n=>{e(t,n,this)}))}))}mountHook(e,t){}unmountHook(e,t){}mountUI(e,...t){const n=this.UIMap.get(e);if(n){const o=new n(...t);return this.mountHook(e,o),o}throw new Error("")}removeUI(e,t){this.unmountHook(e,t),t.unMount()}}const c_="BLOCKIT_MEEGO_ENGINE";const l_=new Map;l_.set("block",class extends Cg{constructor(...t){super(...t),e(this,"renderer",null)}createTag(){}appendTag(){this.removeTag();const e=window[c_].renderBlock(this.entity,{root:this.root,onLoad:()=>{this.eventBus.emit("onLoad",{needLoading:!1,packageSourceType:"net"})},loadError:e=>{this.eventBus.emit("onError",e)}});Promise.resolve().then((()=>{this.renderer=e}))}removeTag(){this.renderer&&(this.renderer.destroy(),this.renderer=null)}reload(){return this.renderer&&this.renderer.reload()||Promise.resolve()}changeProp(e,t){}changeVisibility(e){}changeSettings(e,t){}}),l_.set("creator",class extends Rg{createTag(){}appendTag(){requestAnimationFrame((()=>{this.eventBus.emit("onLoad",{needLoading:!1,packageSourceType:"net"}),this.eventBus.emit("onConfig",{needInterface:!0,useStartLoading:!1})})),window[c_].renderCreator(this.root).then((e=>{this.submitHandler({blockID:e},!1)}),(e=>{this.submitHandler(e,e&&"cancel"===e.message)}))}removeTag(){}reload(){return Promise.resolve()}dataHandler(e,t){return t?{code:1,data:null}:e.blockID?{code:0,data:e}:{code:-1,data:"fail"}}});class u_ extends s_{constructor(...t){super(...t),e(this,"blockMap",new Map)}get UIMap(){return l_}onLoad(e){var t,n;return window[c_].init({env:qr,api:e.api,libs:(null===(t=window)||void 0===t||null===(n=t.blockitInternal)||void 0===n?void 0:n.libs)||{}})}shouldCollaboration(){return!0}mountHook(e,t){"block"===e&&function(e,t,n){const o=e.get(t)||[];!o.length&&e.set(t,o),o.push(n)}(this.blockMap,t.entity.blockID,t)}unmountHook(e,t){"block"===e&&function(e,t,n){const o=e.get(t);if(o){const r=o.indexOf(n);if(~r)return o.splice(r,1),0===o.length&&e.delete(t)}}(this.blockMap,t.entity.blockID,t)}onDataChange(e){const t=this.blockMap.get(e.blockID);t&&t.forEach((t=>{t.renderer&&t.renderer.update(e)}))}}e(u_,"engineName","meegoEngine");var d_=[u_],h_=p_,f_=p_;function p_(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then}function g_(e,t){return function(...n){try{const o=e.apply(this,n);return h_(o)&&o.catch((e=>{ap.reportJSError(e,t)})),o}catch(e){throw ap.reportJSError(e,t),e}}}h_.default=f_;const __=["setDebugPort","setEnv","generateBlockID","doAction","register","unregister","init","getAvailableBlockList","mountCreator","mountBlock","mountSetting","mountBlockByID","prefetchBlocks","unmountBlock","registerEngine","replaceKernelLibrary","copy","bulkPaste","updateTheme"];function m_(e){return m_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m_(e)}function v_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&o.push.apply(o,Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach((function(t){v_(e,t,n[t])}))}return e}function y_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k_(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function w_(e,t,n){return t&&k_(e.prototype,t),n&&k_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function E_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S_(e,t){if(t&&("object"===m_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return E_(e)}function T_(e){return T_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},T_(e)}function I_(e,t){return I_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},I_(e,t)}function O_(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I_(e,t)}var C_={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){console&&console[e]&&console[e].apply(console,t)}},L_=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};y_(this,e),this.init(t,n)}return w_(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||C_,this.options=t,this.debug=t.debug}},{key:"setDebug",value:function(e){this.debug=e}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}},{key:"deprecate",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(e,t,n,o){return o&&!this.debug?null:("string"==typeof e[0]&&(e[0]="".concat(n).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}},{key:"create",value:function(t){return new e(this.logger,b_({},{prefix:"".concat(this.prefix,":").concat(t,":")},this.options))}}]),e}(),R_=new L_,N_=function(){function e(){y_(this,e),this.observers={}}return w_(e,[{key:"on",value:function(e,t){var n=this;return e.split(" ").forEach((function(e){n.observers[e]=n.observers[e]||[],n.observers[e].push(t)})),this}},{key:"off",value:function(e,t){this.observers[e]&&(t?this.observers[e]=this.observers[e].filter((function(e){return e!==t})):delete this.observers[e])}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(this.observers[e]){var r=[].concat(this.observers[e]);r.forEach((function(e){e.apply(void 0,n)}))}if(this.observers["*"]){var i=[].concat(this.observers["*"]);i.forEach((function(t){t.apply(t,[e].concat(n))}))}}}]),e}();function A_(){var e,t,n=new Promise((function(n,o){e=n,t=o}));return n.resolve=e,n.reject=t,n}function x_(e){return null==e?"":""+e}function D_(e,t,n){e.forEach((function(e){t[e]&&(n[e]=t[e])}))}function B_(e,t,n){function o(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function r(){return!e||"string"==typeof e}for(var i="string"!=typeof t?[].concat(t):t.split(".");i.length>1;){if(r())return{};var a=o(i.shift());!e[a]&&n&&(e[a]=new n),e=Object.prototype.hasOwnProperty.call(e,a)?e[a]:{}}return r()?{}:{obj:e,k:o(i.shift())}}function P_(e,t,n){var o=B_(e,t,Object);o.obj[o.k]=n}function z_(e,t){var n=B_(e,t),o=n.obj,r=n.k;if(o)return o[r]}function M_(e,t,n){var o=z_(e,n);return void 0!==o?o:z_(t,n)}function j_(e,t,n){for(var o in t)"__proto__"!==o&&"constructor"!==o&&(o in e?"string"==typeof e[o]||e[o]instanceof String||"string"==typeof t[o]||t[o]instanceof String?n&&(e[o]=t[o]):j_(e[o],t[o],n):e[o]=t[o]);return e}function U_(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var V_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function H_(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,(function(e){return V_[e]})):e}var F_="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1;function K_(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(e){if(e[t])return e[t];for(var o=t.split(n),r=e,i=0;i<o.length;++i){if(!r)return;if("string"==typeof r[o[i]]&&i+1<o.length)return;if(void 0===r[o[i]]){for(var a=2,s=o.slice(i,i+a).join(n),c=r[s];void 0===c&&o.length>i+a;)a++,c=r[s=o.slice(i,i+a).join(n)];if(void 0===c)return;if("string"==typeof c)return c;if(s&&"string"==typeof c[s])return c[s];var l=o.slice(i+a).join(n);return l?K_(c,l,n):void 0}r=r[o[i]]}return r}}var G_=function(e){function t(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return y_(this,t),n=S_(this,T_(t).call(this)),F_&&N_.call(E_(n)),n.data=e||{},n.options=o,void 0===n.options.keySeparator&&(n.options.keySeparator="."),void 0===n.options.ignoreJSONStructure&&(n.options.ignoreJSONStructure=!0),n}return O_(t,e),w_(t,[{key:"addNamespaces",value:function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}},{key:"removeNamespaces",value:function(e){var t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}},{key:"getResource",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=void 0!==o.keySeparator?o.keySeparator:this.options.keySeparator,i=void 0!==o.ignoreJSONStructure?o.ignoreJSONStructure:this.options.ignoreJSONStructure,a=[e,t];n&&"string"!=typeof n&&(a=a.concat(n)),n&&"string"==typeof n&&(a=a.concat(r?n.split(r):n)),e.indexOf(".")>-1&&(a=e.split("."));var s=z_(this.data,a);return s||!i||"string"!=typeof n?s:K_(this.data&&this.data[e]&&this.data[e][t],n,r)}},{key:"addResource",value:function(e,t,n,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},i=this.options.keySeparator;void 0===i&&(i=".");var a=[e,t];n&&(a=a.concat(i?n.split(i):n)),e.indexOf(".")>-1&&(o=t,t=(a=e.split("."))[1]),this.addNamespaces(t),P_(this.data,a,o),r.silent||this.emit("added",e,t,n,o)}},{key:"addResources",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var r in n)"string"!=typeof n[r]&&"[object Array]"!==Object.prototype.toString.apply(n[r])||this.addResource(e,t,r,n[r],{silent:!0});o.silent||this.emit("added",e,t,n)}},{key:"addResourceBundle",value:function(e,t,n,o,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},a=[e,t];e.indexOf(".")>-1&&(o=n,n=t,t=(a=e.split("."))[1]),this.addNamespaces(t);var s=z_(this.data,a)||{};o?j_(s,n,r):s=b_({},s,n),P_(this.data,a,s),i.silent||this.emit("added",e,t,n)}},{key:"removeResourceBundle",value:function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}},{key:"hasResourceBundle",value:function(e,t){return void 0!==this.getResource(e,t)}},{key:"getResourceBundle",value:function(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?b_({},{},this.getResource(e,t)):this.getResource(e,t)}},{key:"getDataByLanguage",value:function(e){return this.data[e]}},{key:"toJSON",value:function(){return this.data}}]),t}(N_),J_={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,n,o,r){var i=this;return e.forEach((function(e){i.processors[e]&&(t=i.processors[e].process(t,n,o,r))})),t}},q_={},W_=function(e){function t(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return y_(this,t),n=S_(this,T_(t).call(this)),F_&&N_.call(E_(n)),D_(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,E_(n)),n.options=o,void 0===n.options.keySeparator&&(n.options.keySeparator="."),n.logger=R_.create("translator"),n}return O_(t,e),w_(t,[{key:"changeLanguage",value:function(e){e&&(this.language=e)}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;var n=this.resolve(e,t);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(e,t){var n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");var o=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,r=t.ns||this.options.defaultNS;if(n&&e.indexOf(n)>-1){var i=e.match(this.interpolator.nestingRegexp);if(i&&i.length>0)return{key:e,namespaces:r};var a=e.split(n);(n!==o||n===o&&this.options.ns.indexOf(a[0])>-1)&&(r=a.shift()),e=a.join(o)}return"string"==typeof r&&(r=[r]),{key:e,namespaces:r}}},{key:"translate",value:function(e,n,o){var r=this;if("object"!==m_(n)&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),n||(n={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);var i=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,a=this.extractFromKey(e[e.length-1],n),s=a.key,c=a.namespaces,l=c[c.length-1],u=n.lng||this.language,d=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&"cimode"===u.toLowerCase()){if(d){var h=n.nsSeparator||this.options.nsSeparator;return l+h+s}return s}var f=this.resolve(e,n),p=f&&f.res,g=f&&f.usedKey||s,_=f&&f.exactUsedKey||s,m=Object.prototype.toString.apply(p),v=["[object Number]","[object Function]","[object RegExp]"],b=void 0!==n.joinArrays?n.joinArrays:this.options.joinArrays,y=!this.i18nFormat||this.i18nFormat.handleAsObject,k="string"!=typeof p&&"boolean"!=typeof p&&"number"!=typeof p;if(y&&p&&k&&v.indexOf(m)<0&&("string"!=typeof b||"[object Array]"!==m)){if(!n.returnObjects&&!this.options.returnObjects)return this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,p,b_({},n,{ns:c})):"key '".concat(s," (").concat(this.language,")' returned an object instead of string.");if(i){var w="[object Array]"===m,E=w?[]:{},S=w?_:g;for(var T in p)if(Object.prototype.hasOwnProperty.call(p,T)){var I="".concat(S).concat(i).concat(T);E[T]=this.translate(I,b_({},n,{joinArrays:!1,ns:c})),E[T]===I&&(E[T]=p[T])}p=E}}else if(y&&"string"==typeof b&&"[object Array]"===m)(p=p.join(b))&&(p=this.extendTranslation(p,e,n,o));else{var O=!1,C=!1,L=void 0!==n.count&&"string"!=typeof n.count,R=t.hasDefaultValue(n),N=L?this.pluralResolver.getSuffix(u,n.count):"",A=n["defaultValue".concat(N)]||n.defaultValue;!this.isValidLookup(p)&&R&&(O=!0,p=A),this.isValidLookup(p)||(C=!0,p=s);var x=n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey,D=x&&C?void 0:p,B=R&&A!==p&&this.options.updateMissing;if(C||O||B){if(this.logger.log(B?"updateKey":"missingKey",u,l,s,B?A:p),i){var P=this.resolve(s,b_({},n,{keySeparator:!1}));P&&P.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var z=[],M=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if("fallback"===this.options.saveMissingTo&&M&&M[0])for(var j=0;j<M.length;j++)z.push(M[j]);else"all"===this.options.saveMissingTo?z=this.languageUtils.toResolveHierarchy(n.lng||this.language):z.push(n.lng||this.language);var U=function(e,t,o){r.options.missingKeyHandler?r.options.missingKeyHandler(e,l,t,B?o:D,B,n):r.backendConnector&&r.backendConnector.saveMissing&&r.backendConnector.saveMissing(e,l,t,B?o:D,B,n),r.emit("missingKey",e,l,t,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&L?z.forEach((function(e){r.pluralResolver.getSuffixes(e).forEach((function(t){U([e],s+t,n["defaultValue".concat(t)]||A)}))})):U(z,s,A))}p=this.extendTranslation(p,e,n,f,o),C&&p===s&&this.options.appendNamespaceToMissingKey&&(p="".concat(l,":").concat(s)),(C||O)&&this.options.parseMissingKeyHandler&&(p=this.options.parseMissingKeyHandler(p))}return p}},{key:"extendTranslation",value:function(e,t,n,o,r){var i=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,n,o.usedLng,o.usedNS,o.usedKey,{resolved:o});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(b_({},n,{interpolation:b_({},this.options.interpolation,n.interpolation)}));var a,s=n.interpolation&&n.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;if(s){var c=e.match(this.interpolator.nestingRegexp);a=c&&c.length}var l=n.replace&&"string"!=typeof n.replace?n.replace:n;if(this.options.interpolation.defaultVariables&&(l=b_({},this.options.interpolation.defaultVariables,l)),e=this.interpolator.interpolate(e,l,n.lng||this.language,n),s){var u=e.match(this.interpolator.nestingRegexp);a<(u&&u.length)&&(n.nest=!1)}!1!==n.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];return r&&r[0]===o[0]&&!n.context?(i.logger.warn("It seems you are nesting recursively key: ".concat(o[0]," in key: ").concat(t[0])),null):i.translate.apply(i,o.concat([t]))}),n)),n.interpolation&&this.interpolator.reset()}var d=n.postProcess||this.options.postProcess,h="string"==typeof d?[d]:d;return null!=e&&h&&h.length&&!1!==n.applyPostProcessor&&(e=J_.handle(h,e,t,this.options&&this.options.postProcessPassResolved?b_({i18nResolved:o},n):n,this)),e}},{key:"resolve",value:function(e){var t,n,o,r,i,a=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e&&(e=[e]),e.forEach((function(e){if(!a.isValidLookup(t)){var c=a.extractFromKey(e,s),l=c.key;n=l;var u=c.namespaces;a.options.fallbackNS&&(u=u.concat(a.options.fallbackNS));var d=void 0!==s.count&&"string"!=typeof s.count,h=void 0!==s.context&&("string"==typeof s.context||"number"==typeof s.context)&&""!==s.context,f=s.lngs?s.lngs:a.languageUtils.toResolveHierarchy(s.lng||a.language,s.fallbackLng);u.forEach((function(e){a.isValidLookup(t)||(i=e,!q_["".concat(f[0],"-").concat(e)]&&a.utils&&a.utils.hasLoadedNamespace&&!a.utils.hasLoadedNamespace(i)&&(q_["".concat(f[0],"-").concat(e)]=!0,a.logger.warn('key "'.concat(n,'" for languages "').concat(f.join(", "),'" won\'t get resolved as namespace "').concat(i,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),f.forEach((function(n){if(!a.isValidLookup(t)){r=n;var i,c,u=l,f=[u];if(a.i18nFormat&&a.i18nFormat.addLookupKeys)a.i18nFormat.addLookupKeys(f,l,n,e,s);else d&&(i=a.pluralResolver.getSuffix(n,s.count)),d&&h&&f.push(u+i),h&&f.push(u+="".concat(a.options.contextSeparator).concat(s.context)),d&&f.push(u+=i);for(;c=f.pop();)a.isValidLookup(t)||(o=c,t=a.getResource(n,e,c,s))}})))}))}})),{res:t,usedKey:n,exactUsedKey:o,usedLng:r,usedNS:i}}},{key:"isValidLookup",value:function(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}},{key:"getResource",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,n,o):this.resourceStore.getResource(e,t,n,o)}}],[{key:"hasDefaultValue",value:function(e){var t="defaultValue";for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t===n.substring(0,t.length)&&void 0!==e[n])return!0;return!1}}]),t}(N_);function $_(e){return e.charAt(0).toUpperCase()+e.slice(1)}var Y_=function(){function e(t){y_(this,e),this.options=t,this.whitelist=this.options.supportedLngs||!1,this.supportedLngs=this.options.supportedLngs||!1,this.logger=R_.create("languageUtils")}return w_(e,[{key:"getScriptPartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return null;var t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}},{key:"getLanguagePartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return e;var t=e.split("-");return this.formatLanguageCode(t[0])}},{key:"formatLanguageCode",value:function(e){if("string"==typeof e&&e.indexOf("-")>-1){var t=["hans","hant","latn","cyrl","cans","mong","arab"],n=e.split("-");return this.options.lowerCaseLng?n=n.map((function(e){return e.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=$_(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=$_(n[1].toLowerCase())),t.indexOf(n[2].toLowerCase())>-1&&(n[2]=$_(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}},{key:"isWhitelisted",value:function(e){return this.logger.deprecate("languageUtils.isWhitelisted",'function "isWhitelisted" will be renamed to "isSupportedCode" in the next major - please make sure to rename it\'s usage asap.'),this.isSupportedCode(e)}},{key:"isSupportedCode",value:function(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}},{key:"getBestMatchFromCodes",value:function(e){var t,n=this;return e?(e.forEach((function(e){if(!t){var o=n.formatLanguageCode(e);n.options.supportedLngs&&!n.isSupportedCode(o)||(t=o)}})),!t&&this.options.supportedLngs&&e.forEach((function(e){if(!t){var o=n.getLanguagePartFromCode(e);if(n.isSupportedCode(o))return t=o;t=n.options.supportedLngs.find((function(e){if(0===e.indexOf(o))return e}))}})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t):null}},{key:"getFallbackCodes",value:function(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),"string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}},{key:"toResolveHierarchy",value:function(e,t){var n=this,o=this.getFallbackCodes(t||this.options.fallbackLng||[],e),r=[],i=function(e){e&&(n.isSupportedCode(e)?r.push(e):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))};return"string"==typeof e&&e.indexOf("-")>-1?("languageOnly"!==this.options.load&&i(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&i(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&i(this.getLanguagePartFromCode(e))):"string"==typeof e&&i(this.formatLanguageCode(e)),o.forEach((function(e){r.indexOf(e)<0&&i(n.formatLanguageCode(e))})),r}}]),e}(),Q_=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],X_={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},5:function(e){return Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1&&e%100!=11?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0==e||e%100>0&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)}};function Z_(){var e={};return Q_.forEach((function(t){t.lngs.forEach((function(n){e[n]={numbers:t.nr,plurals:X_[t.fc]}}))})),e}var em=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};y_(this,e),this.languageUtils=t,this.options=n,this.logger=R_.create("pluralResolver"),this.rules=Z_()}return w_(e,[{key:"addRule",value:function(e,t){this.rules[e]=t}},{key:"getRule",value:function(e){return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}},{key:"needsPlural",value:function(e){var t=this.getRule(e);return t&&t.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(e,t){return this.getSuffixes(e).map((function(e){return t+e}))}},{key:"getSuffixes",value:function(e){var t=this,n=this.getRule(e);return n?n.numbers.map((function(n){return t.getSuffix(e,n)})):[]}},{key:"getSuffix",value:function(e,t){var n=this,o=this.getRule(e);if(o){var r=o.noAbs?o.plurals(t):o.plurals(Math.abs(t)),i=o.numbers[r];this.options.simplifyPluralSuffix&&2===o.numbers.length&&1===o.numbers[0]&&(2===i?i="plural":1===i&&(i=""));var a=function(){return n.options.prepend&&i.toString()?n.options.prepend+i.toString():i.toString()};return"v1"===this.options.compatibilityJSON?1===i?"":"number"==typeof i?"_plural_".concat(i.toString()):a():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===o.numbers.length&&1===o.numbers[0]?a():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}return this.logger.warn("no plural rule found for: ".concat(e)),""}}]),e}(),tm=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y_(this,e),this.logger=R_.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(e){return e},this.init(t)}return w_(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});var t=e.interpolation;this.escape=void 0!==t.escape?t.escape:H_,this.escapeValue=void 0===t.escapeValue||t.escapeValue,this.useRawValueToEscape=void 0!==t.useRawValueToEscape&&t.useRawValueToEscape,this.prefix=t.prefix?U_(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?U_(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?U_(t.nestingPrefix):t.nestingPrefixEscaped||U_("$t("),this.nestingSuffix=t.nestingSuffix?U_(t.nestingSuffix):t.nestingSuffixEscaped||U_(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator?t.nestingOptionsSeparator:t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces?t.maxReplaces:1e3,this.alwaysFormat=void 0!==t.alwaysFormat&&t.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var e="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(e,"g");var t="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(t,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(e,t,n,o){var r,i,a,s=this,c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function l(e){return e.replace(/\$/g,"$$$$")}var u=function(e){if(e.indexOf(s.formatSeparator)<0){var r=M_(t,c,e);return s.alwaysFormat?s.format(r,void 0,n,b_({},o,t,{interpolationkey:e})):r}var i=e.split(s.formatSeparator),a=i.shift().trim(),l=i.join(s.formatSeparator).trim();return s.format(M_(t,c,a),l,n,b_({},o,t,{interpolationkey:a}))};this.resetRegExp();var d=o&&o.missingInterpolationHandler||this.options.missingInterpolationHandler,h=o&&o.interpolation&&o.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(e){return l(e)}},{regex:this.regexp,safeValue:function(e){return s.escapeValue?l(s.escape(e)):l(e)}}].forEach((function(t){for(a=0;r=t.regex.exec(e);){if(void 0===(i=u(r[1].trim())))if("function"==typeof d){var n=d(e,r,o);i="string"==typeof n?n:""}else{if(h){i=r[0];continue}s.logger.warn("missed to pass in variable ".concat(r[1]," for interpolating ").concat(e)),i=""}else"string"==typeof i||s.useRawValueToEscape||(i=x_(i));var c=t.safeValue(i);if(e=e.replace(r[0],c),h?(t.regex.lastIndex+=c.length,t.regex.lastIndex-=r[0].length):t.regex.lastIndex=0,++a>=s.maxReplaces)break}})),e}},{key:"nest",value:function(e,t){var n,o,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=b_({},i);function s(e,t){var n=this.nestingOptionsSeparator;if(e.indexOf(n)<0)return e;var o=e.split(new RegExp("".concat(n,"[ ]*{"))),r="{".concat(o[1]);e=o[0],r=(r=this.interpolate(r,a)).replace(/'/g,'"');try{a=JSON.parse(r),t&&(a=b_({},t,a))}catch(t){return this.logger.warn("failed parsing options string in nesting for key ".concat(e),t),"".concat(e).concat(n).concat(r)}return delete a.defaultValue,e}for(a.applyPostProcessor=!1,delete a.defaultValue;n=this.nestingRegexp.exec(e);){var c=[],l=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){var u=n[1].split(this.formatSeparator).map((function(e){return e.trim()}));n[1]=u.shift(),c=u,l=!0}if((o=t(s.call(this,n[1].trim(),a),a))&&n[0]===e&&"string"!=typeof o)return o;"string"!=typeof o&&(o=x_(o)),o||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(e)),o=""),l&&(o=c.reduce((function(e,t){return r.format(e,t,i.lng,b_({},i,{interpolationkey:n[1].trim()}))}),o.trim())),e=e.replace(n[0],o),this.regexp.lastIndex=0}return e}}]),e}();var nm=function(e){function t(e,n,o){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return y_(this,t),r=S_(this,T_(t).call(this)),F_&&N_.call(E_(r)),r.backend=e,r.store=n,r.services=o,r.languageUtils=o.languageUtils,r.options=i,r.logger=R_.create("backendConnector"),r.state={},r.queue=[],r.backend&&r.backend.init&&r.backend.init(o,i.backend,i),r}return O_(t,e),w_(t,[{key:"queueLoad",value:function(e,t,n,o){var r=this,i=[],a=[],s=[],c=[];return e.forEach((function(e){var o=!0;t.forEach((function(t){var s="".concat(e,"|").concat(t);!n.reload&&r.store.hasResourceBundle(e,t)?r.state[s]=2:r.state[s]<0||(1===r.state[s]?a.indexOf(s)<0&&a.push(s):(r.state[s]=1,o=!1,a.indexOf(s)<0&&a.push(s),i.indexOf(s)<0&&i.push(s),c.indexOf(t)<0&&c.push(t)))})),o||s.push(e)})),(i.length||a.length)&&this.queue.push({pending:a,loaded:{},errors:[],callback:o}),{toLoad:i,pending:a,toLoadLanguages:s,toLoadNamespaces:c}}},{key:"loaded",value:function(e,t,n){var o=e.split("|"),r=o[0],i=o[1];t&&this.emit("failedLoading",r,i,t),n&&this.store.addResourceBundle(r,i,n),this.state[e]=t?-1:2;var a={};this.queue.forEach((function(n){!function(e,t,n,o){var r=B_(e,t,Object),i=r.obj,a=r.k;i[a]=i[a]||[],o&&(i[a]=i[a].concat(n)),o||i[a].push(n)}(n.loaded,[r],i),function(e,t){for(var n=e.indexOf(t);-1!==n;)e.splice(n,1),n=e.indexOf(t)}(n.pending,e),t&&n.errors.push(t),0!==n.pending.length||n.done||(Object.keys(n.loaded).forEach((function(e){a[e]||(a[e]=[]),n.loaded[e].length&&n.loaded[e].forEach((function(t){a[e].indexOf(t)<0&&a[e].push(t)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",a),this.queue=this.queue.filter((function(e){return!e.done}))}},{key:"read",value:function(e,t,n){var o=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:350,a=arguments.length>5?arguments[5]:void 0;return e.length?this.backend[n](e,t,(function(s,c){s&&c&&r<5?setTimeout((function(){o.read.call(o,e,t,n,r+1,2*i,a)}),i):a(s,c)})):a(null,{})}},{key:"prepareLoading",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]);var i=this.queueLoad(e,t,o,r);if(!i.toLoad.length)return i.pending.length||r(),null;i.toLoad.forEach((function(e){n.loadOne(e)}))}},{key:"load",value:function(e,t,n){this.prepareLoading(e,t,{},n)}},{key:"reload",value:function(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}},{key:"loadOne",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=e.split("|"),r=o[0],i=o[1];this.read(r,i,"read",void 0,void 0,(function(o,a){o&&t.logger.warn("".concat(n,"loading namespace ").concat(i," for language ").concat(r," failed"),o),!o&&a&&t.logger.log("".concat(n,"loaded namespace ").concat(i," for language ").concat(r),a),t.loaded(e,o,a)}))}},{key:"saveMissing",value:function(e,t,n,o,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)?this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(e,t,n,o,null,b_({},i,{isUpdate:r})),e&&e[0]&&this.store.addResource(e[0],t,n,o))}}]),t}(N_);function om(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t={};if("object"===m_(e[1])&&(t=e[1]),"string"==typeof e[1]&&(t.defaultValue=e[1]),"string"==typeof e[2]&&(t.tDescription=e[2]),"object"===m_(e[2])||"object"===m_(e[3])){var n=e[3]||e[2];Object.keys(n).forEach((function(e){t[e]=n[e]}))}return t},interpolation:{escapeValue:!0,format:function(e,t,n,o){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!1}}}function rm(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.whitelist&&(e.whitelist&&e.whitelist.indexOf("cimode")<0&&(e.whitelist=e.whitelist.concat(["cimode"])),e.supportedLngs=e.whitelist),e.nonExplicitWhitelist&&(e.nonExplicitSupportedLngs=e.nonExplicitWhitelist),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function im(){}var am=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;if(y_(this,t),e=S_(this,T_(t).call(this)),F_&&N_.call(E_(e)),e.options=rm(n),e.services={},e.logger=R_,e.modules={external:[]},o&&!e.isInitialized&&!n.isClone){if(!e.options.initImmediate)return e.init(n,o),S_(e,E_(e));setTimeout((function(){e.init(n,o)}),0)}return e}return O_(t,e),w_(t,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;function o(e){return e?"function"==typeof e?new e:e:null}if("function"==typeof t&&(n=t,t={}),t.whitelist&&!t.supportedLngs&&this.logger.deprecate("whitelist",'option "whitelist" will be renamed to "supportedLngs" in the next major - please make sure to rename this option asap.'),t.nonExplicitWhitelist&&!t.nonExplicitSupportedLngs&&this.logger.deprecate("whitelist",'options "nonExplicitWhitelist" will be renamed to "nonExplicitSupportedLngs" in the next major - please make sure to rename this option asap.'),this.options=b_({},om(),this.options,rm(t)),this.format=this.options.interpolation.format,n||(n=im),!this.options.isClone){this.modules.logger?R_.init(o(this.modules.logger),this.options):R_.init(null,this.options);var r=new Y_(this.options);this.store=new G_(this.options.resources,this.options);var i=this.services;i.logger=R_,i.resourceStore=this.store,i.languageUtils=r,i.pluralResolver=new em(r,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),i.interpolator=new tm(this.options),i.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},i.backendConnector=new nm(o(this.modules.backend),i.resourceStore,i,this.options),i.backendConnector.on("*",(function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];e.emit.apply(e,[t].concat(o))})),this.modules.languageDetector&&(i.languageDetector=o(this.modules.languageDetector),i.languageDetector.init(i,this.options.detection,this.options)),this.modules.i18nFormat&&(i.i18nFormat=o(this.modules.i18nFormat),i.i18nFormat.init&&i.i18nFormat.init(this)),this.translator=new W_(this.services,this.options),this.translator.on("*",(function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];e.emit.apply(e,[t].concat(o))})),this.modules.external.forEach((function(t){t.init&&t.init(e)}))}if(this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var a=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);a.length>0&&"dev"!==a[0]&&(this.options.lng=a[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");var s=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];s.forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments)}}));var c=["addResource","addResources","addResourceBundle","removeResourceBundle"];c.forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments),e}}));var l=A_(),u=function(){var t=function(t,o){e.isInitialized&&!e.initializedStoreOnce&&e.logger.warn("init: i18next is already initialized. You should call init just once!"),e.isInitialized=!0,e.options.isClone||e.logger.log("initialized",e.options),e.emit("initialized",e.options),l.resolve(o),n(t,o)};if(e.languages&&"v1"!==e.options.compatibilityAPI&&!e.isInitialized)return t(null,e.t.bind(e));e.changeLanguage(e.options.lng,t)};return this.options.resources||!this.options.initImmediate?u():setTimeout(u,0),l}},{key:"loadResources",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:im,o=n,r="string"==typeof e?e:this.language;if("function"==typeof e&&(o=e),!this.options.resources||this.options.partialBundledLanguages){if(r&&"cimode"===r.toLowerCase())return o();var i=[],a=function(e){e&&t.services.languageUtils.toResolveHierarchy(e).forEach((function(e){i.indexOf(e)<0&&i.push(e)}))};if(r)a(r);else{var s=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);s.forEach((function(e){return a(e)}))}this.options.preload&&this.options.preload.forEach((function(e){return a(e)})),this.services.backendConnector.load(i,this.options.ns,o)}else o(null)}},{key:"reloadResources",value:function(e,t,n){var o=A_();return e||(e=this.languages),t||(t=this.options.ns),n||(n=im),this.services.backendConnector.reload(e,t,(function(e){o.resolve(),n(e)})),o}},{key:"use",value:function(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&J_.addPostProcessor(e),"3rdParty"===e.type&&this.modules.external.push(e),this}},{key:"changeLanguage",value:function(e,t){var n=this;this.isLanguageChangingTo=e;var o=A_();this.emit("languageChanging",e);var r=function(r){e||r||!n.services.languageDetector||(r=[]);var i="string"==typeof r?r:n.services.languageUtils.getBestMatchFromCodes(r);i&&(n.language||(n.language=i,n.languages=n.services.languageUtils.toResolveHierarchy(i)),n.translator.language||n.translator.changeLanguage(i),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage(i)),n.loadResources(i,(function(e){!function(e,r){r?(n.language=r,n.languages=n.services.languageUtils.toResolveHierarchy(r),n.translator.changeLanguage(r),n.isLanguageChangingTo=void 0,n.emit("languageChanged",r),n.logger.log("languageChanged",r)):n.isLanguageChangingTo=void 0,o.resolve((function(){return n.t.apply(n,arguments)})),t&&t(e,(function(){return n.t.apply(n,arguments)}))}(e,i)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(r):r(e):r(this.services.languageDetector.detect()),o}},{key:"getFixedT",value:function(e,t,n){var o=this,r=function e(t,r){var i;if("object"!==m_(r)){for(var a=arguments.length,s=new Array(a>2?a-2:0),c=2;c<a;c++)s[c-2]=arguments[c];i=o.options.overloadTranslationOptionHandler([t,r].concat(s))}else i=b_({},r);i.lng=i.lng||e.lng,i.lngs=i.lngs||e.lngs,i.ns=i.ns||e.ns;var l=o.options.keySeparator||".",u=n?"".concat(n).concat(l).concat(t):t;return o.t(u,i)};return"string"==typeof e?r.lng=e:r.lngs=e,r.ns=t,r.keyPrefix=n,r}},{key:"t",value:function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)}},{key:"exists",value:function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)}},{key:"setDefaultNamespace",value:function(e){this.options.defaultNS=e}},{key:"hasLoadedNamespace",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var o=this.languages[0],r=!!this.options&&this.options.fallbackLng,i=this.languages[this.languages.length-1];if("cimode"===o.toLowerCase())return!0;var a=function(e,n){var o=t.services.backendConnector.state["".concat(e,"|").concat(n)];return-1===o||2===o};if(n.precheck){var s=n.precheck(this,a);if(void 0!==s)return s}return!!this.hasResourceBundle(o,e)||(!this.services.backendConnector.backend||!(!a(o,e)||r&&!a(i,e)))}},{key:"loadNamespaces",value:function(e,t){var n=this,o=A_();return this.options.ns?("string"==typeof e&&(e=[e]),e.forEach((function(e){n.options.ns.indexOf(e)<0&&n.options.ns.push(e)})),this.loadResources((function(e){o.resolve(),t&&t(e)})),o):(t&&t(),Promise.resolve())}},{key:"loadLanguages",value:function(e,t){var n=A_();"string"==typeof e&&(e=[e]);var o=this.options.preload||[],r=e.filter((function(e){return o.indexOf(e)<0}));return r.length?(this.options.preload=o.concat(r),this.loadResources((function(e){n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}},{key:"dir",value:function(e){if(e||(e=this.languages&&this.languages.length>0?this.languages[0]:this.language),!e)return"rtl";return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(e))>=0?"rtl":"ltr"}},{key:"createInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new t(e,n)}},{key:"cloneInstance",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:im,r=b_({},this.options,n,{isClone:!0}),i=new t(r),a=["store","services","language"];return a.forEach((function(t){i[t]=e[t]})),i.services=b_({},this.services),i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i.translator=new W_(i.services,i.options),i.translator.on("*",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];i.emit.apply(i,[e].concat(n))})),i.init(r,o),i.translator.options=i.options,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages}}}]),t}(N_),sm=new am,cm={Blockit_BlockGuide_AutoUpdateLink:"èªå¨æ´æ°",Blockit_BlockGuide_BasicVersionLow:"å®¢æ·ç«¯çæ¬è¿ä½ï¼è¯·ååçº§",Blockit_BlockGuide_DiagnoseError:"æ­¤æµè§å¨å­å¨å¼å®¹æ§é®é¢ï¼è¯·åçº§ææ´æ¢æµè§å¨åç»§ç»­è®¿é®",Blockit_BlockGuide_LoadFail:"å è½½å¤±è´¥ï¼è¯·{retry}",Blockit_BlockGuide_LoadFailRetry:"å è½½å¤±è´¥ï¼è¯·éè¯",Blockit_BlockGuide_LoadTimeout:"å è½½è¶æ¶ï¼è¯·{retry}",Blockit_BlockGuide_NetworkError:"ç½ç»å¼å¸¸ï¼è¯·å·æ°éè¯",Blockit_BlockGuide_NetworkError_Retry:"ç½ç»å¼å¸¸ï¼è¯·{retry}",Blockit_BlockGuide_NewVersionFound:"åç°æ°çæ¬ï¼ç«å³{update}æä¸æ¬¡éå¯æ¶{autoUpdate}",Blockit_BlockGuide_RefreshButton:"å·æ°",Blockit_BlockGuide_ReloadButton:"éæ°å è½½",Blockit_BlockGuide_UpdateFailedPrompt:"æ´æ°å¤±è´¥ï¼è¯·{retry}æä¸æ¬¡éå¯æ¶{autoUpdate}",Blockit_BlockGuide_UpdateRetryLink:"éè¯",Blockit_BlockGuide_VersionUpdateLink:"æ´æ°"},lm={Blockit_BlockGuide_AutoUpdateLink:"automatically update",Blockit_BlockGuide_BasicVersionLow:"The app version is out of date. Please update it",Blockit_BlockGuide_DiagnoseError:"There is a compatibility problem with this browser, please upgrade or replace the browser and continue to access",Blockit_BlockGuide_LoadFail:"Loading failed. Please {retry}",Blockit_BlockGuide_LoadFailRetry:"Loading failed, please try again",Blockit_BlockGuide_LoadTimeout:"Loading timed out. Please {retry}",Blockit_BlockGuide_NetworkError:"Network error. Please refresh and try again",Blockit_BlockGuide_NetworkError_Retry:"Network error, please {retry}",Blockit_BlockGuide_NewVersionFound:"A new version is available. You can {update} now or enable it to {autoUpdate} upon the next restart",Blockit_BlockGuide_RefreshButton:"Refresh",Blockit_BlockGuide_ReloadButton:"Reload",Blockit_BlockGuide_UpdateFailedPrompt:"Update failed. Please {retry} or enable it to {autoUpdate} upon the next restart",Blockit_BlockGuide_UpdateRetryLink:"retry",Blockit_BlockGuide_VersionUpdateLink:"update"},um={Blockit_BlockGuide_AutoUpdateLink:"automatically update",Blockit_BlockGuide_BasicVersionLow:"The app version is out of date. Please update it",Blockit_BlockGuide_DiagnoseError:"There is a compatibility problem with this browser, please upgrade or replace the browser and continue to access",Blockit_BlockGuide_LoadFail:"Loading failed. Please {retry}",Blockit_BlockGuide_LoadFailRetry:"Loading failed, please try again",Blockit_BlockGuide_LoadTimeout:"Loading timed out. Please {retry}",Blockit_BlockGuide_NetworkError:"Network error. Please refresh and try again",Blockit_BlockGuide_NetworkError_Retry:"Network error, please {retry}",Blockit_BlockGuide_NewVersionFound:"A new version is available. You can {update} now or enable it to {autoUpdate} upon the next restart",Blockit_BlockGuide_RefreshButton:"Refresh",Blockit_BlockGuide_ReloadButton:"Reload",Blockit_BlockGuide_UpdateFailedPrompt:"Update failed. Please {retry} or enable it to {autoUpdate} upon the next restart",Blockit_BlockGuide_UpdateRetryLink:"retry",Blockit_BlockGuide_VersionUpdateLink:"update"},dm={init(e){sm.init({keySeparator:!1,fallbackLng:["en-US","zh-CN"],lng:e,resources:{"zh-CN":{translation:cm},"en-US":{translation:lm},"ja-JP":{translation:um}}})},setLocale:sm.changeLanguage.bind(sm),t:sm.t.bind(sm),has:sm.exists.bind(sm)};function hm(e){const{locale:t,host:n,env:o,region:r,domain:i,platform:a}=$r(e);this.env={locale:t,host:n,env:o,region:r,domain:i,platform:a},Mg.registerEngine(Vg),this.blockEngine=Mg.registerEngine(a_);const{customEngines:s}=$f.getLocalSetting();Mg.customEngines=function(e){return Array.isArray(e)?e.map((e=>({...e,blockTypeIDs:Array.isArray(e.blockTypeIDs)?e.blockTypeIDs:"string"==typeof e.blockTypeID?[e.blockTypeID]:[]}))):[]}(s),Mg.customEngines.forEach((e=>{const t=d_.find((t=>t.engineName===e.name));t&&Mg.registerEngine(t,!1,[e])})),this.version="1.13.7",dm.init(t);for(const e of __)this[e]=g_(this[e],e).bind(this)}function fm(e,t){if(t.logger({name:ap.events.CONFIG_SET_DEBUG_PORT_START,categories:{port:(null==e?void 0:e.toString())||""}}),this.env.debugPort!==e){if("string"!=typeof e&&"number"!=typeof e&&void 0!==e)throw new mi({code:mi.code.ParameterError,message:"Parameter port is invalid"});this.env.debugPort=e,ap.setContext({debugPort:e}),t.logger(ap.events.CONFIG_SET_DEBUG_PORT_RESULT)}}function pm(e,t){t.logger(ap.events.CONFIG_SET_ENV_START),$r(e),Object.assign(this.env,e),ap.setContext(this.env),e.locale&&dm.setLocale(e.locale),t.logger(ap.events.CONFIG_SET_ENV_RESULT)}function gm(e){return Promise.resolve(`${e.domain}-${e.uuid}`)}function _m(e,t){const{moreParams:n,config:o}=e,{logger:r}=n;r({name:ap.events.INIT_START,categories:{config:ap.utils.serialize(o),name:ap.utils.serialize(t)}}),this.blockEngineURL&&(e.blockEngineURL=this.blockEngineURL),e.env&&pm.call(this,e.env,n.createTraceContext()),e.debugPort&&fm.call(this,e.debugPort,n.createTraceContext());const{userId:i,tenantId:a,larkVersion:s,hostExtension:c,theme:l="light"}=o,{encryptUserId:u}=ap.setContext({userId:i,tenantId:a,hostExtension:c,larkVersion:s});var d;null!=c&&c.containerID&&$r({containerID:c.containerID}),d={userID:u||"",logID:n.createTraceSpan().traceId},ui={...ui,...d},this.theme=l;const h="string"==typeof t?t:"";return Promise.resolve({options:e,engineName:h})}function mm(e,t){return t.logger({name:ap.events.UPDATE_THEME_START,categories:{theme:e}}),this.theme=e,sp.emit("themeChange",e),this.engineInitTask().then((n=>{try{Mg.updateTheme(e)}catch(e){if(n)throw n;throw e}t.logger(ap.events.UPDATE_THEME_END)}))}function vm(e){const t={blockID:e.blockID,data:e.data,type:e.type};Mg.updateTypedData(Wr,t)}const bm=mi.code;function ym(e){return"string"!=typeof e?"en_us":e.startsWith("zh")?"zh_cn":e.startsWith("en")?"en_us":e.startsWith("ja")?"ja_jp":"en_us"}function km(e,t){if(e){const n=ym(t);if(n)return e[n]}return""}function wm(e){return[cp.NETWORK_ERROR_META,cp.NETWORK_ERROR_PACKAGE,cp.NETWORK_ERROR_SDK,cp.NETWORK_ERROR_SETTINGS,cp.NETWORK_ERROR_APPCHECK].includes(e)}function Em(e,t,n){const{errCode:o,extraErrInfo:r={}}=e,{block_extension_tip:i,block_extension:a}=r;if(o===cp.APP_CHECK_FAIL&&i&&a){const e=i,n={status:a.status,tips:{content:km(e.content,t),params:{},buttons:(e.buttons||[]).map((e=>({name:km(e.content,t),handler(){window.open(function(e,t,n){if(!t)return e;const o=ym(n);return Object.keys(t).forEach((n=>{const r=`{${n}}`;if(e.includes(r)){const i=t[n];try{const t=JSON.parse(i);o&&t[o]&&(e=e.replace(r,t[o]))}catch(e){}}})),e}(e.schema,e.extras,t))}})))}};return Object.keys(e.params||{}).forEach((o=>{if("user"===o){const r=JSON.parse(e.params[o]);n.tips.params[o]={name:"@"+km(r.user_name,t),handler(){location.assign("lark://client/chat?userId="+r.user_id)}}}})),n}return o===cp.BASIC_LIB_VERSION_LOW?{status:o,tips:{content:dm.t("Blockit_BlockGuide_BasicVersionLow"),params:{},buttons:[]}}:[cp.ISV_LOADING_TIMEOUT,cp.ENGINE_LOADING_TIMEOUT].includes(o)?{status:o,tips:{content:dm.t("Blockit_BlockGuide_LoadTimeout"),params:{retry:{name:dm.t("Blockit_BlockGuide_UpdateRetryLink"),handler:n}},buttons:[]}}:wm(o)?{status:o,tips:{content:dm.t("Blockit_BlockGuide_NetworkError"),params:{},buttons:[{name:dm.t("Blockit_BlockGuide_RefreshButton"),handler:n}]}}:{status:o,tips:{content:dm.t("Blockit_BlockGuide_LoadFailRetry"),params:{},buttons:[{name:dm.t("Blockit_BlockGuide_ReloadButton"),handler:n}]}}}function Sm(e,t){const{locale:n,host:o,env:r,region:i,domain:a,platform:s}=t;return n||o||r||i||a||s?{locale:n||e.locale,env:r||e.env,host:o||e.host,region:i||e.region,domain:a||e.domain,platform:s||e.platform}:e}function Tm(e,t){let n=null;const o={...e.context};let r;const i=e.debug||!1;let a=Dp.ui.showLoading(e.blockRoot,o);return{start(t){t&&Object.assign(o,t);const n="block"===o.type;r=e.moreParams.performance({start:n?ap.events.LOAD_BLOCK_START:ap.events.LOAD_CREATOR_START,end:n?ap.events.LOAD_BLOCK_RESULT:ap.events.LOAD_CREATOR_RESULT,categories:{blockTypeID:o.blockTypeID,blockID:o.blockID,debug:Boolean(i).toString()}}),n&&ap.collect({name:"openplatform_website_block_instance_view",categories:{block_id:o.blockID,block_type_id:o.blockTypeID}})},bindBlock(s){const c="block"===o.type;s.onLoaded((e=>{const{needLoading:t,packageSourceType:n}=e;r&&r.success({categories:{needLoading:t.toString(),packageSourceType:n}}),ap.collect({name:c?"openplatform_website_block_instance_dev":"openplatform_website_creator_instance_dev",categories:{block_id:o.blockID,block_type_id:o.blockTypeID,cache:Boolean("disk"===n).toString(),duration:r.duration,result_type:"success"}})})),s.onReload((()=>{this.remove(),a=Dp.ui.showLoading(e.blockRoot,o),this.start()})),s.onHideLoading((a=>{const{showError:l,error:u}=a;if(this.removeLoading(),l&&u){const{errCode:a,errMsg:l}=u,d=Em(u,t.locale,(()=>{this.removeError(),s.reload(i)}));n=Dp.ui.showError(d,e.blockRoot,o),[cp.ISV_LOADING_TIMEOUT,cp.ENGINE_LOADING_TIMEOUT].includes(a)&&e.moreParams.logger({name:ap.events.MOUNT_BLOCK_TIMEOUT,level:ap.level.error,categories:{error_code:u.errCode.toString(),error_msg:u.errMsg}});const h=[cp.APP_META_INVALID,cp.BASIC_LIB_VERSION_LOW],f=d.status>=0||h.includes(a)||wm(a);ap.collect({name:c?"openplatform_website_block_instance_dev":"openplatform_website_creator_instance_dev",categories:{block_id:o.blockID,block_type_id:o.blockTypeID,result_type:f?"success":"fail"}}),f?r.success({categories:{error_code:a.toString(),error_msg:l,code:d.status.toString()}}):r.fail({categories:{error_code:a.toString(),error_msg:l}})}}))},remove(){this.removeLoading(),this.removeError()},removeLoading(){a&&a(),a=null},removeError(){n&&n(),n=null}}}function Im(e){const{loading:t,blockRoot:n,uiContext:o,retryHandler:r,error:i,showError:a}=e;if(t.removeLoading(),!a)return;let s=()=>{};const{code:c}=i;let l={status:c||bm.UnknownError,errorType:"OPError",tips:{content:dm.t("Blockit_BlockGuide_LoadFailRetry"),params:{},buttons:[{name:dm.t("Blockit_BlockGuide_ReloadButton"),handler:()=>{s&&s(),r()}}]}};var u;u=c,[bm.RequestError,bm.ImportError,bm.NetworkError].includes(u)&&(l={status:bm.NetworkError,errorType:"OPError",tips:{content:dm.t("Blockit_BlockGuide_NetworkError"),params:{},buttons:[{name:dm.t("Blockit_BlockGuide_RefreshButton"),handler:()=>{s&&s(),r()}}]}}),c===bm.TimeoutError&&(l={status:bm.TimeoutError,errorType:"OPError",tips:{content:dm.t("Blockit_BlockGuide_LoadTimeout"),params:{retry:{name:dm.t("Blockit_BlockGuide_UpdateRetryLink"),handler:()=>{s&&s(),r()}}},buttons:[]}}),c===bm.DiagnoseError&&(l={status:c,errorType:"OPError",tips:{content:dm.t("Blockit_BlockGuide_DiagnoseError"),params:{},buttons:[]}}),s=Dp.ui.showError(l,n,o)}function Om(e){return new Promise(((t,n)=>{Mg.mountUISync("panel",e.actionName,e.blockEntity,e.actionPanelRoot,Sm(this.env,e),{retry:"number"==typeof e.retry?e.retry:0,delay:"number"==typeof e.delay?e.delay:0},e.extra).onSubmit(t,n)}))}function Cm(e){const t=++this.id,n="propsViewRoots"in e?"propsViewRoots":"propsView",{blockEntity:o,[n]:r}=e,i=Object.keys(r),a="propsView"===n?r:i.reduce(((e,t)=>(e[t]={root:r[t]},e)),{}),s={};if(i.forEach((n=>{this.removeProp(o.blockID,a[n].root);const r=Mg.mountUISync("props",n,o,a[n].root,Sm(this.env,e),a[n].extra);r&&(s[n]=[r,a[n].root],this.rootIDMap.set(a[n].root,[t,n]),"function"==typeof a[n].dataChange&&r.onDataChange(a[n].dataChange))})),Object.keys(s).length){this.propsIDMap.set(t,[o.blockID,s]);const e=this.blockIDMap.get(o.blockID);e?e.push(t):this.blockIDMap.set(o.blockID,[t])}return t}function Lm(e,t){const n=this.rootIDMap.get(t);if(!n)return;const[o,r]=n,i=this.propsIDMap.get(o);if(!i)return void this.rootIDMap.delete(t);const a=i[1];if(!a[r])return;const{[r]:s,...c}=a;0===Object.keys(c).length?this.unregister(o):(i[1]=c,this.removeItem(e,r,a[r]))}function Rm(e){if("object"==typeof e){const t=this.blockIDMap.get(e.blockID);return!!t&&(t.forEach((e=>this.unregister(e))),!0)}const t=this.propsIDMap.get(e);if(t){const[n,o]=t;Object.keys(o).forEach((e=>{this.removeItem(n,e,o[e])}));const r=this.blockIDMap.get(n);return r&&(bi(r,e),!r.length&&this.blockIDMap.delete(n)),this.propsIDMap.delete(e)}return!1}function Nm(e){let t=!1,n=()=>{t=!0};return e.then((e=>{t?e():n=e})),()=>{n()}}class Am extends Rg{constructor(...t){super(...t),e(this,"proxy",void 0)}setCreator(e){this.proxy=e}destroy(){return this.proxy.then((e=>e.destroy()))}appendTag(){}createTag(){return null}dataHandler(){return{code:0,data:null}}reload(e){return this.proxy.then((t=>t.reload(e)))}removeTag(){}onSubmit(e,t){let n=!1,o=()=>{n=!0};return this.proxy.then((r=>{o=r.onSubmit(e,t),n&&o()})),()=>{o()}}onCancel(e){this.eventBus.on("onCancel",e)}onLoaded(e){return Nm(this.proxy.then((t=>t.onLoaded(e))))}onLoadFail(e){return Nm(this.proxy.then((t=>t.onLoadFail(e))))}onContentLoaded(e){return Nm(this.proxy.then((t=>t.onContentLoaded(e))))}onConfigLoaded(e){return Nm(this.proxy.then((t=>t.onConfigLoaded(e))))}onReload(e){return Nm(this.proxy.then((t=>t.onReload(e))))}onHideLoading(e){return Nm(this.proxy.then((t=>t.onHideLoading(e))))}}async function xm(e,t,n,o,r){const{logger:i}=r||{},a={blockTypeID:t,debug:Boolean(o).toString()};if(e.hasOwnProperty("blockID")){const{blockID:t}=e;Object.assign(a,{blockID:t}),i({name:ap.events.MOUNT_CREATOR_GET_BLOCK_START,categories:a});const n=i({name:ap.events.MOUNT_CREATOR_GET_BLOCK_RESULT,categories:a},!0),o=await this.getBlockEntity(t,r).catch((e=>{throw n.setResultTypeFail().setLevel(ap.level.error).setError(e).flush(),e}));return n.setResultTypeSuccess().flush(),o}i({name:ap.events.MOUNT_CREATOR_GENERATE_BLOCK_START,categories:a});const s=i({name:ap.events.MOUNT_CREATOR_GENERATE_BLOCK_RESULT,categories:a},!0),c=await this.blockEngine.generateBlock({blockTypeID:t,...e},n,r).catch((e=>{throw s.setResultTypeFail().setLevel(ap.level.error).setError(e).flush(),e}));return s.setResultTypeSuccess().flush(),c}function Dm(e){const t=performance.now(),{moreParams:n,blockRoot:o,blockTypeID:r,containerID:i=""}=e,{logger:a}=n,s=e.debug||!1,c={blockTypeID:r,debug:Boolean(s).toString()};a({name:ap.events.MOUNT_CREATOR_START,categories:c});a({name:ap.events.MOUNT_CREATOR_CHECK_ENGINE_RESULT,categories:c},!0).setResultTypeSuccess().flush();const l={type:"creator",blockTypeID:r,theme:this.theme,getTheme:this.getCurrentTheme.bind(this)},u=Tm({blockRoot:o,debug:s,context:l,moreParams:n.createTraceContext()},this.env);u.start();const d=Mg.mountUI("creator",r,o,this.env,{mode:"create",retry:0,delay:0,debug:s,trace:n.createTraceSpan()}),h=new Am(r,o,this.env,{mode:"create",retry:0,delay:0,debug:s,trace:n.createTraceSpan()});h.setCreator(d),d.then((n=>{u.bindBlock(n),zm(n,e.moreParams,t);const o=n.unMount;n.unMount=()=>{u&&u.remove(),o.call(n)}}),(t=>{Im({loading:u,blockRoot:e.blockRoot,uiContext:{type:"creator",theme:this.theme,getTheme:this.getCurrentTheme.bind(this)},error:t,retryHandler:()=>{this.mountCreator(e)}})}));const f=d.then((e=>new Promise(((t,n)=>{e.onSubmit(t,n)})).then((e=>xm.call(this,e,r,i,s,n.createTraceContext()))).then((t=>(e.destroy(),a(ap.events.MOUNT_CREATOR_DESTROY),t)))));return f.creator=h,f}function Bm(e){const t=performance.now(),n=e.block.entity,{logger:o}=e.moreParams,{blockID:r,blockTypeID:i}=e.block.entity;o({name:ap.events.MOUNT_SETTING_START,categories:{blockTypeID:i,blockID:r}});const a=Tm({blockRoot:e.blockRoot,debug:e.debug,context:{type:"creator",blockTypeID:n.blockTypeID,blockID:n.blockID,theme:this.theme,getTheme:this.getCurrentTheme.bind(this)},moreParams:e.moreParams.createTraceContext()},this.env);a.start();const s=Mg.mountUISync("creator",n.blockTypeID,e.blockRoot,this.env,{mode:"setting",retry:0,delay:0,debug:e.debug||!1,settings:e.settings,preEntity:n,needInterface:!0,trace:e.moreParams.createTraceSpan()});return a.bindBlock(s),zm(s,e.moreParams,t),s.onSubmit((t=>{a&&a.remove(),e.block.changeSettings(t,!1),s.destroy()})),s.onCancel((()=>{a&&a.remove(),e.block.changeSettings(void 0,!0),s.destroy()})),s}async function Pm(e,t){const n=performance.now(),{moreParams:o,blockRoot:r,blockEntity:i}=e,{blockID:a,blockTypeID:s}=i,{logger:c}=o,l={blockID:a,blockTypeID:s};c({name:ap.events.MOUNT_BLOCK_START,categories:l});const u={type:"block",blockID:e.blockEntity.blockID,theme:this.theme,getTheme:this.getCurrentTheme.bind(this)};t||(t=Tm({blockRoot:r,debug:e.debug||!1,context:u,moreParams:o.createTraceContext()},this.env)),t.start({blockTypeID:e.blockEntity.blockTypeID});try{const r=await Mg.mountUI("block",e.blockEntity,e.blockRoot,Sm(this.env,e),{debug:e.debug||!1,active:"boolean"!=typeof e.active||e.active,trace:o.createTraceSpan(),typedDataCollection:e.typedDataCollection});t.bindBlock(r),function(e,t,n){const{logger:o}=t,{entity:{blockID:r,blockTypeID:i}}=e;e.onConfigLoaded((e=>{const{packageVersion:t=""}=e;o({name:ap.events.LIFECYCLE_BLOCK_ONCONFIGLOADED,categories:{data:ap.utils.serialize(e),blockID:r,blockTypeID:i,packageVersion:t}},!0).setDuration(performance.now()-n).flush()})),e.onLoaded((()=>{o({name:ap.events.LIFECYCLE_BLOCK_ONLOADED,categories:{blockID:r,blockTypeID:i}},!0).setDuration(performance.now()-n).flush()})),e.onContentLoaded((()=>{o({name:ap.events.LIFECYCLE_BLOCK_ONCONTENTLOADED,categories:{blockID:r,blockTypeID:i}},!0).setDuration(performance.now()-n).flush()})),e.onLoadFail((e=>{o({name:ap.events.LIFECYCLE_BLOCK_ONLOADFAIL,categories:{blockID:r,blockTypeID:i},level:ap.level.error},!0).setDuration(performance.now()-n).setResultTypeFail().setErrorCode(e.detail.errCode.toString()).setErrorMessage(ap.utils.serialize(e.detail)).flush()})),e.onReload((()=>{o({name:ap.events.LIFECYCLE_BLOCK_ONRELOAD,categories:{blockID:r,blockTypeID:i}})})),e.onOpenSetting((e=>{o({name:ap.events.LIFECYCLE_BLOCK_ONOPENSETTING,categories:{blockID:r,blockTypeID:i,data:ap.utils.sample(e)}})})),e.onUpdateReady((e=>{o({name:ap.events.LIFECYCLE_BLOCK_ONUPDATEREADY,categories:{blockID:r,blockTypeID:i,type:e.updateType.toString()}},!0).setDuration(performance.now()-n).flush()}))}(r,o,n);const i=this.blockMap.get(e.blockEntity.blockID)||[];0===i.length&&this.blockMap.set(e.blockEntity.blockID,i),i.push(r);const a=r.unMount;return r.unMount=()=>{i.includes(r)?(t&&t.remove(),bi(i,r),Mg.unmountUI(e.blockEntity.blockID,"block",r)):a.call(r)},r}catch(n){throw Im({loading:t,blockRoot:e.blockRoot,uiContext:{type:"block",theme:this.theme,getTheme:this.getCurrentTheme.bind(this)},error:n,retryHandler:()=>{Pm.call(this,e,t)}}),n}}function zm(e,t,n){const{logger:o}=t,{blockTypeID:r}=e;e.onConfigLoaded((e=>{const{packageVersion:t}=e;o({name:ap.events.LIFECYCLE_CREATOR_ONCONFIGLOADED,categories:{data:ap.utils.serialize(e),blockTypeID:r,packageVersion:t}},!0).setDuration(performance.now()-n).flush()})),e.onLoaded((()=>{o({name:ap.events.LIFECYCLE_CREATOR_ONLOADED,categories:{blockTypeID:r}},!0).setDuration(performance.now()-n).flush()})),e.onContentLoaded((()=>{o({name:ap.events.LIFECYCLE_CREATOR_ONCONTENTLOADED,categories:{blockTypeID:r}},!0).setDuration(performance.now()-n).flush()})),e.onLoadFail((e=>{o({name:ap.events.LIFECYCLE_CREATOR_ONLOADFAIL,categories:{blockTypeID:r},level:ap.level.error},!0).setDuration(performance.now()-n).setErrorCode(e.detail.errCode.toString()).setErrorMessage(ap.utils.serialize(e.detail)).flush()})),e.onReload((()=>{o({name:ap.events.LIFECYCLE_CREATOR_ONRELOAD,categories:{blockTypeID:r}})})),e.onSubmit((e=>{o({name:ap.events.LIFECYCLE_CREATOR_ONSUBMIT,categories:{blockTypeID:r,data:ap.utils.sample(e)}},!0).setDuration(performance.now()-n).flush()}),(()=>{o({name:ap.events.LIFECYCLE_CREATOR_ONSUBMIT,categories:{blockTypeID:r},level:ap.level.error},!0).setDuration(performance.now()-n).setResultTypeFail().setErrorMessage("creator onError or onClose").flush()})),e.onCancel((()=>{o({name:ap.events.LIFECYCLE_CREATOR_ONCANCEL,categories:{blockTypeID:r}})}))}async function Mm(e){const t=performance.now(),{blockID:n,blockTypeID:o,moreParams:r,...i}=e,{logger:a}=r,s={blockID:n,debug:Boolean(e.debug).toString()};a({name:ap.events.MOUNT_BLOCK_BY_ID_START,categories:s});const c=Tm({blockRoot:e.blockRoot,debug:e.debug,context:{type:"block",blockID:n,theme:this.theme,getTheme:this.getCurrentTheme.bind(this)},moreParams:r.createTraceContext()},this.env);let l;a({name:ap.events.MOUNT_BLOCK_BY_ID_GET_ENTITY_START,categories:s});let u=null;const d=pg.getCache(n),h=a({name:ap.events.MOUNT_BLOCK_BY_ID_GET_ENTITY_RESULT,categories:{...s,cache:Boolean(d).toString()}},!0);if(d)l=d.entity,h.setDuration(performance.now()-t).setResultTypeSuccess().flush();else{const a=eg([n],r).then((e=>e[0]||Promise.reject(new mi({code:mi.code.GetBlockEntityError,message:`get block entity failed, ${n}`})))).catch((t=>{throw Im({loading:c,blockRoot:e.blockRoot,uiContext:{type:"block",theme:this.theme,getTheme:this.getCurrentTheme.bind(this)},error:t,retryHandler:()=>{this.mountBlockByID(e)}}),t}));o&&Mg.shouldPreMount("block",o)&&(u=Pm.call(this,{blockEntity:Fg(n,o),moreParams:r.createTraceContext(),...i},c));const s=await a;l=s.entity,pg.setCache(l.blockID,s),h.setDuration(performance.now()-t).setResultTypeSuccess().flush()}if(u){(await u).changeProp("initEntity",l)}else u=Pm.call(this,{blockEntity:l,moreParams:r.createTraceContext(),...i},c);return u}function jm(e,t){const{logger:n}=t;if(n(ap.events.UNMOUNT_START),"string"==typeof e){const t=this.blockMap.get(e);t&&(n({name:ap.events.UNMOUNT_BLOCK_ID,categories:{blockID:e,count:t.length.toString()}}),t.forEach((t=>{Mg.unmountUI(e,"block",t)})),this.blockMap.delete(e))}else n({name:ap.events.UNMOUNT_BLOCK_INSTANCE,categories:{blockID:e.entity.blockID}}),e.unMount();n(ap.events.UNMOUNT_END)}const Um="sharedtoken";const Vm=[function(e,{env:t}){if(0===e.indexOf(Um)){const n=e.slice(Um.length+1),o="online"===t.env?"":"-"+t.env;return`https://www.${"feishu"===t.region?`feishu${o}.cn`:`larksuite${o}.com`}/calendar/share?token=${n}`}}];const Hm=[function(e){const t=e.match(/block:\/\/([\w-]+)\?from=([\w-]+)&id=([\w-]+)(&scene=cut)*/);if(t)return{blockID:t[1],from:t[2],uuid:t[3],...t[4]?{scene:"cut"}:{}}},function(e,t){const n="online"===t.env?"":"-"+t.env,o="feishu"===t.region?`feishu${n}\\.cn`:`larksuite${n}\\.com`,r=e.match(new RegExp(`(https://www\\.|www\\.)?${o}/calendar/share\\?token=(\\w+)`));if(r)return`sharedtoken-${r[2]}`}];function Fm(e,t){return e.map((e=>{for(let n=0,o=Hm.length;n<o;n++){const o=Hm[n](e,t);if(o)return o}}))}const Km={code:-1,msg:"invalid schema"},Gm={code:-2,msg:"fail"};function Jm(e,t,n){const{logger:o}=n,r={uuid:t.uuid,env:{...this.env,host:t.host||this.env.host},..."cut"===t.scene?{scene:"cut"}:{}};o({name:ap.events.COPY_BLOCK_START,categories:{blockID:e,context:ap.utils.serialize(t)}});for(let t=0,n=Vm.length;t<n;t++){const n=Vm[t](e,r);if(n)return n}const i=function(e,t){return`block://${e}?from=${t.env.host}&id=${t.uuid}${t.scene?"&scene=cut":""}`}(e,r);return o({name:ap.events.COPY_BLOCK_RESULT,categories:{schema:i}}),i}function qm(e){const[t]=Fm([e],this.env);return"object"==typeof t?t.blockID:t}function Wm(e,t,n,o,r){const{logger:i}=r;i({name:ap.events.BULK_PASTE_BLOCK_START,categories:{schema:e.join(","),context:ap.utils.serialize(t),data:ap.utils.serialize(n)}});const a={blockIDs:[],context:{platform:n.platform,language:n.locale,to:t.host||this.env.host,from:null,scene:"cut"===t.scene?"cut":"paste"}},s=[],c=Fm(e,this.env),l=c.map((()=>Km));let u=null;c.forEach(((e,n)=>{if("string"==typeof e)s.push(e);else if(e){let o=!0;a.context.from?a.context.from!==e.from&&(o=!1):(a.context.from=e.from,e.uuid===t.uuid&&(a.context.scene="pasteFromSameContext")),o?(a.blockIDs.push(e.blockID),l[n]=Gm,!1!==u&&(u="cut"===e.scene)):l[n]=Km}})),i({name:ap.events.BULK_PASTE_BLOCK_PARAMS,categories:{blockIDs:a.blockIDs.join(","),context:ap.utils.serialize(a.context)}}),!0===u&&(a.context.scene="cut");const d=new t_(this.env,o,r.createTraceContext());return Promise.all([a.blockIDs.length?d.cloneBlock(a):{},s.length?d.generateInnerBlock(s):[]]).then((([e,t])=>{let n=0;for(let t=0,o=a.blockIDs.length;t<o;t++){const o=e[a.blockIDs[t]];for(o&&(o.sourceMeta=JSON.parse(o.sourceMeta||'""'),o.sourceData=JSON.parse(o.sourceData||'""'),l[n]=o),n++;n<l.length&&-1===l[n].code;)n++}let o=-1;return c.forEach(((e,n)=>{if("string"==typeof e){const r=s.indexOf(e,o);if(~r){const e=t[r];l[n]=null===e?Gm:"string"==typeof e?{code:-3,msg:e}:e,o=r}}})),i({name:ap.events.BULK_PASTE_BLOCK_RESULT,categories:{data:ap.utils.serialize(l.map((e=>e.hasOwnProperty("code")?e:e.blockID)))}}),l}))}class $m extends Cg{constructor(...t){super(...t),e(this,"handlers",null)}createTag(){}appendTag(){this.handlers&&this.handlers.destroy();const e=this.render(this.entity,{root:this.root,env:this.env,onLoaded:()=>{this.eventBus.emit("onLoad",{needLoading:!1,packageSourceType:"disk"})},onLoadError:e=>{this.eventBus.emit("onError",e)}});Promise.resolve(e).then((e=>{this.handlers=e}))}removeTag(){this.handlers&&this.handlers.destroy()}reload(e){return e&&console.log("not support debug"),this.handlers&&this.handlers.update(this.entity),Promise.resolve()}changeProp(e,t){}changeVisibility(e){}changeSettings(e,t){}}class Ym extends Bg{constructor(...t){super(...t),e(this,"_hasInit",!0),e(this,"name","message")}static init(e){for(let t=0,n=e.length;t<n;t++){const n=e[t],o=class extends $m{render(...e){return n.render.call(this,...e)}};(Array.isArray(n.blockTypeID)?n.blockTypeID:[n.blockTypeID]).forEach((e=>{Ym.BlockMap.set(e,o)}))}}load(){return Promise.resolve()}registerUI(e){for(const t of Ym.BlockMap.keys())e("block",t,this)}mountUI(e,...t){const n=t[0].blockTypeID,o=Ym.BlockMap.get(n);if(o)return new o(...t);throw new Error("")}removeUI(e,t){t.unMount()}onDataChange(){}shouldCollaboration(e,t){return!1}}function Qm(e){return"message"===e?Ym:null}function Xm(e,t){e===Wr&&(this.blockEngineURL=t)}e(Ym,"BlockMap",new Map);class Zm{constructor(t){e(this,"callRustApi",null),e(this,"onRust",null),e(this,"offRust",null),e(this,"cmdsRust",null),e(this,"call",((e,t,n)=>this.cmdsRust&&this.cmdsRust[e]?this.callRustApi?this.callRustApi(this.cmdsRust[e],t,n):Promise.reject(new Error("method not init: callapi")):Promise.reject(new Error(`cmd not found, cmd=${e}`)))),e(this,"on",((e,t,n)=>this.cmdsRust&&this.cmdsRust[e]?this.onRust?this.onRust(this.cmdsRust[e],t,n):Promise.reject(new Error("method not init: on")):Promise.reject(new Error(`cmd not found, cmd=${e}`)))),e(this,"off",((e,t,n)=>this.cmdsRust&&this.cmdsRust[e]?this.offRust?this.offRust(this.cmdsRust[e],t,n):Promise.reject(new Error("method not init: off")):Promise.reject(new Error(`cmd not found, cmd=${e}`)))),this.callRustApi=t.callApi,this.onRust=t.on,this.offRust=t.off,this.cmdsRust=t.cmds}}let ev;!function(e){e.GET_BLOCK_ENTITY="GET_BLOCK_ENTITY",e.GET_BLOCK_EXTENSION_ENTITY="GET_BLOCK_EXTENSION_ENTITY",e.SET_BLOCK_ENTITY="SET_BLOCK_ENTITY",e.SET_BLOCK_EXTENSION_ENTITY="SET_BLOCK_EXTENSION_ENTITY",e.GET_ALL_BLOCK_ENTITY="GET_ALL_BLOCK_ENTITY",e.DELETE_BLOCK_ENTITY="DELETE_BLOCK_ENTITY",e.DELETE_BLOCK_EXTENSION_ENTITY="DELETE_BLOCK_EXTENSION_ENTITY",e.PUSH_BLOCK_ENTITY_CHANGED="PUSH_BLOCK_ENTITY_CHANGED",e.PUSH_BLOCK_EXTENSION_ENTITY_CHANGED="PUSH_BLOCK_EXTENSION_ENTITY_CHANGED",e.PUSH_BLOCK_SERVER="PUSH_BLOCK_SERVER",e.PUSH_CHAT_MESSAGE_CHANGED="PUSH_CHAT_MESSAGE_CHANGED"}(ev||(ev={}));const tv={GET_BLOCK_ENTITY:"32000|block.v1.GetBlockEntityRequest|block.v1.GetBlockEntityResponse|1|GET_BLOCK_ENTITY",SET_BLOCK_ENTITY:"32002|block.v1.SetBlockEntityRequest|block.v1.SetBlockEntityResponse|1|SET_BLOCK_ENTITY",GET_BLOCK_EXTENSION_ENTITY:"32001|block.v1.GetBlockExtensionEntityRequest|block.v1.GetBlockExtensionEntityResponse|1|GET_BLOCK_EXTENSION_ENTITY",SET_BLOCK_EXTENSION_ENTITY:"32003|block.v1.SetBlockExtensionEntityRequest|block.v1.SetBlockExtensionEntityResponse|1|SET_BLOCK_EXTENSION_ENTITY",GET_ALL_BLOCK_ENTITY:"32004|block.v1.GetAllBlockEntityRequest|block.v1.GetAllBlockEntityResponse|1|GET_ALL_BLOCK_ENTITY",DELETE_BLOCK_ENTITY:"32005|block.v1.DeleteBlockEntityRequest|block.v1.DeleteBlockEntityResponse|1|DELETE_BLOCK_ENTITY",DELETE_BLOCK_EXTENSION_ENTITY:"32006|block.v1.DeleteBlockExtensionEntityRequest|block.v1.DeleteBlockExtensionEntityResponse|1|DELETE_BLOCK_EXTENSION_ENTITY",PUSH_BLOCK_ENTITY_CHANGED:"32600||block.v1.PushBlockEntityChanged||PUSH_BLOCK_ENTITY_CHANGED",PUSH_BLOCK_EXTENSION_ENTITY_CHANGED:"32601||block.v1.PushBlockExtensionEntityChanged||PUSH_BLOCK_EXTENSION_ENTITY_CHANGED",PUSH_BLOCK_SERVER:"32602||block.v1.BlockPushDataServer||PUSH_BLOCK_SERVER",PUSH_CHAT_MESSAGE_CHANGED:"32603||im.v1.PushChatMessageChanged||PUSH_CHAT_MESSAGE_CHANGED"},nv={get:(e,t)=>Promise.reject(new Error("init fail")),set:(e,t)=>Promise.reject(new Error("init fail")),remove:(e,t)=>Promise.reject(new Error("init fail")),onKVChange(e){throw new Error("init fail")}};let ov=!1;const rv=new class{init(e,t){t&&function(e){if(ov)return;ov=!0;const{callApi:t,on:n,off:o,cmds:r=tv}=e,i=new Zm({callApi:t,on:n,off:o,cmds:r}),a=[];i.on(ev.PUSH_BLOCK_EXTENSION_ENTITY_CHANGED,(e=>{a.forEach((t=>{t(e)}))})),Object.assign(nv,{get:(e,t)=>i.call(ev.GET_BLOCK_EXTENSION_ENTITY,{extType:e,ids:t}),set:(e,t)=>i.call(ev.SET_BLOCK_EXTENSION_ENTITY,{data:t.map((t=>({extType:e,id:t.id,content:t})))}),remove:(e,t)=>i.call(ev.DELETE_BLOCK_EXTENSION_ENTITY,{extType:e,ids:t}),onKVChange:e=>(a.push(e),()=>{const t=a.indexOf(e);~t&&a.splice(t,1)})})}(t)}getDataByDB(e,t){return nv.get(e,t)}setDataByDB(e,t){nv.set(e,t)}onValueChange(e){return nv.onKVChange(e)}},iv={getDataFromDB:(...e)=>rv.getDataByDB(...e),setDataFromDB:(...e)=>rv.setDataByDB(...e),onValueChange:(...e)=>rv.onValueChange(...e)};var av=new class{constructor(t){e(this,"env",void 0),e(this,"id",0),e(this,"propsIDMap",new Map),e(this,"rootIDMap",new WeakMap),e(this,"blockIDMap",new Map),e(this,"blockMap",new Map),e(this,"blockEngine",void 0),e(this,"blockEngineURL",void 0),e(this,"version",void 0),e(this,"theme","light"),e(this,"bloclkitInit",!1),e(this,"initTimelineRecord",{}),e(this,"storage",iv),e(this,"internal",{getEngine:Qm}),e(this,"engineInitTask",(()=>Promise.resolve(new mi({code:mi.code.InitError,message:"Blockit.init needs to be called first"})))),hm.call(this,t)}getCurrentTheme(){return this.theme}setDebugPort(e,t){const n=new Yp(t);return fm.call(this,e,n)}setEnv(e,t){const n=new Yp(t);return pm.call(this,e,n)}generateBlockID(e){return gm.call(this,e)}async doAction(e){const t=await this.engineInitTask();if(t)throw t;return Om.call(this,e)}register(e){return Cm.call(this,e)}removeItem(e,t,[n,o]){Mg.unmountUI(e,"props",n,t),this.rootIDMap.delete(o)}removeProp(e,t){return Lm.call(this,e,t)}recordInitTimeline(e){return(t=this.initTimelineRecord,function(e){return t[e]||(t[e]={startTime:0,endTime:0,duration:0}),{start:n=>{const o=t[e];o&&(o.startTime=n||performance.now())},end:(n,o)=>{const r=t[e];r&&(r.endTime=o||performance.now(),r.startTime&&(r.duration=r.endTime-r.startTime),r.categories=n)}}})(e);var t}reportTimelineRecord(e){let t;for(t in this.initTimelineRecord){var n,o;if(Object.prototype.hasOwnProperty.call(this.initTimelineRecord,t))e.timer({name:t,duration:(null===(n=this.initTimelineRecord[t])||void 0===n?void 0:n.duration)||0,categories:null===(o=this.initTimelineRecord[t])||void 0===o?void 0:o.categories})}}checkInit(){if(!this.bloclkitInit)throw new mi({code:mi.code.InitError,message:"Blockit.init needs to be called first"})}unregister(e){return Rm.call(this,e)}init(e,t){const n=Qp(e);return _m.call(this,n,t).then((t=>{const o=function(e){const{options:t,engineName:n}=e,{moreParams:o}=t;return Mg.loadEngine(t,n||Wr,o.createTraceContext())}(t).then((()=>{var t;this.recordInitTimeline(Jf.TIMELINE_INIT).end(),this.reportTimelineRecord(n.moreParams),!window.blockitInternal.initStartTime||null!==(t=e.env)&&void 0!==t&&t.isFeishuNative||ap.collect({name:"openplatform_website_blockit_init_dev",categories:{duration:performance.now()-window.blockitInternal.initStartTime,result_type:"success"}})})).catch((e=>(this.engineInitTask=()=>new Promise((t=>{this.hasEngineInit?t():t(e)})),e)));this.engineInitTask=()=>o,this.bloclkitInit=!0}))}getAvailableBlockList(e){const t=Qp(e);return this.blockEngine.getBlockList({debugPort:this.env.debugPort,...t})}get hasEngineInit(){return this.blockEngine.hasInit}get hasInit(){return this.bloclkitInit}get blockEngineVersion(){return this.blockEngine.getEngineVersion()}get jssdkVersion(){return this.blockEngine.getJSSDKVersion()}mountCreator(e){this.checkInit();const{moreParams:t}=e,n=new Yp(t),o={...e,moreParams:n};return Dm.call(this,o)}mountSetting(e){this.checkInit();const t=Qp(e);return Bm.call(this,t)}mountBlock(e){this.checkInit();const t=Qp(e);return Pm.call(this,t)}getBlockEntity(e,t){return new t_(this.env,"",t).getBlockEntity(e)}mountBlockByID(e){this.checkInit();const t=Qp(e);return Mm.call(this,t)}unmountBlock(e,t){const n=new Yp(t);return jm.call(this,e,n)}registerEngine(e){return Mg.registerEngine(e,!0)}replaceKernelLibrary(e){var t;"function"==typeof(t=e)?Object.assign(Dp,t({...Dp})):Object.assign(Dp,t)}prefetchBlocks(e,t){this.engineInitTask().then((n=>{if(n)throw n;this.blockEngine.prefetchBlocks(e,t)}))}copy(e,t,n){const o=new Yp(n);return Jm.call(this,e,t,o)}bulkPaste(e,t,n,o,r){const i=new Yp(r);return Wm.call(this,e,t,n,o,i)}setInternalEngine(e,t){Xm.call(this,e,t)}updateTheme(e,t){const n=new Yp(t);return mm.call(this,e,n)}resolveSchema(e){return qm.call(this,e)}async updateTypedData(e){const t=Qp(e),n=await this.engineInitTask();if(n)throw n;vm.call(this,t)}}({});return av}();
